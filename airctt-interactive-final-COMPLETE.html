<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIRCTT - AI Reality CouponTalkTalk</title>
  
  <!-- CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  
  <!-- ì†Œì…œ ë¡œê·¸ì¸ SDK -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js" integrity="sha384-l+xbElFSnPZ2rOaPrU//2FF5B4LB8FiX5q4fXYTlfcG4PGpMkE1vcL7kNXI6Cci0" crossorigin="anonymous"></script>
  <script src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js" charset="utf-8"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #0a0a0a;
      color: #ffffff;
      overflow-x: hidden;
    }
    
    h1, h2, h3 { font-family: 'Orbitron', monospace; }
    
    #canvas-3d {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }
    
    .content { position: relative; z-index: 1; }
    
    .grid-bg {
      background-image: 
        linear-gradient(rgba(168, 85, 247, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(168, 85, 247, 0.05) 1px, transparent 1px);
      background-size: 50px 50px;
    }
    
    .glow-border {
      border: 1px solid rgba(168, 85, 247, 0.3);
      box-shadow: 0 0 20px rgba(168, 85, 247, 0.2), inset 0 0 20px rgba(168, 85, 247, 0.1);
    }
    
    .neon-text {
      text-shadow: 0 0 10px rgba(168, 85, 247, 0.8), 0 0 20px rgba(168, 85, 247, 0.6), 0 0 30px rgba(168, 85, 247, 0.4);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #a855f7 0%, #22d3ee 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #a855f7 0%, #22d3ee 100%);
      color: white;
      padding: 1rem 2rem;
      border-radius: 0.5rem;
      font-weight: bold;
      transition: transform 0.3s ease;
      text-decoration: none;
      display: inline-block;
      cursor: pointer;
      border: none;
      font-size: 1rem;
    }
    
    .btn-primary:hover { transform: translateY(-2px); }
    
    /* ì†Œì…œ ë¡œê·¸ì¸ ë²„íŠ¼ */
    .social-btn {
      width: 100%;
      padding: 1rem;
      border-radius: 0.5rem;
      font-weight: bold;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s;
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    
    .social-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    
    .btn-google {
      background: #ffffff;
      color: #333333;
      border: 1px solid #dddddd;
    }
    
    .btn-kakao {
      background: #FEE500;
      color: #000000;
    }
    
    .btn-naver {
      background: #03C75A;
      color: #ffffff;
    }
    
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 1.5rem 0;
      color: #888;
    }
    
    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #444;
    }
    
    .divider span {
      padding: 0 1rem;
    }
    
    .card {
      background: rgba(26, 10, 46, 0.3);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      padding: 2rem;
      transition: all 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(168, 85, 247, 0.3);
    }
    
    .page { display: none; }
    .page.active { display: block; }
    
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: rgba(10, 10, 10, 0.9);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(168, 85, 247, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 2rem;
    }
    
    nav .nav-left { display: flex; }
    
    nav a {
      color: white;
      text-decoration: none;
      padding: 1rem 1.5rem;
      display: inline-block;
      transition: all 0.3s;
    }
    
    nav a:hover {
      background: rgba(168, 85, 247, 0.2);
      color: #a855f7;
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.5rem 1rem;
      background: rgba(168, 85, 247, 0.2);
      border-radius: 2rem;
    }
    
    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #a855f7, #22d3ee);
    }

    #game-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1000;
      display: none;
    }
    
    #game-container.active { display: block; }
    
    #game-canvas {
      width: 100%;
      height: 100%;
      cursor: crosshair;
    }
    
    .game-hud {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 2rem;
      z-index: 1001;
    }
    
    .hud-item {
      background: rgba(10, 10, 10, 0.8);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(34, 211, 238, 0.5);
      border-radius: 15px;
      padding: 1rem 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 120px;
    }
    
    .hud-label {
      font-size: 0.9rem;
      color: #22d3ee;
      text-transform: uppercase;
      font-weight: bold;
    }
    
    .hud-value {
      font-size: 2rem;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(34, 211, 238, 0.8);
    }

    .coupon-card {
      background: rgba(26, 10, 46, 0.5);
      border-left: 4px solid;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .coupon-card:hover {
      transform: translateX(10px);
      box-shadow: 0 10px 30px rgba(168, 85, 247, 0.4);
    }
    
    .coupon-card.common { border-color: #888888; }
    .coupon-card.rare { border-color: #4a9eff; }
    .coupon-card.epic { border-color: #a855f7; }
    .coupon-card.legendary { border-color: #fbbf24; }
    .coupon-card.mythic { border-color: #ff0000; }
    
    .rarity-badge {
      padding: 0.3rem 0.8rem;
      border-radius: 12px;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.8rem;
      display: inline-block;
      margin-right: 0.5rem;
    }
    
    .rarity-badge.common { background: #888888; }
    .rarity-badge.rare { background: #4a9eff; }
    .rarity-badge.epic { background: #a855f7; }
    .rarity-badge.legendary { background: #fbbf24; color: #000; }
    .rarity-badge.mythic { background: #ff0000; }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.active { display: flex; }
    
    .modal-content {
      background: rgba(26, 10, 46, 0.95);
      border: 2px solid rgba(168, 85, 247, 0.5);
      border-radius: 1rem;
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    @keyframes rabbitJump {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-20px) scale(1.1); }
    }
    
    .rabbit-animation {
      animation: rabbitJump 0.6s ease-in-out;
    }

    @media (max-width: 768px) {
      nav { flex-direction: column; padding: 0.5rem; }
      .game-hud { gap: 1rem; }
      .hud-item { padding: 0.8rem 1rem; min-width: 80px; }
      .hud-value { font-size: 1.5rem; }
    }
  </style>
</head>
<body class="grid-bg">
  <nav>
    <div class="nav-left">
      <a href="#" onclick="event.preventDefault(); showPage('home')">ğŸ  í™ˆ</a>
      <a href="#" onclick="event.preventDefault(); showPage('wallet')">ğŸ’° ì¿ í° ì§€ê°‘</a>
      <a href="#" onclick="event.preventDefault(); showPage('business')">ğŸ’¼ ì‚¬ì—…ì</a>
      <a href="#" onclick="event.preventDefault(); showPage('store-builder')">ğŸ¨ ë§¤ì¥ê¾¸ë¯¸ê¸°</a>
      <a href="#" onclick="event.preventDefault(); showPage('admin')">ğŸ” ê´€ë¦¬ì</a>
      <a href="#" onclick="event.preventDefault(); startGame()">ğŸ® ê²Œì„</a>
    </div>
    <div id="nav-user">
      <a href="#" onclick="event.preventDefault(); showPage('login')">ğŸ‘¤ ë¡œê·¸ì¸</a>
    </div>
  </nav>

  <canvas id="canvas-3d"></canvas>

  <div class="content" style="padding-top: 60px;">
    
    <!-- í™ˆ í˜ì´ì§€ -->
    <div id="home-page" class="page active">
      <section class="min-h-screen flex items-center justify-center px-4">
        <div class="text-center max-w-4xl mx-auto">
          <div class="mb-8">
            <span id="rabbit-emoji" class="text-8xl filter drop-shadow-lg">ğŸ°</span>
          </div>
          <h1 class="text-6xl md:text-8xl font-black mb-6 neon-text">AIRCTT</h1>
          <p class="text-2xl md:text-3xl mb-4 gradient-text font-bold">AI Reality CouponTalkTalk</p>
          <p class="text-xl mb-8 text-gray-300">ìˆ«ìê°€ ì•„ë‹Œ ì‚¬ëŒì„ ì§€í‚¤ëŠ” ë©”íƒ€ë²„ìŠ¤ ê²½ì œ OS</p>
          <div class="flex gap-4 justify-center flex-wrap">
            <button onclick="startGame()" class="btn-primary">ğŸ® 3D ì¿ í° ê²Œì„</button>
            <button onclick="showPage('store')" class="btn-primary">ğŸ½ï¸ ì£¼ë¬¸í•˜ê¸°</button>
            <button onclick="showPage('wallet')" class="btn-primary">ğŸ’° ì¿ í° ì§€ê°‘</button>
          </div>
        </div>
      </section>
    </div>

    <!-- ì•„ë¯¸ í•œì •ì‹ ìŠ¤í† ì–´ -->
    <div id="store-page" class="page">
      <div class="max-w-6xl mx-auto px-4 py-20">
        <div class="card glow-border mb-8">
          <div class="flex items-center gap-6">
            <div class="text-6xl">ğŸ±</div>
            <div class="flex-1">
              <h2 class="text-4xl font-black gradient-text mb-2">ì•„ë¯¸ í•œì •ì‹</h2>
              <p class="text-gray-400 mb-2">ğŸ“ ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</p>
              <p class="text-gray-400">â­ 4.8 (1,234ê°œ) | ğŸšš ë°°ë‹¬ 30-40ë¶„</p>
              <div class="flex gap-2 mt-4">
                <span class="px-3 py-1 bg-purple-600 rounded-full text-sm">í•œì •ì‹</span>
                <span class="px-3 py-1 bg-cyan-600 rounded-full text-sm">ë¬´ë£Œë°°ë‹¬</span>
                <span class="px-3 py-1 bg-green-600 rounded-full text-sm">ì¿ í°ì‚¬ìš©ê°€ëŠ¥</span>
              </div>
            </div>
          </div>
        </div>

        <div class="card glow-border mb-8">
          <h3 class="text-2xl font-bold mb-4">ğŸ’° ì‚¬ìš© ê°€ëŠ¥í•œ ì¿ í°</h3>
          <div id="available-coupons-list">
            <p class="text-gray-400">ì¿ í°ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ í• ì¸ì´ ì ìš©ë©ë‹ˆë‹¤</p>
          </div>
        </div>

        <div class="card glow-border mb-8">
          <h3 class="text-2xl font-bold mb-6">ğŸ“‹ ë©”ë‰´</h3>
          <div id="menu-list" class="grid md:grid-cols-2 gap-4"></div>
        </div>

        <div class="card glow-border mb-8">
          <h3 class="text-2xl font-bold mb-4">ğŸ›’ ì£¼ë¬¸ ì˜µì…˜</h3>
          <div class="flex gap-4 mb-6">
            <button onclick="setOrderType('delivery')" id="btn-delivery" class="btn-primary flex-1">ğŸšš ë°°ë‹¬</button>
            <button onclick="setOrderType('pickup')" id="btn-pickup" class="btn-primary flex-1">ğŸƒ í¬ì¥</button>
            <button onclick="setOrderType('reservation')" id="btn-reservation" class="btn-primary flex-1">ğŸ“… ì˜ˆì•½</button>
          </div>
          
          <div id="delivery-form" style="display:none;">
            <div class="mb-4">
              <label class="block mb-2">ë°°ë‹¬ ì£¼ì†Œ</label>
              <input type="text" id="delivery-address" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬...">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ì „í™”ë²ˆí˜¸</label>
              <input type="tel" id="delivery-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="010-1234-5678">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ìš”ì²­ì‚¬í•­</label>
              <textarea id="delivery-request" class="w-full p-3 rounded bg-gray-900 border border-purple-500" rows="3" placeholder="ë¬¸ ì•ì— ë†“ì•„ì£¼ì„¸ìš”"></textarea>
            </div>
          </div>

          <div id="pickup-form" style="display:none;">
            <div class="mb-4">
              <label class="block mb-2">í”½ì—… ì‹œê°„</label>
              <input type="time" id="pickup-time" class="w-full p-3 rounded bg-gray-900 border border-purple-500">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ì „í™”ë²ˆí˜¸</label>
              <input type="tel" id="pickup-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="010-1234-5678">
            </div>
          </div>

          <div id="reservation-form" style="display:none;">
            <div class="mb-4">
              <label class="block mb-2">ì˜ˆì•½ ë‚ ì§œ</label>
              <input type="date" id="reservation-date" class="w-full p-3 rounded bg-gray-900 border border-purple-500">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ì˜ˆì•½ ì‹œê°„</label>
              <input type="time" id="reservation-time" class="w-full p-3 rounded bg-gray-900 border border-purple-500">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ì¸ì›ìˆ˜</label>
              <input type="number" id="reservation-people" class="w-full p-3 rounded bg-gray-900 border border-purple-500" min="1" value="2">
            </div>
            <div class="mb-4">
              <label class="block mb-2">ì „í™”ë²ˆí˜¸</label>
              <input type="tel" id="reservation-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="010-1234-5678">
            </div>
          </div>
        </div>

        <div id="checkout-section" class="card glow-border">
          <h3 class="text-2xl font-bold mb-4">ğŸ§¾ ì£¼ë¬¸ ìš”ì•½</h3>
          <div id="cart-summary">
            <p class="text-gray-400">ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
          </div>
          <div class="border-t border-gray-700 mt-4 pt-4">
            <div class="flex justify-between mb-2">
              <span>ì£¼ë¬¸ê¸ˆì•¡</span>
              <span id="subtotal">â‚©0</span>
            </div>
            <div class="flex justify-between mb-2 text-cyan-400">
              <span>ì¿ í°í• ì¸</span>
              <span id="discount">-â‚©0</span>
            </div>
            <div class="flex justify-between mb-2">
              <span>ë°°ë‹¬ë£Œ</span>
              <span id="delivery-fee">â‚©0</span>
            </div>
            <div class="flex justify-between text-2xl font-bold text-purple-400 mt-4">
              <span>ì´ ê²°ì œê¸ˆì•¡</span>
              <span id="total">â‚©0</span>
            </div>
          </div>
          
          <!-- ğŸ’³ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ -->
          <div class="mt-6 p-4 bg-gray-800/50 rounded-lg">
            <h4 class="text-lg font-bold mb-4">ğŸ’³ ê²°ì œ ìˆ˜ë‹¨</h4>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <label class="flex items-center gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-purple-600/30 transition">
                <input type="radio" name="payment-method" value="card" checked class="accent-purple-500">
                <span>ğŸ’³ ì¹´ë“œ</span>
              </label>
              <label class="flex items-center gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-purple-600/30 transition">
                <input type="radio" name="payment-method" value="cash" class="accent-purple-500">
                <span>ğŸ’µ í˜„ê¸ˆ</span>
              </label>
              <label class="flex items-center gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-purple-600/30 transition">
                <input type="radio" name="payment-method" value="transfer" class="accent-purple-500">
                <span>ğŸ¦ ê³„ì¢Œì´ì²´</span>
              </label>
              <label class="flex items-center gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-purple-600/30 transition">
                <input type="radio" name="payment-method" value="kakao" class="accent-purple-500">
                <span>ğŸŸ¡ ì¹´ì¹´ì˜¤í˜ì´</span>
              </label>
            </div>
          </div>
          
          <button onclick="checkout()" class="btn-primary w-full mt-6 text-xl py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
            ğŸ’³ ì¦‰ì‹œ ê²°ì œí•˜ê¸° (ë§¤ì¥ì—ì„œ í• ì¸ ì ìš©)
          </button>
        </div>
      </div>
    </div>

    <!-- ì¿ í° ì§€ê°‘ í˜ì´ì§€ -->
    <div id="wallet-page" class="page">
      <div class="max-w-4xl mx-auto px-4 py-20">
        <h2 class="text-4xl font-black mb-8 gradient-text">ğŸ’° ë‚´ ì¿ í° ì§€ê°‘</h2>
        
        <div class="flex gap-4 mb-8 flex-wrap">
          <button onclick="filterCoupons('all')" class="btn-primary">ì „ì²´</button>
          <button onclick="filterCoupons('available')" class="btn-primary">ì‚¬ìš©ê°€ëŠ¥</button>
          <button onclick="filterCoupons('used')" class="btn-primary">ì‚¬ìš©ì™„ë£Œ</button>
          <button onclick="deleteAllCoupons()" class="btn-primary" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">ğŸ—‘ï¸ ëª¨ë“  ì¿ í° ì‚­ì œ</button>
        </div>
        
        <div id="coupon-list"></div>
      </div>
    </div>

    <!-- ë§¤ì¥ ê´€ë¦¬ í˜ì´ì§€ (ì‚¬ì—…ì â†’ ë§¤ì¥ìœ¼ë¡œ ë³€ê²½) -->
    <div id="business-page" class="page">
      <div class="max-w-6xl mx-auto px-4 py-20">
        <h2 class="text-4xl font-black mb-8 gradient-text">ğŸª ë§¤ì¥ ê´€ë¦¬</h2>
        
        <div class="flex gap-4 mb-8 flex-wrap">
          <button onclick="showBusinessTab('list')" id="btn-business-list" class="btn-primary">ğŸ“‹ ë§¤ì¥ ëª©ë¡</button>
          <button onclick="showBusinessTab('register')" id="btn-business-register" class="btn-primary" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">ğŸš€ ë§¤ì¥ ì…ì í•˜ê¸°</button>
          <button onclick="showBusinessTab('mystore')" id="btn-business-mystore" class="btn-primary" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">ğŸ½ï¸ ë‚´ ë§¤ì¥</button>
          <button onclick="showBusinessTab('coupon-issue')" id="btn-business-coupon" class="btn-primary" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">ğŸ« ì¿ í° ë°œê¸‰</button>
          <button onclick="showBusinessTab('promo')" id="btn-business-promo" class="btn-primary" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">ğŸ“º í™ë³´ í˜ì´ì§€</button>
        </div>

        <!-- ë§¤ì¥ ëª©ë¡ -->
        <div id="business-list-tab" style="display:block;">
          <div class="grid md:grid-cols-3 gap-6" id="store-list-container">
            <div class="card glow-border cursor-pointer" onclick="goToStore('store-001')">
              <!-- í™ë³´ ì˜ìƒ ì„¹ì…˜ -->
              <div id="store-001-video" class="aspect-video bg-gray-900 rounded-lg mb-4 overflow-hidden relative">
                <iframe id="store-001-iframe" src="" class="w-full h-full" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display:none;"></iframe>
                <div id="store-001-placeholder" class="absolute inset-0 flex flex-col items-center justify-center text-gray-500">
                  <span class="text-4xl mb-2">ğŸ¬</span>
                  <span class="text-sm">í™ë³´ ì˜ìƒ</span>
                  <button onclick="event.stopPropagation(); openVideoRegister('store-001')" class="mt-2 px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600">ì˜ìƒ ë“±ë¡</button>
                </div>
              </div>
              <div class="flex items-center gap-3 mb-3">
                <div class="text-4xl">ğŸ±</div>
                <div>
                  <h3 class="text-xl font-bold">ì•„ë¯¸ í•œì •ì‹</h3>
                  <p class="text-gray-400 text-sm">ğŸ“ ì„œìš¸ì‹œ ê°•ë‚¨êµ¬</p>
                </div>
              </div>
              <p class="text-cyan-400 mb-2">â­ 4.8 | ì¿ í° 127ê°œ</p>
              <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ì˜ì—…ì¤‘</span>
            </div>
            <div class="card glow-border cursor-pointer" onclick="goToStore('store-002')">
              <div class="text-6xl mb-4">â˜•</div>
              <h3 class="text-2xl font-bold mb-2">ì•„ë¯¸ ë‹¤ë°©</h3>
              <p class="text-gray-400 mb-2">ğŸ“ ì„œìš¸ì‹œ ê°•ë‚¨êµ¬</p>
              <p class="text-cyan-400">â­ 4.6 | ì¿ í° 89ê°œ</p>
              <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ì˜ì—…ì¤‘</span>
            </div>
            <div class="card glow-border cursor-pointer" onclick="goToStore('store-003')">
              <div class="text-6xl mb-4">ğŸ—</div>
              <h3 class="text-2xl font-bold mb-2">í™©ê¸ˆì˜¬ë¦¬ë¸Œ ì¹˜í‚¨</h3>
              <p class="text-gray-400 mb-2">ğŸ“ ì„œìš¸ì‹œ ì†¡íŒŒêµ¬</p>
              <p class="text-cyan-400">â­ 4.5 | ì¿ í° 56ê°œ</p>
              <span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ìŠ¹ì¸ëŒ€ê¸°</span>
            </div>
            <div class="card glow-border cursor-pointer" onclick="goToStore('store-004')">
              <div class="text-6xl mb-4">ğŸ¥©</div>
              <h3 class="text-2xl font-bold mb-2">í˜„ì‹¤ ë ˆìŠ¤í† ë‘</h3>
              <p class="text-gray-400 mb-2">ğŸ“ ì„œìš¸ì‹œ ì¤‘ë‘êµ¬</p>
              <p class="text-cyan-400">â­ 4.7 | ì¿ í° 45ê°œ</p>
              <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ì˜ì—…ì¤‘</span>
            </div>

            <!-- ğŸ•¶ï¸ ROUNZ ì•ˆê²½ì  - ì™¸ë¶€ ì…ì  ë§¤ì¥ + AR ì²´í—˜ -->
            <div class="card glow-border relative overflow-hidden" style="border-color: #ec4899;">
              <!-- ì…ì  ë°°ì§€ -->
              <div class="absolute top-2 right-2 px-2 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full animate-pulse">
                ğŸ”® AR ì²´í—˜
              </div>
              <!-- ë§¤ì¥ ëŒ€í‘œ ì´ë¯¸ì§€ -->
              <div class="aspect-video bg-gray-900 rounded-lg mb-4 overflow-hidden relative cursor-pointer" onclick="window.open('https://rounz.com/collection.php?collectionIndex=3755', '_blank')">
                <img src="https://image.rounz.com/_data/product/TARTOPTICAL/ARNEL-HERITAGE-BLACK(45)/ARNEL-HERITAGE-BLACK(45)_03.JPG"
                     alt="ROUNZ ì•ˆê²½ì "
                     class="w-full h-full object-cover hover:scale-105 transition duration-500">
                <div class="absolute bottom-2 left-2 flex gap-1">
                  <span class="px-2 py-1 bg-red-500 text-white text-xs font-bold rounded">ì—°ë§íŠ¹ê°€</span>
                  <span class="px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded">ARì§€ì›</span>
                </div>
              </div>
              <div class="flex items-center gap-3 mb-3">
                <div class="text-4xl">ğŸ‘“</div>
                <div>
                  <h3 class="text-xl font-bold">ROUNZ ì•ˆê²½ì </h3>
                  <p class="text-gray-400 text-sm">ğŸ‘— ì˜ë¥˜/íŒ¨ì…˜ Â· ì•ˆê²½í…Œ ì „ë¬¸</p>
                </div>
              </div>
              <p class="text-cyan-400 mb-2">â­ 4.95 | í›„ê¸° 42ê°œ | ğŸšš ë¬´ë£Œë°°ì†¡</p>
              <div class="flex gap-2 flex-wrap mb-3">
                <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ì˜ì—…ì¤‘</span>
                <span class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-sm">ê³µì‹ì…ì </span>
              </div>
              <a href="https://rounz.com/collection.php?collectionIndex=3755" target="_blank" class="block w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-bold text-center text-lg hover:opacity-90 mb-2">
                ğŸ‘“ ì•ˆê²½ ë³´ëŸ¬ê°€ê¸°
              </a>
              <div class="flex gap-2">
                <a href="https://play.google.com/store/apps/details?id=com.rounz.app" target="_blank" class="flex-1 py-2 bg-green-600 text-white rounded text-center text-sm">
                  ğŸ¤– Android
                </a>
                <a href="https://apps.apple.com/kr/app/rounz/id1489227547" target="_blank" class="flex-1 py-2 bg-gray-800 text-white rounded text-center text-sm">
                  ğŸ iOS
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- ğŸš€ ë§¤ì¥ ì…ì í•˜ê¸° (Step-by-Step í”Œë¡œìš°) -->
        <div id="business-register-tab" style="display:none;">
          
          <!-- Step 1: ì…ì  í™˜ì˜ & ì‹œì‘ ë²„íŠ¼ -->
          <!-- ğŸš€ ì§„í–‰ í‘œì‹œê¸° -->
          <div id="register-progress" class="mb-8" style="display:none;">
            <div class="flex justify-between items-center max-w-2xl mx-auto">
              <div class="step-indicator" id="step-ind-1">
                <div class="w-10 h-10 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold">1</div>
                <span class="text-xs mt-1 text-purple-400">ê¸°ë³¸ì •ë³´</span>
              </div>
              <div class="flex-1 h-1 bg-gray-700 mx-2"><div class="step-line h-full bg-purple-500" style="width:0%"></div></div>
              <div class="step-indicator" id="step-ind-2">
                <div class="w-10 h-10 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center font-bold">2</div>
                <span class="text-xs mt-1 text-gray-400">ìš´ì˜ì •ë³´</span>
              </div>
              <div class="flex-1 h-1 bg-gray-700 mx-2"><div class="step-line h-full bg-purple-500" style="width:0%"></div></div>
              <div class="step-indicator" id="step-ind-3">
                <div class="w-10 h-10 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center font-bold">3</div>
                <span class="text-xs mt-1 text-gray-400">ì•½ê´€ë™ì˜</span>
              </div>
              <div class="flex-1 h-1 bg-gray-700 mx-2"><div class="step-line h-full bg-purple-500" style="width:0%"></div></div>
              <div class="step-indicator" id="step-ind-4">
                <div class="w-10 h-10 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center font-bold">4</div>
                <span class="text-xs mt-1 text-gray-400">ì™„ë£Œ</span>
              </div>
            </div>
          </div>

          <!-- Step 0: í™˜ì˜ í™”ë©´ -->
          <div id="register-step-welcome" class="card glow-border text-center py-12">
            <div class="text-8xl mb-6">ğŸš€</div>
            <h3 class="text-3xl font-black mb-4 gradient-text">AIRCTT ë§¤ì¥ ì…ì </h3>
            <p class="text-xl text-gray-300 mb-2">AR ì¿ í° ê²Œì„ìœ¼ë¡œ ê³ ê°ì„ ë§Œë‚˜ì„¸ìš”!</p>
            <p class="text-gray-400 mb-8">ì…ì  í›„ ì¿ í° ë°œê¸‰ â†’ ê²Œì„ ë°°í¬ â†’ ê³ ê° ë°©ë¬¸ â†’ ë§¤ì¶œ ì¦ëŒ€!</p>
            
            <div class="grid md:grid-cols-3 gap-6 max-w-3xl mx-auto mb-8 text-left">
              <div class="bg-purple-500/10 p-4 rounded-lg border border-purple-500/30">
                <div class="text-3xl mb-2">ğŸ®</div>
                <h4 class="font-bold mb-1">ê²Œì„ ì—°ë™</h4>
                <p class="text-sm text-gray-400">ê³ ê°ì´ AR ê²Œì„ì—ì„œ ë§¤ì¥ ì¿ í° íšë“</p>
              </div>
              <div class="bg-cyan-500/10 p-4 rounded-lg border border-cyan-500/30">
                <div class="text-3xl mb-2">ğŸ“Š</div>
                <h4 class="font-bold mb-1">ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</h4>
                <p class="text-sm text-gray-400">ì£¼ë¬¸ í˜„í™©, ë§¤ì¶œ í†µê³„ ì‹¤ì‹œê°„ í™•ì¸</p>
              </div>
              <div class="bg-pink-500/10 p-4 rounded-lg border border-pink-500/30">
                <div class="text-3xl mb-2">ğŸ’°</div>
                <h4 class="font-bold mb-1">ì¿ í° ë°œê¸‰</h4>
                <p class="text-sm text-gray-400">ì¥ë‹¹ 50ì›ìœ¼ë¡œ íš¨ìœ¨ì  ë§ˆì¼€íŒ…</p>
              </div>
            </div>
            
            <button onclick="startRegistration()" class="btn-primary text-xl px-12 py-4">ğŸš€ ë§¤ì¥ ì…ì  ì‹œì‘í•˜ê¸°</button>
          </div>
          
          <!-- Step 1: ê¸°ë³¸ì •ë³´ (ì‚¬ì—…ì/ë‹´ë‹¹ì) - íšŒì‚¬ì†Œê°œì„œ ìŠ¤íƒ€ì¼ -->
          <div id="register-step-basic" style="display:none;" class="card glow-border">
            <h3 class="text-2xl font-bold mb-2">ğŸ“ STEP 1. ê¸°ë³¸ ì •ë³´ (ì‚¬ì—…ì/ë‹´ë‹¹ì)</h3>
            <p class="text-gray-400 mb-6">ë§¤ì¥ì˜ ì‚¬ì—…ì ì •ë³´ì™€ ë‹´ë‹¹ì ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            
            <!-- í•„ìˆ˜ ì •ë³´ ì„¹ì…˜ -->
            <div class="bg-purple-500/10 border border-purple-500/30 rounded-lg p-4 mb-6">
              <h4 class="font-bold text-purple-400 mb-4 flex items-center gap-2">
                <span class="text-red-400">*</span> í•„ìˆ˜ ì •ë³´
              </h4>
              
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2 font-bold">ìƒí˜¸(ë§¤ì¥ëª…) <span class="text-red-400">*</span></label>
                  <input type="text" id="reg-store-name" class="w-full p-3 rounded bg-gray-900 border border-purple-500 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400/20 transition" placeholder="ì˜ˆ: ì•„ë¯¸ í•œì •ì‹" required>
                </div>
                <div>
                  <label class="block mb-2 font-bold">ëŒ€í‘œìëª… <span class="text-red-400">*</span></label>
                  <input type="text" id="reg-owner-name" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="í™ê¸¸ë™" required>
                </div>
              </div>
              
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2 font-bold">ë‹´ë‹¹ìëª… <span class="text-red-400">*</span></label>
                  <input type="text" id="reg-manager-name" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ê¹€ë‹´ë‹¹" required>
                </div>
                <div>
                  <label class="block mb-2 font-bold">íœ´ëŒ€í° <span class="text-red-400">*</span></label>
                  <input type="tel" id="reg-owner-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="010-1234-5678" required>
                </div>
              </div>
              
              <div class="mb-4">
                <label class="block mb-2 font-bold">ì´ë©”ì¼ <span class="text-red-400">*</span></label>
                <input type="email" id="reg-email" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="store@example.com" required>
              </div>
              
              <div class="mb-4">
                <label class="block mb-2 font-bold">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ <span class="text-red-400">*</span></label>
                <input type="text" id="reg-biz-number" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="123-45-67890" required>
                <p class="text-xs text-gray-500 mt-1">'-' í¬í•¨í•˜ì—¬ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
              </div>
              
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2 font-bold">ë²•ì¸ëª… <span class="text-gray-500">(í•´ë‹¹ ì‹œ)</span></label>
                  <input type="text" id="reg-corp-name" class="w-full p-3 rounded bg-gray-900 border border-gray-600" placeholder="(ì£¼)ë°œë¡œë ˆ">
                </div>
                <div>
                  <label class="block mb-2 font-bold">ë²•ì¸ë“±ë¡ë²ˆí˜¸ <span class="text-gray-500">(í•´ë‹¹ ì‹œ)</span></label>
                  <input type="text" id="reg-corp-number" class="w-full p-3 rounded bg-gray-900 border border-gray-600" placeholder="110111-1234567">
                </div>
              </div>
              
              <div class="mb-4">
                <label class="block mb-2 font-bold">ì‚¬ì—…ì¥ ì†Œì¬ì§€ <span class="text-red-400">*</span></label>
                <div class="flex gap-2 mb-2">
                  <input type="text" id="reg-zipcode" class="w-32 p-3 rounded bg-gray-900 border border-purple-500" placeholder="ìš°í¸ë²ˆí˜¸" readonly>
                  <button type="button" onclick="searchAddress()" class="px-4 py-2 bg-cyan-500 rounded font-bold hover:bg-cyan-600 transition">ğŸ” ì£¼ì†Œ ê²€ìƒ‰</button>
                </div>
                <input type="text" id="reg-address" class="w-full p-3 rounded bg-gray-900 border border-purple-500 mb-2" placeholder="ê¸°ë³¸ ì£¼ì†Œ" required>
                <input type="text" id="reg-address-detail" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ìƒì„¸ ì£¼ì†Œ (ì¸µ, í˜¸ìˆ˜ ë“±)">
              </div>
              
              <div>
                <label class="block mb-2 font-bold">ì—…ì¢… ì„ íƒ <span class="text-red-400">*</span></label>
                <select id="reg-category" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required multiple size="5" style="scrollbar-width: thin;">
                  <optgroup label="ğŸ½ï¸ ìŒì‹ì ">
                    <option value="korean">í•œì‹</option>
                    <option value="chinese">ì¤‘ì‹</option>
                    <option value="japanese">ì¼ì‹</option>
                    <option value="western">ì–‘ì‹</option>
                    <option value="cafe">ì¹´í˜</option>
                    <option value="chicken">ì¹˜í‚¨</option>
                    <option value="snack">ë¶„ì‹</option>
                    <option value="bakery">ë² ì´ì»¤ë¦¬</option>
                  </optgroup>
                  <optgroup label="ğŸ›’ ìœ í†µ">
                    <option value="mart">ë§ˆíŠ¸</option>
                    <option value="market">ì¬ë˜ì‹œì¥</option>
                    <option value="convenience">í¸ì˜ì </option>
                  </optgroup>
                  <optgroup label="ğŸ‘— íŒ¨ì…˜/ë·°í‹°">
                    <option value="clothing">ì˜ë¥˜</option>
                    <option value="shoes">ì‹ ë°œ/ì¡í™”</option>
                    <option value="accessories">ì•¡ì„¸ì„œë¦¬</option>
                    <option value="beauty">ë·°í‹°/ë¯¸ìš©</option>
                  </optgroup>
                  <optgroup label="ğŸ¯ ê¸°íƒ€">
                    <option value="sports">ìŠ¤í¬ì¸ /í—¬ìŠ¤</option>
                    <option value="education">êµìœ¡</option>
                    <option value="service">ì„œë¹„ìŠ¤ì—…</option>
                    <option value="etc">ê¸°íƒ€</option>
                  </optgroup>
                </select>
                <p class="text-xs text-gray-500 mt-1">Ctrl+í´ë¦­ìœ¼ë¡œ ì—¬ëŸ¬ ì—…ì¢… ì„ íƒ ê°€ëŠ¥</p>
              </div>
            </div>
            
            <!-- ì„ íƒ ì •ë³´ ì„¹ì…˜ -->
            <div class="bg-cyan-500/10 border border-cyan-500/30 rounded-lg p-4 mb-6">
              <h4 class="font-bold text-cyan-400 mb-4">ğŸ“‹ ì„ íƒ ì •ë³´</h4>
              
              <div class="mb-4">
                <label class="block mb-2 font-bold">ê³ ê°ì„¼í„° ì „í™”</label>
                <input type="tel" id="reg-cs-phone" class="w-full p-3 rounded bg-gray-900 border border-gray-600" placeholder="02-1234-5678">
              </div>
              
              <div class="grid md:grid-cols-3 gap-4">
                <div>
                  <label class="block mb-2 font-bold">ì •ì‚° ì€í–‰</label>
                  <select id="reg-bank" class="w-full p-3 rounded bg-gray-900 border border-gray-600">
                    <option value="">ì„ íƒ</option>
                    <option value="kb">êµ­ë¯¼ì€í–‰</option>
                    <option value="shinhan">ì‹ í•œì€í–‰</option>
                    <option value="woori">ìš°ë¦¬ì€í–‰</option>
                    <option value="hana">í•˜ë‚˜ì€í–‰</option>
                    <option value="nh">ë†í˜‘</option>
                    <option value="ibk">ê¸°ì—…ì€í–‰</option>
                    <option value="kakao">ì¹´ì¹´ì˜¤ë±…í¬</option>
                    <option value="toss">í† ìŠ¤ë±…í¬</option>
                  </select>
                </div>
                <div>
                  <label class="block mb-2 font-bold">ê³„ì¢Œë²ˆí˜¸</label>
                  <input type="text" id="reg-account" class="w-full p-3 rounded bg-gray-900 border border-gray-600" placeholder="123-456-789012">
                </div>
                <div>
                  <label class="block mb-2 font-bold">ì˜ˆê¸ˆì£¼</label>
                  <input type="text" id="reg-account-holder" class="w-full p-3 rounded bg-gray-900 border border-gray-600" placeholder="í™ê¸¸ë™">
                </div>
              </div>
            </div>
            
            <!-- âœ… í”Œë«í¼ ìš´ì˜ì ì •ë³´ (ê³ ì • í‘œì‹œ) -->
            <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-6">
              <h4 class="font-bold text-yellow-400 mb-3 flex items-center gap-2">
                <span>ğŸ¢</span> í”Œë«í¼ ìš´ì˜ì ì •ë³´
              </h4>
              <div class="grid md:grid-cols-2 gap-4 text-sm">
                <div class="space-y-2">
                  <p><span class="text-gray-400">ìƒí˜¸:</span> <span class="text-white font-bold">ì£¼)ë°œë¡œë ˆ</span></p>
                  <p><span class="text-gray-400">ê´€ë¦¬ì:</span> <span class="text-white">ì˜¤í˜„ì‹¤</span></p>
                  <p><span class="text-gray-400">ì—°ë½ì²˜:</span> <span class="text-cyan-400">010-2187-8890</span></p>
                </div>
                <div class="space-y-2">
                  <p><span class="text-gray-400">ì´ë©”ì¼:</span> <span class="text-cyan-400">zeus1404@gmail.com</span></p>
                  <p><span class="text-gray-400">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:</span> <span class="text-white">123-45-67890</span></p>
                  <p><span class="text-gray-400">í†µì‹ íŒë§¤ì—…:</span> <span class="text-white">ì œ2025-ì„œìš¸ê°•ë‚¨-00001í˜¸</span></p>
                </div>
              </div>
            </div>
            
            <div class="flex gap-4">
              <button type="button" onclick="showRegisterStep('welcome')" class="px-6 py-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition">â† ì´ì „</button>
              <button type="button" onclick="goToStep2()" class="btn-primary flex-1 text-lg py-4">ë‹¤ìŒ ë‹¨ê³„ â†’</button>
            </div>
          </div>
          
          <!-- Step 2: ìš´ì˜ì •ë³´ -->
          <div id="register-step-operation" style="display:none;" class="card glow-border">
            <h3 class="text-2xl font-bold mb-2">ğŸª STEP 2. ìš´ì˜ ì •ë³´</h3>
            <p class="text-gray-400 mb-6">ë§¤ì¥ ìš´ì˜ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            
            <div class="mb-4">
              <label class="block mb-2 font-bold">ë§¤ì¥ ì£¼ì†Œ <span class="text-red-400">*</span></label>
              <div class="flex gap-2 mb-2">
                <input type="text" id="reg-zipcode" class="w-32 p-3 rounded bg-gray-900 border border-purple-500" placeholder="ìš°í¸ë²ˆí˜¸" readonly>
                <button type="button" onclick="searchAddress()" class="px-4 py-2 bg-cyan-500 rounded font-bold hover:bg-cyan-600 transition">ğŸ” ì£¼ì†Œ ê²€ìƒ‰</button>
              </div>
              <input type="text" id="reg-address" class="w-full p-3 rounded bg-gray-900 border border-purple-500 mb-2" placeholder="ê¸°ë³¸ ì£¼ì†Œ" required>
              <input type="text" id="reg-address-detail" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ìƒì„¸ ì£¼ì†Œ (ì¸µ, í˜¸ìˆ˜ ë“±)">
            </div>
            
            <div class="mb-4">
              <label class="block mb-2 font-bold">ë§¤ì¥ ì „í™”ë²ˆí˜¸ <span class="text-red-400">*</span></label>
              <input type="tel" id="reg-store-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="02-1234-5678" required>
            </div>
            
            <div class="grid md:grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block mb-2 font-bold">ì˜ì—…ì‹œê°„</label>
                <input type="text" id="reg-hours" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="10:00 - 22:00">
              </div>
              <div>
                <label class="block mb-2 font-bold">íœ´ë¬´ì¼</label>
                <input type="text" id="reg-closed" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ë§¤ì£¼ ì¼ìš”ì¼">
              </div>
            </div>
            
            <div class="mb-4">
              <label class="block mb-2 font-bold">ë§¤ì¥ ì†Œê°œ</label>
              <textarea id="reg-description" class="w-full p-3 rounded bg-gray-900 border border-purple-500 min-h-[100px]" placeholder="ê³ ê°ì—ê²Œ ë³´ì—¬ì¤„ ë§¤ì¥ ì†Œê°œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
            </div>

            <div class="mb-6">
              <label class="block mb-2 font-bold">ë§¤ì¥ ëŒ€í‘œ ì´ë¯¸ì§€</label>
              <div class="border border-dashed border-purple-500 rounded-lg p-6 text-center bg-gray-800/50">
                <input type="file" id="reg-image" accept="image/*" class="hidden" onchange="previewRegImage(this)">
                <div id="reg-image-preview" class="text-5xl mb-2">ğŸ“·</div>
                <button type="button" onclick="document.getElementById('reg-image').click()" class="px-4 py-2 bg-purple-500 rounded hover:bg-purple-600 transition">ì´ë¯¸ì§€ ì„ íƒ</button>
                <p class="text-xs text-gray-500 mt-2">ê¶Œì¥: 800x600px, ìµœëŒ€ 5MB</p>
              </div>
            </div>

            <!-- ğŸ”— ì™¸ë¶€ ì—°ë™ ì •ë³´ ì„¹ì…˜ -->
            <div class="bg-gradient-to-r from-cyan-500/10 to-purple-500/10 border border-cyan-500/30 rounded-lg p-4 mb-6">
              <h4 class="font-bold text-cyan-400 mb-4 flex items-center gap-2">
                <span>ğŸ”—</span> ì™¸ë¶€ ì—°ë™ ì •ë³´ (ì„ íƒ)
              </h4>

              <!-- ë§¤ì¥ í™ˆí˜ì´ì§€ URL -->
              <div class="mb-4">
                <label class="block mb-2 font-bold">ğŸŒ ë§¤ì¥ í™ˆí˜ì´ì§€/ì‡¼í•‘ëª° URL</label>
                <input type="url" id="reg-homepage-url" class="w-full p-3 rounded bg-gray-900 border border-cyan-500 focus:ring-2 focus:ring-cyan-400/50" placeholder="https://example.com ë˜ëŠ” https://smartstore.naver.com/...">
                <p class="text-xs text-gray-500 mt-1">ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´, ì¿ íŒ¡, ìì‚¬ëª° ë“± ê¸°ì¡´ ì‡¼í•‘ëª° URL ì…ë ¥</p>
              </div>

              <!-- í™ë³´ ì˜ìƒ URL -->
              <div class="mb-4">
                <label class="block mb-2 font-bold">ğŸ¬ í™ë³´ ì˜ìƒ URL</label>
                <div class="flex gap-2">
                  <input type="url" id="reg-video-url" class="flex-1 p-3 rounded bg-gray-900 border border-purple-500 focus:ring-2 focus:ring-purple-400/50" placeholder="https://youtube.com/watch?v=... ë˜ëŠ” https://youtu.be/...">
                  <button type="button" onclick="previewVideoURL()" class="px-4 py-2 bg-purple-500 rounded font-bold hover:bg-purple-600 transition">ë¯¸ë¦¬ë³´ê¸°</button>
                </div>
                <p class="text-xs text-gray-500 mt-1">YouTube, Vimeo ë“± ì˜ìƒ URL ì…ë ¥</p>
                <div id="video-preview-container" class="mt-3 hidden">
                  <div class="aspect-video bg-gray-800 rounded-lg overflow-hidden">
                    <iframe id="video-preview-iframe" class="w-full h-full" frameborder="0" allowfullscreen></iframe>
                  </div>
                </div>
              </div>

              <!-- AR/VR ì²´í—˜ URL (ROUNZ ë“±) -->
              <div class="mb-4">
                <label class="block mb-2 font-bold">ğŸ”® AR/VR ì²´í—˜ URL</label>
                <input type="url" id="reg-ar-url" class="w-full p-3 rounded bg-gray-900 border border-pink-500 focus:ring-2 focus:ring-pink-400/50" placeholder="https://rounz.com/product.php?... ë˜ëŠ” AR ì•± ë§í¬">
                <p class="text-xs text-gray-500 mt-1">ROUNZ, ê¸°íƒ€ AR ì²´í—˜ í˜ì´ì§€ URL (ì•ˆê²½, í™”ì¥í’ˆ ë“±)</p>
              </div>

              <!-- íŒŒì¼ ë‹¤ìš´ë¡œë“œ URL -->
              <div class="mb-4">
                <label class="block mb-2 font-bold">ğŸ“¥ ì•±/íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬</label>
                <div class="grid md:grid-cols-2 gap-3">
                  <div>
                    <input type="url" id="reg-app-android" class="w-full p-3 rounded bg-gray-900 border border-green-500" placeholder="Google Play Store URL">
                    <p class="text-xs text-gray-500 mt-1">ğŸ¤– Android ì•±</p>
                  </div>
                  <div>
                    <input type="url" id="reg-app-ios" class="w-full p-3 rounded bg-gray-900 border border-blue-500" placeholder="App Store URL">
                    <p class="text-xs text-gray-500 mt-1">ğŸ iOS ì•±</p>
                  </div>
                </div>
              </div>

              <!-- SNS ì—°ë™ -->
              <div>
                <label class="block mb-2 font-bold">ğŸ“± SNS ê³„ì •</label>
                <div class="grid md:grid-cols-2 gap-3">
                  <input type="url" id="reg-sns-instagram" class="w-full p-3 rounded bg-gray-900 border border-pink-400" placeholder="Instagram URL">
                  <input type="url" id="reg-sns-youtube" class="w-full p-3 rounded bg-gray-900 border border-red-500" placeholder="YouTube ì±„ë„ URL">
                  <input type="url" id="reg-sns-naver" class="w-full p-3 rounded bg-gray-900 border border-green-400" placeholder="ë„¤ì´ë²„ ë¸”ë¡œê·¸ URL">
                  <input type="url" id="reg-sns-kakao" class="w-full p-3 rounded bg-gray-900 border border-yellow-500" placeholder="ì¹´ì¹´ì˜¤í†¡ ì±„ë„ URL">
                </div>
              </div>
            </div>
            
            <div class="flex gap-4">
              <button type="button" onclick="showRegisterStep('basic')" class="px-6 py-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition">â† ì´ì „</button>
              <button type="button" onclick="goToStep3()" class="btn-primary flex-1 text-lg py-4">ë‹¤ìŒ ë‹¨ê³„ â†’</button>
            </div>
          </div>
          
          <!-- Step 3: ì•½ê´€ ë™ì˜ -->
          <div id="register-step-agreement" style="display:none;" class="card glow-border">
            <h3 class="text-2xl font-bold mb-2">ğŸ“‹ STEP 3. ì•½ê´€ ë™ì˜</h3>
            <p class="text-gray-400 mb-6">AIRCTT í”Œë«í¼ ì´ìš©ì„ ìœ„í•´ ì•„ë˜ ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.</p>
            
            <div class="space-y-4 mb-8">
              <label class="flex items-start gap-3 p-4 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                <input type="checkbox" id="agree-terms" class="mt-1 w-5 h-5 accent-purple-500">
                <div>
                  <span class="font-bold text-white">ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ (í•„ìˆ˜)</span>
                  <p class="text-sm text-gray-400 mt-1">AIRCTT í”Œë«í¼ ì„œë¹„ìŠ¤ ì´ìš©ì— ëŒ€í•œ ê¸°ë³¸ ì•½ê´€ì…ë‹ˆë‹¤.</p>
                  <button type="button" onclick="showTermsModal('terms')" class="text-cyan-400 text-sm underline mt-1">ì „ë¬¸ ë³´ê¸° â†’</button>
                </div>
              </label>
              
              <label class="flex items-start gap-3 p-4 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                <input type="checkbox" id="agree-privacy" class="mt-1 w-5 h-5 accent-purple-500">
                <div>
                  <span class="font-bold text-white">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ (í•„ìˆ˜)</span>
                  <p class="text-sm text-gray-400 mt-1">ì‚¬ì—…ì ë° ê³ ê° ê°œì¸ì •ë³´ ìˆ˜ì§‘/ì´ìš©ì— ëŒ€í•œ ì •ì±…ì…ë‹ˆë‹¤.</p>
                  <button type="button" onclick="showTermsModal('privacy')" class="text-cyan-400 text-sm underline mt-1">ì „ë¬¸ ë³´ê¸° â†’</button>
                </div>
              </label>
              
              <label class="flex items-start gap-3 p-4 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                <input type="checkbox" id="agree-fee" class="mt-1 w-5 h-5 accent-purple-500">
                <div>
                  <span class="font-bold text-white">ìˆ˜ìˆ˜ë£Œ ì •ì±… ë™ì˜ (í•„ìˆ˜)</span>
                  <p class="text-sm text-gray-400 mt-1">ì¿ í° ë°œê¸‰ ë¹„ìš© (ì¥ë‹¹ 50ì›) ë° ê²°ì œ ìˆ˜ìˆ˜ë£Œ ì •ì±…ì— ë™ì˜í•©ë‹ˆë‹¤.</p>
                  <div class="bg-yellow-500/10 p-2 rounded mt-2">
                    <p class="text-yellow-400 text-sm">ğŸ’° ì¿ í° ë°œê¸‰: ì¥ë‹¹ 50ì› | ê²°ì œ ìˆ˜ìˆ˜ë£Œ: ê±°ë˜ê¸ˆì•¡ì˜ 3.3%</p>
                  </div>
                </div>
              </label>
              
              <label class="flex items-start gap-3 p-4 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                <input type="checkbox" id="agree-operation" class="mt-1 w-5 h-5 accent-purple-500">
                <div>
                  <span class="font-bold text-white">ìš´ì˜ ê·œì • ë™ì˜ (í•„ìˆ˜)</span>
                  <p class="text-sm text-gray-400 mt-1">ë§¤ì¥ ìš´ì˜ ë° ì¿ í° ê´€ë¦¬ì— ëŒ€í•œ ê·œì •ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.</p>
                </div>
              </label>
              
              <label class="flex items-start gap-3 p-4 bg-purple-500/10 rounded-lg cursor-pointer hover:bg-purple-500/20 transition border border-purple-500/30">
                <input type="checkbox" id="agree-all" class="mt-1 w-5 h-5 accent-purple-500" onchange="toggleAllAgreements(this)">
                <div>
                  <span class="font-bold text-purple-400">âœ… ì „ì²´ ë™ì˜</span>
                  <p class="text-sm text-gray-400 mt-1">ìœ„ ëª¨ë“  ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤.</p>
                </div>
              </label>
            </div>
            
            <div class="flex gap-4">
              <button onclick="showRegisterStep('operation')" class="px-6 py-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition">â† ì´ì „</button>
              <button onclick="submitFinalRegistration()" class="btn-primary flex-1 text-lg py-4">ğŸš€ ì…ì  ì‹ ì²­ ì™„ë£Œ</button>
            </div>
          </div>
          
          <!-- Step 4: ì‹ ì²­ ì™„ë£Œ -->
          <div id="register-step-complete" style="display:none;" class="card glow-border text-center py-12">
            <div class="text-8xl mb-6">ğŸ‰</div>
            <h3 class="text-3xl font-black mb-4 gradient-text">ì…ì  ì‹ ì²­ ì™„ë£Œ!</h3>
            <p class="text-xl text-gray-300 mb-2">ê´€ë¦¬ì ê²€í†  í›„ ìŠ¹ì¸ ì•ˆë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
            <p class="text-gray-400 mb-8">ë³´í†µ 1-2 ì˜ì—…ì¼ ë‚´ ì²˜ë¦¬ë©ë‹ˆë‹¤.</p>
            
            <div class="bg-gray-800/50 p-6 rounded-lg max-w-md mx-auto mb-8">
              <h4 class="font-bold mb-4">ğŸ“‹ ì‹ ì²­ í˜„í™©</h4>
              <div class="text-left space-y-2">
                <p><span class="text-gray-400">ìƒí˜¸ëª…:</span> <span id="submitted-store-name">-</span></p>
                <p><span class="text-gray-400">ì‹ ì²­ì¼:</span> <span id="submitted-date">-</span></p>
                <p><span class="text-gray-400">ìƒíƒœ:</span> <span class="text-yellow-400">â³ ìŠ¹ì¸ ëŒ€ê¸°ì¤‘</span></p>
              </div>
            </div>
            
            <button onclick="showBusinessTab('mystore')" class="btn-primary text-lg px-8 py-3">ë‚´ ë§¤ì¥ í™•ì¸í•˜ê¸° â†’</button>
          </div>
        </div>

        <!-- ğŸ½ï¸ ë‚´ ë§¤ì¥ íƒ­ -->
        <div id="business-mystore-tab" style="display:none;">
          
          <!-- ğŸ° Golden Rabbit CFO ìœ„ì ¯ (ë‚´ ë§¤ì¥ íƒ­ ìµœìƒë‹¨) -->
          <div id="golden-rabbit-main" class="card mb-6" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); border: 2px solid #f59e0b; position: relative; overflow: hidden;">
            <!-- ë°°ê²½ íŒŒí‹°í´ íš¨ê³¼ -->
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 20% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.1) 0%, transparent 50%); pointer-events: none;"></div>
            
            <div class="flex items-start gap-4 relative z-10">
              <!-- í† ë¼ ì•„ë°”íƒ€ -->
              <div class="flex-shrink-0">
                <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 36px; box-shadow: 0 0 30px rgba(245, 158, 11, 0.6); animation: pulse 2s infinite;">
                  ğŸ°
                </div>
              </div>
              
              <!-- ì½˜í…ì¸  -->
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-2">
                  <h4 class="font-bold text-xl" style="color: #f59e0b;">Golden Rabbit CFO</h4>
                  <span class="px-2 py-0.5 text-xs font-bold rounded" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #000;">PRO</span>
                </div>
                <p class="text-sm text-gray-400 mb-3">â— Gemini 1.5 Pro Connected</p>
                
                <!-- AI ë¶„ì„ ê²°ê³¼ -->
                <div id="rabbit-main-analysis" class="bg-black/30 rounded-lg p-4 mb-4">
                  <div class="flex items-center gap-2 mb-3">
                    <span class="text-lg">ğŸ°</span>
                    <span class="font-bold text-yellow-400">ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„ ê²°ê³¼</span>
                  </div>
                  <ul class="space-y-1 text-sm">
                    <li>â€¢ ì´ ë§¤ì¶œ: <span class="text-cyan-400 font-bold">â‚©340,000</span> (ì „ì¼ ëŒ€ë¹„ <span class="text-green-400">+12%</span>)</li>
                    <li>â€¢ ì£¼ë¬¸ ê±´ìˆ˜: <span class="text-white font-bold">12ê±´</span></li>
                    <li>â€¢ ê°ë‹¨ê°€: <span class="text-white font-bold">â‚©28,333</span></li>
                  </ul>
                  <div class="mt-3 pt-3 border-t border-gray-700">
                    <p class="text-sm">ğŸ¯ í”¼í¬ ì‹œê°„ëŒ€: <span class="text-cyan-400">ì˜¤í›„ 12ì‹œ~1ì‹œ (ì ì‹¬)</span></p>
                    <p class="text-sm text-yellow-300">ğŸ’¡ ì¶”ì²œ: ì €ë… ì‹œê°„ëŒ€ í”„ë¡œëª¨ì…˜ ê°•í™”í•˜ë©´ ë§¤ì¶œ 20% ìƒìŠ¹ ì˜ˆìƒë©ë‹ˆë‹¤!</p>
                  </div>
                </div>
                
                <!-- ë¹ ë¥¸ ì§ˆë¬¸ ë²„íŠ¼ -->
                <div class="flex gap-2 flex-wrap mb-3">
                  <button onclick="askRabbitMain('sales')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                    ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„í•´ì¤˜
                  </button>
                  <button onclick="askRabbitMain('tax')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                    ğŸ“‹ ì„¸ë¬´ ì‹ ê³  ë„ì™€ì¤˜
                  </button>
                  <button onclick="askRabbitMain('marketing')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                    ğŸ“¢ ë§ˆì¼€íŒ… ì¡°ì–¸í•´ì¤˜
                  </button>
                </div>
                
                <!-- ì±„íŒ… ì…ë ¥ -->
                <div class="flex gap-2">
                  <input type="text" id="rabbit-main-input" class="flex-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-sm" placeholder="Golden Rabbitì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”... ğŸ°" onkeypress="if(event.key==='Enter')sendToRabbitMain()">
                  <button onclick="sendToRabbitMain()" class="px-4 py-2 rounded-lg font-bold text-sm" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #000;">
                    ê³ ë§ˆì›Œ ğŸ°ğŸ°ğŸ¤©ğŸ‘
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- ë‚´ ë§¤ì¥ ëª©ë¡ -->
          <div id="my-store-list" class="mb-8">
            <h3 class="text-2xl font-bold mb-4">ğŸ“Œ ë‚´ ë§¤ì¥</h3>
            <div id="my-stores-container" class="grid md:grid-cols-2 gap-6">
              <!-- ë™ì  ë¡œë“œ -->
            </div>
          </div>
          
          <!-- ì„ íƒëœ ë§¤ì¥ ëŒ€ì‹œë³´ë“œ -->
          <div id="my-store-dashboard" style="display:none;">
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-2xl font-bold"><span id="selected-store-name">ì•„ë¯¸ í•œì •ì‹</span> ëŒ€ì‹œë³´ë“œ</h3>
              <button onclick="document.getElementById('my-store-dashboard').style.display='none'" class="text-gray-400 hover:text-white">âœ• ë‹«ê¸°</button>
            </div>
            
            <!-- ğŸ° Golden Rabbit CFO ìœ„ì ¯ -->
            <div id="golden-rabbit-widget" class="card mb-6" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); border: 2px solid #f59e0b; position: relative; overflow: hidden;">
              <!-- ë°°ê²½ íŒŒí‹°í´ íš¨ê³¼ -->
              <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 20% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.1) 0%, transparent 50%); pointer-events: none;"></div>
              
              <div class="flex items-start gap-4 relative z-10">
                <!-- í† ë¼ ì•„ë°”íƒ€ -->
                <div class="flex-shrink-0">
                  <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: 0 0 20px rgba(245, 158, 11, 0.5);">
                    ğŸ°
                  </div>
                </div>
                
                <!-- ì½˜í…ì¸  -->
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <h4 class="font-bold text-lg" style="color: #f59e0b;">Golden Rabbit CFO</h4>
                    <span class="px-2 py-0.5 text-xs font-bold rounded" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #000;">PRO</span>
                  </div>
                  <p class="text-sm text-gray-400 mb-3">â— Gemini 1.5 Pro Connected</p>
                  
                  <!-- AI ë¶„ì„ ê²°ê³¼ -->
                  <div id="rabbit-analysis" class="bg-black/30 rounded-lg p-4 mb-4">
                    <div class="flex items-center gap-2 mb-3">
                      <span class="text-lg">ğŸ°</span>
                      <span class="font-bold text-yellow-400">ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„ ê²°ê³¼</span>
                    </div>
                    <ul class="space-y-1 text-sm">
                      <li>â€¢ ì´ ë§¤ì¶œ: <span class="text-cyan-400 font-bold">â‚©340,000</span> (ì „ì¼ ëŒ€ë¹„ <span class="text-green-400">+12%</span>)</li>
                      <li>â€¢ ì£¼ë¬¸ ê±´ìˆ˜: <span class="text-white font-bold">12ê±´</span></li>
                      <li>â€¢ ê°ë‹¨ê°€: <span class="text-white font-bold">â‚©28,333</span></li>
                    </ul>
                    <div class="mt-3 pt-3 border-t border-gray-700">
                      <p class="text-sm">ğŸ¯ í”¼í¬ ì‹œê°„ëŒ€: <span class="text-cyan-400">ì˜¤í›„ 12ì‹œ~1ì‹œ (ì ì‹¬)</span></p>
                      <p class="text-sm text-yellow-300">ğŸ’¡ ì¶”ì²œ: ì €ë… ì‹œê°„ëŒ€ í”„ë¡œëª¨ì…˜ ê°•í™”í•˜ë©´ ë§¤ì¶œ 20% ìƒìŠ¹ ì˜ˆìƒë©ë‹ˆë‹¤!</p>
                    </div>
                  </div>
                  
                  <!-- ë¹ ë¥¸ ì§ˆë¬¸ ë²„íŠ¼ -->
                  <div class="flex gap-2 flex-wrap mb-3">
                    <button onclick="askRabbit('sales')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                      ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„í•´ì¤˜
                    </button>
                    <button onclick="askRabbit('tax')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                      ğŸ“‹ ì„¸ë¬´ ì‹ ê³  ë„ì™€ì¤˜
                    </button>
                    <button onclick="askRabbit('marketing')" class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm transition flex items-center gap-1">
                      ğŸ“¢ ë§ˆì¼€íŒ… ì¡°ì–¸í•´ì¤˜
                    </button>
                  </div>
                  
                  <!-- ì±„íŒ… ì…ë ¥ -->
                  <div class="flex gap-2">
                    <input type="text" id="rabbit-input" class="flex-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-sm" placeholder="Golden Rabbitì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”... ğŸ°">
                    <button onclick="sendToRabbit()" class="px-4 py-2 rounded-lg font-bold text-sm" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #000;">
                      ê³ ë§ˆì›Œ ğŸ°ğŸ°ğŸ¤©ğŸ‘
                    </button>
                  </div>
                </div>
                
                <!-- ë‹«ê¸° ë²„íŠ¼ -->
                <button onclick="toggleRabbitWidget()" class="text-gray-400 hover:text-white text-xl">Ã—</button>
              </div>
            </div>
            
            <!-- ë§¤ì¥ ëŒ€ì‹œë³´ë“œ íƒ­ -->
            <div class="flex gap-2 mb-6 flex-wrap">
              <button onclick="showMyStoreDashTab('orders')" id="mystore-tab-orders" class="px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-lg font-bold">ğŸ“¦ ì£¼ë¬¸ ì²˜ë¦¬</button>
              <button onclick="showMyStoreDashTab('sales')" id="mystore-tab-sales" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">ğŸ’° ë§¤ì¶œ í˜„í™©</button>
              <button onclick="showMyStoreDashTab('coupons')" id="mystore-tab-coupons" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">ğŸ« ì¿ í° í˜„í™©</button>
              <button onclick="showMyStoreDashTab('decorate')" id="mystore-tab-decorate" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">ğŸ¨ ë§¤ì¥ ê¾¸ë¯¸ê¸°</button>
            </div>
            
            <!-- ğŸ“¦ ì£¼ë¬¸ ì²˜ë¦¬ ëŒ€ì‹œë³´ë“œ -->
            <div id="mystore-content-orders" class="card glow-border">
              <div class="flex items-center justify-between mb-6">
                <h4 class="text-xl font-bold">ğŸ“¦ ì‹¤ì‹œê°„ ì£¼ë¬¸ í˜„í™©</h4>
                <span class="px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm animate-pulse">ğŸŸ¢ ì‹¤ì‹œê°„ ì—°ê²°ë¨</span>
              </div>
              
              <!-- ì£¼ë¬¸ ìƒíƒœ íƒ­ -->
              <div class="flex gap-2 mb-6 flex-wrap">
                <button onclick="filterOrders('new')" class="order-filter-btn active px-4 py-2 bg-red-500 rounded-lg font-bold">
                  ğŸ†• ì‹ ê·œ <span id="order-count-new" class="ml-1 px-2 py-0.5 bg-white/20 rounded-full text-sm">3</span>
                </button>
                <button onclick="filterOrders('preparing')" class="order-filter-btn px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">
                  ğŸ‘¨â€ğŸ³ ì¤€ë¹„ì¤‘ <span id="order-count-preparing" class="ml-1 px-2 py-0.5 bg-white/20 rounded-full text-sm">2</span>
                </button>
                <button onclick="filterOrders('ready')" class="order-filter-btn px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">
                  âœ… ì™„ë£Œ <span id="order-count-ready" class="ml-1 px-2 py-0.5 bg-white/20 rounded-full text-sm">5</span>
                </button>
                <button onclick="filterOrders('all')" class="order-filter-btn px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">
                  ğŸ“‹ ì „ì²´
                </button>
              </div>
              
              <!-- ì£¼ë¬¸ ëª©ë¡ -->
              <div id="orders-list" class="space-y-4">
                <!-- ì‹ ê·œ ì£¼ë¬¸ ì˜ˆì‹œ -->
                <div class="order-item bg-red-500/10 border border-red-500/30 p-4 rounded-lg">
                  <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                      <span class="px-2 py-1 bg-red-500 text-white rounded font-bold text-sm animate-pulse">NEW</span>
                      <span class="font-bold">#ORD-001</span>
                      <span class="text-gray-400">| ë°°ë‹¬</span>
                    </div>
                    <span class="text-gray-400 text-sm">ë°©ê¸ˆ ì „</span>
                  </div>
                  <div class="mb-3">
                    <p class="font-bold">ì²­êµ­ì¥ ì°Œê°œ x1, ëœì¥ì°Œê°œ x2</p>
                    <p class="text-cyan-400 font-bold">â‚©32,000 (ì¿ í° 30% ì ìš©)</p>
                  </div>
                  <div class="flex gap-2">
                    <button onclick="acceptOrder('ORD-001')" class="flex-1 py-2 bg-green-500 rounded-lg font-bold hover:bg-green-600 transition">âœ… ì ‘ìˆ˜</button>
                    <button onclick="rejectOrder('ORD-001')" class="px-4 py-2 bg-red-500/50 rounded-lg hover:bg-red-500 transition">âŒ</button>
                  </div>
                </div>
                
                <!-- ì¤€ë¹„ì¤‘ ì£¼ë¬¸ ì˜ˆì‹œ -->
                <div class="order-item bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-lg">
                  <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                      <span class="px-2 py-1 bg-yellow-500 text-black rounded font-bold text-sm">ì¤€ë¹„ì¤‘</span>
                      <span class="font-bold">#ORD-002</span>
                      <span class="text-gray-400">| í¬ì¥</span>
                    </div>
                    <span class="text-gray-400 text-sm">5ë¶„ ì „</span>
                  </div>
                  <div class="mb-3">
                    <p class="font-bold">ë¶ˆê³ ê¸° ì •ì‹ x1</p>
                    <p class="text-cyan-400 font-bold">â‚©15,000</p>
                  </div>
                  <div class="flex gap-2">
                    <button onclick="completeOrder('ORD-002')" class="flex-1 py-2 bg-green-500 rounded-lg font-bold hover:bg-green-600 transition">âœ… ì¤€ë¹„ ì™„ë£Œ</button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- ğŸ’° ë§¤ì¶œ í˜„í™© -->
            <div id="mystore-content-sales" style="display:none;" class="card glow-border">
              <h4 class="text-xl font-bold mb-6">ğŸ’° ë§¤ì¶œ í˜„í™©</h4>
              
              <div class="grid md:grid-cols-4 gap-4 mb-8">
                <div class="bg-gradient-to-br from-green-500/20 to-green-600/10 p-4 rounded-lg border border-green-500/30">
                  <p class="text-gray-400 text-sm">ì˜¤ëŠ˜ ë§¤ì¶œ</p>
                  <p class="text-2xl font-black text-green-400">â‚©285,000</p>
                  <p class="text-xs text-green-400">+23% vs ì–´ì œ</p>
                </div>
                <div class="bg-gradient-to-br from-cyan-500/20 to-cyan-600/10 p-4 rounded-lg border border-cyan-500/30">
                  <p class="text-gray-400 text-sm">ì´ë²ˆ ì£¼ ë§¤ì¶œ</p>
                  <p class="text-2xl font-black text-cyan-400">â‚©1,520,000</p>
                </div>
                <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/10 p-4 rounded-lg border border-purple-500/30">
                  <p class="text-gray-400 text-sm">ì´ë²ˆ ë‹¬ ë§¤ì¶œ</p>
                  <p class="text-2xl font-black text-purple-400">â‚©5,840,000</p>
                </div>
                <div class="bg-gradient-to-br from-pink-500/20 to-pink-600/10 p-4 rounded-lg border border-pink-500/30">
                  <p class="text-gray-400 text-sm">ì¿ í° ì‚¬ìš©</p>
                  <p class="text-2xl font-black text-pink-400">127ê±´</p>
                </div>
              </div>
              
              <div class="flex gap-2">
                <button onclick="downloadReport('daily')" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">ğŸ“Š ì¼ê°„ ë¦¬í¬íŠ¸</button>
                <button onclick="downloadReport('weekly')" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">ğŸ“ˆ ì£¼ê°„ ë¦¬í¬íŠ¸</button>
                <button onclick="downloadReport('monthly')" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">ğŸ“‰ ì›”ê°„ ë¦¬í¬íŠ¸</button>
              </div>
            </div>
            
            <!-- ğŸ« ì¿ í° í˜„í™© -->
            <div id="mystore-content-coupons" style="display:none;" class="card glow-border">
              <h4 class="text-xl font-bold mb-6">ğŸ« ë°œê¸‰í•œ ì¿ í° í˜„í™©</h4>
              <div id="my-coupons-list">
                <!-- ë™ì  ë¡œë“œ -->
              </div>
            </div>
            
            <!-- ğŸ¨ ë§¤ì¥ ê¾¸ë¯¸ê¸° -->
            <div id="mystore-content-decorate" style="display:none;" class="card glow-border">
              <h4 class="text-xl font-bold mb-6">ğŸ¨ ë§¤ì¥ ê¾¸ë¯¸ê¸°</h4>
              
              <div class="grid md:grid-cols-2 gap-6">
                <!-- ëŒ€í‘œ ì´ë¯¸ì§€ -->
                <div>
                  <label class="block mb-2 font-bold">ğŸ“· ëŒ€í‘œ ì´ë¯¸ì§€</label>
                  <div class="border border-dashed border-purple-500 rounded-lg p-8 text-center bg-gray-800/50">
                    <input type="file" id="store-main-image" accept="image/*" class="hidden" onchange="previewStoreImage(this)">
                    <div id="store-image-preview" class="text-6xl mb-2">ğŸ–¼ï¸</div>
                    <button onclick="document.getElementById('store-main-image').click()" class="btn-primary">ì´ë¯¸ì§€ ì—…ë¡œë“œ</button>
                  </div>
                </div>
                
                <!-- ë¡œê³  -->
                <div>
                  <label class="block mb-2 font-bold">ğŸ·ï¸ ë§¤ì¥ ë¡œê³ </label>
                  <div class="border border-dashed border-cyan-500 rounded-lg p-8 text-center bg-gray-800/50">
                    <input type="file" id="store-logo" accept="image/*" class="hidden">
                    <div class="text-6xl mb-2">ğŸ¨</div>
                    <button onclick="document.getElementById('store-logo').click()" class="btn-primary">ë¡œê³  ì—…ë¡œë“œ</button>
                  </div>
                </div>
              </div>
              
              <div class="mt-6">
                <label class="block mb-2 font-bold">ğŸ“ ë§¤ì¥ ì†Œê°œê¸€</label>
                <textarea id="store-intro-edit" class="w-full p-3 rounded bg-gray-900 border border-purple-500 min-h-[120px]" placeholder="ë§¤ì¥ ì†Œê°œë¥¼ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
              </div>
              
              <div class="grid md:grid-cols-2 gap-4 mt-6">
                <div>
                  <label class="block mb-2 font-bold">ğŸ“ ì—°ë½ì²˜</label>
                  <input type="text" id="store-contact-edit" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="02-1234-5678">
                </div>
                <div>
                  <label class="block mb-2 font-bold">â° ì˜ì—…ì‹œê°„</label>
                  <input type="text" id="store-hours-edit" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="10:00 - 22:00">
                </div>
              </div>
              
              <div class="mt-6">
                <label class="block mb-2 font-bold">ğŸ“ ì£¼ì†Œ</label>
                <input type="text" id="store-address-edit" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬...">
              </div>
              
              <!-- ë©”ë‰´ ê´€ë¦¬ -->
              <div class="mt-6">
                <label class="block mb-2 font-bold">ğŸ½ï¸ ë©”ë‰´ ê´€ë¦¬</label>
                <div class="flex gap-2">
                  <button onclick="downloadMenuTemplate()" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">ğŸ“¥ ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´</button>
                  <button onclick="document.getElementById('menu-upload').click()" class="px-4 py-2 bg-cyan-500 rounded hover:bg-cyan-600">ğŸ“¤ ë©”ë‰´ ì—…ë¡œë“œ</button>
                  <input type="file" id="menu-upload" accept=".xlsx,.xls,.csv" class="hidden">
                </div>
              </div>
              
              <!-- í™ë³´ ì˜ìƒ -->
              <div class="mt-6">
                <label class="block mb-2 font-bold">ğŸ¬ í™ë³´ ì˜ìƒ</label>
                <div class="border border-dashed border-pink-500 rounded-lg p-8 text-center bg-gray-800/50">
                  <input type="file" id="store-promo-video" accept="video/*" class="hidden" onchange="previewPromoVideo(this)">
                  <div id="promo-video-preview" class="text-6xl mb-2">ğŸ¥</div>
                  <button onclick="document.getElementById('store-promo-video').click()" class="btn-primary">ì˜ìƒ ì—…ë¡œë“œ</button>
                </div>
              </div>
              
              <button onclick="saveStoreDecoration()" class="btn-primary w-full mt-8 text-lg py-4">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
            </div>
          </div>
        </div>

        <!-- ì¿ í° ë°œê¸‰ íƒ­ -->
        <!-- ì¿ í° ë°œê¸‰ íƒ­ -->
        <div id="business-coupon-issue-tab" style="display:none;">
          <div class="card glow-border mb-8">
            <h3 class="text-2xl font-bold mb-6">ğŸ« ë§¤ì¥ ì¿ í° ë°œê¸‰</h3>
            <p class="text-gray-400 mb-4">ë°œê¸‰ëœ ì¿ í°ì€ ìµœì¢… ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê²Œì„ì— ìë™ ë°°í¬ë©ë‹ˆë‹¤.</p>
            
            <!-- ğŸ’° ì¿ í° ë¹„ìš© ì•ˆë‚´ -->
            <div class="bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 p-4 rounded-lg mb-6">
              <p class="text-lg font-bold text-cyan-400 mb-2">ğŸ’° ì¿ í° ë°œê¸‰ ë¹„ìš©: <span class="text-yellow-400">ì¥ë‹¹ 50ì›</span></p>
              <p class="text-sm text-gray-400">ì˜ˆ) 100ì¥ ë°œê¸‰ ì‹œ â†’ 5,000ì› / 1,000ì¥ ë°œê¸‰ ì‹œ â†’ 50,000ì›</p>
            </div>
            
            <form onsubmit="issueStoreCoupon(event)">
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2">ì¿ í°ëª… *</label>
                  <input type="text" id="store-coupon-name" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ì˜ˆ: ì‹ ë©”ë‰´ 30% í• ì¸" required>
                </div>
                <div>
                  <label class="block mb-2">í• ì¸ìœ¨/ê¸ˆì•¡ *</label>
                  <div class="flex gap-2">
                    <input type="number" id="store-coupon-discount" class="flex-1 p-3 rounded bg-gray-900 border border-purple-500" placeholder="30" required>
                    <select id="store-coupon-type" class="p-3 rounded bg-gray-900 border border-purple-500">
                      <option value="percentage">%</option>
                      <option value="fixed">ì›</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2">ë°œê¸‰ ìˆ˜ëŸ‰ *</label>
                  <input type="number" id="store-coupon-qty" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="100" required oninput="calculateCouponCost()">
                </div>
                <div>
                  <label class="block mb-2">ìœ íš¨ê¸°ê°„ *</label>
                  <input type="date" id="store-coupon-expiry" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required>
                </div>
              </div>
              
              <!-- ğŸ’³ ìë™ ê³„ì‚° ê²°ì œ ì„¹ì…˜ -->
              <div class="bg-gray-800/50 border border-cyan-500/30 p-4 rounded-lg mb-4">
                <div class="flex justify-between items-center mb-2">
                  <span class="text-gray-400">ë°œê¸‰ ìˆ˜ëŸ‰:</span>
                  <span id="calc-qty" class="text-white font-bold">0 ì¥</span>
                </div>
                <div class="flex justify-between items-center mb-2">
                  <span class="text-gray-400">ë‹¨ê°€:</span>
                  <span class="text-white">50ì› / ì¥</span>
                </div>
                <div class="border-t border-gray-700 my-2"></div>
                <div class="flex justify-between items-center">
                  <span class="text-lg font-bold text-cyan-400">ğŸ’° ì´ ê²°ì œê¸ˆì•¡:</span>
                  <span id="calc-total" class="text-2xl font-black text-yellow-400">â‚©0</span>
                </div>
              </div>
              
              <div class="mb-4">
                <label class="block mb-2">ì¿ í° ì´ë¯¸ì§€ (ì„ íƒ)</label>
                <input type="file" id="store-coupon-image" class="w-full p-3 rounded bg-gray-900 border border-purple-500" accept="image/*">
              </div>
              
              <div class="mb-6">
                <label class="block mb-2">ì‚¬ìš© ì¡°ê±´</label>
                <textarea id="store-coupon-condition" class="w-full p-3 rounded bg-gray-900 border border-purple-500" rows="2" placeholder="ì˜ˆ: ì „ ë©”ë‰´ ëŒ€ìƒ, 2ë§Œì› ì´ìƒ ì£¼ë¬¸ ì‹œ"></textarea>
              </div>
              
              <button type="submit" class="btn-primary w-full text-lg py-4" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">ğŸ’³ ê²°ì œ ë° ì¿ í° ë°œê¸‰ ì‹ ì²­</button>
            </form>
          </div>
          </div>
          
          <!-- ë°œê¸‰í•œ ì¿ í° ëª©ë¡ -->
          <div class="card glow-border">
            <h3 class="text-xl font-bold mb-4">ğŸ“‹ ë°œê¸‰í•œ ì¿ í° ëª©ë¡</h3>
            <div id="my-issued-coupons">
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div class="flex-1">
                    <span class="rarity-badge epic">EPIC</span>
                    <h4 class="font-bold mt-2">ì•„ë¯¸ í•œì •ì‹ 30% í• ì¸</h4>
                    <p class="text-sm text-gray-400">ìˆ˜ëŸ‰: 100ê°œ | ì‚¬ìš©: 45ê°œ | ìœ íš¨: 2026.05.31</p>
                  </div>
                  <div class="flex gap-2 items-center">
                    <span class="px-3 py-1 bg-green-500/20 text-green-400 rounded">âœ… ìŠ¹ì¸ë¨</span>
                    <button onclick="deleteCoupon('coupon-001')" class="px-3 py-1 bg-red-500/20 text-red-400 rounded hover:bg-red-500/40">ğŸ—‘ï¸ ì‚­ì œ</button>
                  </div>
                </div>
              </div>
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div class="flex-1">
                    <span class="rarity-badge rare">RARE</span>
                    <h4 class="font-bold mt-2">ì•„ë¯¸ ë‹¤ë°© ì»¤í”¼ 50% í• ì¸</h4>
                    <p class="text-sm text-gray-400">ìˆ˜ëŸ‰: 50ê°œ | ì‚¬ìš©: 12ê°œ | ìœ íš¨: 2026.03.15</p>
                  </div>
                  <div class="flex gap-2 items-center">
                    <span class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded">â³ ê²€í† ì¤‘</span>
                    <button onclick="deleteCoupon('coupon-002')" class="px-3 py-1 bg-red-500/20 text-red-400 rounded hover:bg-red-500/40">ğŸ—‘ï¸ ì‚­ì œ</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- í™ë³´ í˜ì´ì§€ íƒ­ -->
        <div id="business-promo-tab" style="display:none;">
          <!-- ğŸ¬ í™ë³´ ì˜ìƒ ë“±ë¡ ì„¹ì…˜ (ê°€ì¥ ìœ„ì—) -->
          <div class="card glow-border mb-8" style="border-color: #ef4444;">
            <h3 class="text-2xl font-bold mb-4 text-red-400">ğŸ¬ í™ë³´ ì˜ìƒ ë“±ë¡</h3>
            <p class="text-gray-400 mb-4">YouTube ì˜ìƒ URLì„ ë“±ë¡í•˜ë©´ ë§¤ì¥ ëª©ë¡ì— ë°”ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p>

            <div class="grid md:grid-cols-2 gap-6">
              <!-- ì˜ìƒ URL ì…ë ¥ -->
              <div>
                <label class="block mb-2 text-sm text-gray-300">YouTube ì˜ìƒ URL</label>
                <div class="flex gap-2">
                  <input type="url" id="promo-video-url" class="flex-1 p-3 rounded bg-gray-900 border border-red-500" placeholder="https://youtube.com/watch?v=... ë˜ëŠ” https://youtu.be/...">
                  <button onclick="registerPromoVideo()" class="px-6 py-3 bg-red-500 text-white font-bold rounded hover:bg-red-600 transition">ë“±ë¡</button>
                </div>
                <p class="text-xs text-gray-500 mt-2">ì§€ì›: youtube.com, youtu.be, youtube shorts</p>

                <!-- ë“±ë¡ëœ ì˜ìƒ ëª©ë¡ -->
                <div id="registered-videos-list" class="mt-4 space-y-2">
                  <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                </div>
              </div>

              <!-- ë¯¸ë¦¬ë³´ê¸° -->
              <div>
                <label class="block mb-2 text-sm text-gray-300">ë¯¸ë¦¬ë³´ê¸°</label>
                <div id="promo-video-preview" class="aspect-video bg-gray-900 rounded-lg flex items-center justify-center border border-gray-700">
                  <div class="text-center text-gray-500">
                    <span class="text-4xl block mb-2">â–¶ï¸</span>
                    <span>URL ì…ë ¥ í›„ ë¯¸ë¦¬ë³´ê¸°</span>
                  </div>
                </div>
                <button onclick="previewPromoVideo()" class="mt-2 w-full py-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition">ë¯¸ë¦¬ë³´ê¸°</button>
              </div>
            </div>
          </div>

          <div class="card glow-border mb-8">
            <h3 class="text-2xl font-bold mb-4">ğŸ“º ë§¤ì¥ í™ë³´ í˜ì´ì§€</h3>
            <p class="text-gray-400 mb-6">ìµœëŒ€ 20í˜ì´ì§€ê¹Œì§€ í™ë³´ ìë£Œë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í˜„ì¬: 3/20)</p>

            <button onclick="addPromoPage()" class="btn-primary mb-6" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">â• ìƒˆ í˜ì´ì§€ ì¶”ê°€</button>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="promo-pages-list">
              <!-- í˜ì´ì§€ 1 -->
              <div class="bg-gray-800/50 p-4 rounded-lg border border-purple-500/30">
                <div class="aspect-video bg-gray-900 rounded mb-3 flex items-center justify-center">
                  <span class="text-4xl">ğŸ¬</span>
                </div>
                <h4 class="font-bold mb-1">ë§¤ì¥ ì†Œê°œ ì˜ìƒ</h4>
                <p class="text-sm text-gray-400 mb-3">ì•„ë¯¸ í•œì •ì‹ì˜ ëª¨ë“  ê²ƒ</p>
                <div class="flex gap-2">
                  <button onclick="editPromoPage(1)" class="flex-1 px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm">ìˆ˜ì •</button>
                  <button onclick="deletePromoPage(1)" class="flex-1 px-3 py-1 bg-red-500/20 text-red-400 rounded text-sm">ì‚­ì œ</button>
                </div>
              </div>
              
              <!-- í˜ì´ì§€ 2 -->
              <div class="bg-gray-800/50 p-4 rounded-lg border border-purple-500/30">
                <div class="aspect-video bg-gray-900 rounded mb-3 flex items-center justify-center">
                  <span class="text-4xl">ğŸ“·</span>
                </div>
                <h4 class="font-bold mb-1">ëŒ€í‘œ ë©”ë‰´ ì‚¬ì§„</h4>
                <p class="text-sm text-gray-400 mb-3">íŠ¹ì„  í•œì •ì‹ ì½”ìŠ¤</p>
                <div class="flex gap-2">
                  <button onclick="editPromoPage(2)" class="flex-1 px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm">ìˆ˜ì •</button>
                  <button onclick="deletePromoPage(2)" class="flex-1 px-3 py-1 bg-red-500/20 text-red-400 rounded text-sm">ì‚­ì œ</button>
                </div>
              </div>
              
              <!-- í˜ì´ì§€ 3 -->
              <div class="bg-gray-800/50 p-4 rounded-lg border border-purple-500/30">
                <div class="aspect-video bg-gray-900 rounded mb-3 flex items-center justify-center">
                  <span class="text-4xl">ğŸ“„</span>
                </div>
                <h4 class="font-bold mb-1">ì´ë²¤íŠ¸ ì•ˆë‚´</h4>
                <p class="text-sm text-gray-400 mb-3">12ì›” í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¹ê°€</p>
                <div class="flex gap-2">
                  <button onclick="editPromoPage(3)" class="flex-1 px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm">ìˆ˜ì •</button>
                  <button onclick="deletePromoPage(3)" class="flex-1 px-3 py-1 bg-red-500/20 text-red-400 rounded text-sm">ì‚­ì œ</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- íŒŒì¼ ì—…ë¡œë“œ ì„¹ì…˜ -->
          <div class="card glow-border">
            <h3 class="text-xl font-bold mb-4">ğŸ“ í™ë³´ ìë£Œ ì—…ë¡œë“œ</h3>
            <div class="grid md:grid-cols-2 gap-4">
              <div class="bg-gray-800/50 p-4 rounded-lg border border-dashed border-purple-500">
                <label class="cursor-pointer block text-center">
                  <span class="text-4xl block mb-2">ğŸ–¼ï¸</span>
                  <span class="text-purple-400">ì´ë¯¸ì§€ ì—…ë¡œë“œ</span>
                  <input type="file" class="hidden" accept="image/*" onchange="uploadPromoFile(this, 'image')">
                  <p class="text-xs text-gray-400 mt-1">JPG, PNG, GIF (ìµœëŒ€ 10MB)</p>
                </label>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-dashed border-cyan-500">
                <label class="cursor-pointer block text-center">
                  <span class="text-4xl block mb-2">ğŸ¬</span>
                  <span class="text-cyan-400">ë™ì˜ìƒ ì—…ë¡œë“œ</span>
                  <input type="file" class="hidden" accept="video/*" onchange="uploadPromoFile(this, 'video')">
                  <p class="text-xs text-gray-400 mt-1">MP4, MOV (ìµœëŒ€ 100MB)</p>
                </label>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-dashed border-green-500">
                <label class="cursor-pointer block text-center">
                  <span class="text-4xl block mb-2">ğŸ“„</span>
                  <span class="text-green-400">ë¬¸ì„œ ì—…ë¡œë“œ</span>
                  <input type="file" class="hidden" accept=".pdf,.doc,.docx" onchange="uploadPromoFile(this, 'document')">
                  <p class="text-xs text-gray-400 mt-1">PDF, DOC (ìµœëŒ€ 20MB)</p>
                </label>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-dashed border-yellow-500">
                <label class="cursor-pointer block text-center">
                  <span class="text-4xl block mb-2">ğŸµ</span>
                  <span class="text-yellow-400">ì˜¤ë””ì˜¤ ì—…ë¡œë“œ</span>
                  <input type="file" class="hidden" accept="audio/*" onchange="uploadPromoFile(this, 'audio')">
                  <p class="text-xs text-gray-400 mt-1">MP3, WAV (ìµœëŒ€ 30MB)</p>
                </label>
              </div>
            </div>
            
            <!-- â­ ìŠ¹ì¸ ë°”ëë‹ˆë‹¤ ë²„íŠ¼ -->
            <div class="mt-8 p-6 bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-lg">
              <h4 class="text-xl font-bold text-green-400 mb-4">âœ… ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì…¨ë‚˜ìš”?</h4>
              <p class="text-gray-400 mb-4">í˜ì´ì§€ êµ¬ì„±, ì¿ í° ì´ë¯¸ì§€, í™ë³´ ì˜ìƒ/ì‚¬ì§„ì´ ëª¨ë‘ ì™„ë£Œë˜ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
              <ul class="text-sm text-gray-400 mb-6 space-y-1">
                <li>âœ“ ë§¤ì¥ ì •ë³´ ì…ë ¥ ì™„ë£Œ</li>
                <li>âœ“ ì¿ í° ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ</li>
                <li>âœ“ í™ë³´ í˜ì´ì§€ êµ¬ì„± ì™„ë£Œ</li>
                <li>âœ“ ì˜ìƒ/ì‚¬ì§„ ìë£Œ ì—…ë¡œë“œ ì™„ë£Œ</li>
              </ul>
              <button onclick="requestFinalApproval()" class="btn-primary w-full text-lg py-4" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                âœ… ìŠ¹ì¸ ë°”ëë‹ˆë‹¤ (ìµœì¢… ê´€ë¦¬ìì—ê²Œ ê²€í†  ìš”ì²­)
              </button>
            </div>
          </div>
        </div>

        <!-- ë‚´ ë§¤ì¥ (ì•„ë¯¸ í•œì •ì‹) - í™•ì¥ëœ ëŒ€ì‹œë³´ë“œ -->
        <div id="business-mystore-tab" style="display:none;">
          <div class="card glow-border mb-8">
            <div class="flex items-center gap-6 mb-6 flex-wrap">
              <div class="text-6xl">ğŸ±</div>
              <div class="flex-1">
                <h3 class="text-3xl font-black gradient-text mb-2">ì•„ë¯¸ í•œì •ì‹</h3>
                <p class="text-gray-400 mb-2">ğŸ“ ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</p>
                <p class="text-gray-400">ğŸ“ 02-1234-5678</p>
                <a href="https://www.airctt.com" target="_blank" class="text-purple-400 hover:underline">ğŸ”— í™ˆí˜ì´ì§€ ë°”ë¡œê°€ê¸°</a>
              </div>
              <div class="flex gap-2 flex-wrap">
                <button onclick="showPage('store')" class="btn-primary">ğŸ½ï¸ ë§¤ì¥ ë³´ê¸°</button>
                <button onclick="openGoldenRabbitCFO()" class="btn-primary" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);">ğŸ° AI ì§€ë°°ì¸</button>
              </div>
            </div>
          </div>

          <!-- ğŸ“Š ë©”ì¸ ëŒ€ì‹œë³´ë“œ íƒ­ -->
          <div class="mb-6 flex gap-2 flex-wrap">
            <button onclick="showStoreDashboard('overview')" class="px-4 py-2 bg-cyan-500 rounded font-bold" id="dash-tab-overview">ğŸ“Š ê°œìš”</button>
            <button onclick="showStoreDashboard('reservation')" class="px-4 py-2 bg-gray-700 rounded font-bold" id="dash-tab-reservation">ğŸ“… ì˜ˆì•½</button>
            <button onclick="showStoreDashboard('sales')" class="px-4 py-2 bg-gray-700 rounded font-bold" id="dash-tab-sales">ğŸ’° íŒë§¤</button>
            <button onclick="showStoreDashboard('purchase')" class="px-4 py-2 bg-gray-700 rounded font-bold" id="dash-tab-purchase">ğŸ“¦ ë§¤ì…</button>
            <button onclick="showStoreDashboard('revenue')" class="px-4 py-2 bg-gray-700 rounded font-bold" id="dash-tab-revenue">ğŸ“ˆ ë§¤ì¶œ</button>
          </div>

          <!-- ê°œìš” ëŒ€ì‹œë³´ë“œ -->
          <div id="dash-content-overview">
            <div class="grid md:grid-cols-4 gap-4 mb-8">
              <div class="card glow-border text-center">
                <div class="text-4xl mb-2">ğŸ“Š</div>
                <h3 class="text-sm text-gray-400 mb-1">ì´ ë°œê¸‰ ì¿ í°</h3>
                <p class="text-2xl font-black gradient-text">127</p>
                <button onclick="downloadReport('coupons')" class="text-xs text-purple-400 mt-2 hover:underline">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="card glow-border text-center">
                <div class="text-4xl mb-2">âœ…</div>
                <h3 class="text-sm text-gray-400 mb-1">ì‚¬ìš©ëœ ì¿ í°</h3>
                <p class="text-2xl font-black gradient-text">89</p>
                <button onclick="downloadReport('used')" class="text-xs text-purple-400 mt-2 hover:underline">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="card glow-border text-center">
                <div class="text-4xl mb-2">ğŸ’µ</div>
                <h3 class="text-sm text-gray-400 mb-1">ì˜¤ëŠ˜ ë§¤ì¶œ</h3>
                <p class="text-2xl font-black text-green-400">â‚©340,000</p>
                <button onclick="downloadReport('today')" class="text-xs text-purple-400 mt-2 hover:underline">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="card glow-border text-center">
                <div class="text-4xl mb-2">ğŸ“ˆ</div>
                <h3 class="text-sm text-gray-400 mb-1">ì´ ë§¤ì¶œ</h3>
                <p class="text-2xl font-black gradient-text">â‚©2,340,000</p>
                <button onclick="downloadReport('total')" class="text-xs text-purple-400 mt-2 hover:underline">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
              </div>
            </div>
          </div>

          <!-- ì˜ˆì•½ ëŒ€ì‹œë³´ë“œ -->
          <div id="dash-content-reservation" style="display:none;">
            <div class="card glow-border mb-6">
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">ğŸ“… ì˜ˆì•½ í˜„í™©</h3>
                <button onclick="downloadReport('reservation')" class="btn-primary text-sm">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="overflow-x-auto">
                <table class="w-full">
                  <thead class="bg-gray-800">
                    <tr><th class="p-3 text-left">ì˜ˆì•½ì¼</th><th class="p-3">ì‹œê°„</th><th class="p-3">ì¸ì›</th><th class="p-3">ê³ ê°ëª…</th><th class="p-3">ì—°ë½ì²˜</th><th class="p-3">ìƒíƒœ</th></tr>
                  </thead>
                  <tbody>
                    <tr class="border-b border-gray-700"><td class="p-3">2025-12-25</td><td class="p-3 text-center">18:00</td><td class="p-3 text-center">4ëª…</td><td class="p-3 text-center">ê¹€ë¯¼ìˆ˜</td><td class="p-3 text-center">010-****-1234</td><td class="p-3 text-center"><span class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-sm">í™•ì •</span></td></tr>
                    <tr class="border-b border-gray-700"><td class="p-3">2025-12-25</td><td class="p-3 text-center">19:30</td><td class="p-3 text-center">6ëª…</td><td class="p-3 text-center">ì´ì˜í¬</td><td class="p-3 text-center">010-****-5678</td><td class="p-3 text-center"><span class="bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-sm">ëŒ€ê¸°</span></td></tr>
                    <tr class="border-b border-gray-700"><td class="p-3">2025-12-26</td><td class="p-3 text-center">12:00</td><td class="p-3 text-center">2ëª…</td><td class="p-3 text-center">ë°•ì² ìˆ˜</td><td class="p-3 text-center">010-****-9012</td><td class="p-3 text-center"><span class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-sm">í™•ì •</span></td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- íŒë§¤ ëŒ€ì‹œë³´ë“œ -->
          <div id="dash-content-sales" style="display:none;">
            <div class="card glow-border mb-6">
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">ğŸ’° íŒë§¤ ë‚´ì—­</h3>
                <button onclick="downloadReport('sales')" class="btn-primary text-sm">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="grid md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì˜¤ëŠ˜ íŒë§¤</p>
                  <p class="text-2xl font-bold text-green-400">â‚©340,000</p>
                  <p class="text-xs text-gray-500">ê±´ìˆ˜: 12ê±´</p>
                </div>
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì´ë²ˆì£¼ íŒë§¤</p>
                  <p class="text-2xl font-bold text-cyan-400">â‚©1,280,000</p>
                  <p class="text-xs text-gray-500">ê±´ìˆ˜: 45ê±´</p>
                </div>
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì´ë²ˆë‹¬ íŒë§¤</p>
                  <p class="text-2xl font-bold text-purple-400">â‚©4,560,000</p>
                  <p class="text-xs text-gray-500">ê±´ìˆ˜: 187ê±´</p>
                </div>
              </div>
            </div>
          </div>

          <!-- ë§¤ì… ëŒ€ì‹œë³´ë“œ -->
          <div id="dash-content-purchase" style="display:none;">
            <div class="card glow-border mb-6">
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">ğŸ“¦ ë§¤ì… ë‚´ì—­</h3>
                <button onclick="downloadReport('purchase')" class="btn-primary text-sm">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="grid md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì˜¤ëŠ˜ ë§¤ì…</p>
                  <p class="text-2xl font-bold text-red-400">â‚©120,000</p>
                </div>
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì´ë²ˆì£¼ ë§¤ì…</p>
                  <p class="text-2xl font-bold text-orange-400">â‚©450,000</p>
                </div>
                <div class="bg-gray-800/50 p-4 rounded-lg">
                  <p class="text-gray-400 text-sm">ì´ë²ˆë‹¬ ë§¤ì…</p>
                  <p class="text-2xl font-bold text-yellow-400">â‚©1,800,000</p>
                </div>
              </div>
            </div>
          </div>

          <!-- ë§¤ì¶œ ëŒ€ì‹œë³´ë“œ -->
          <div id="dash-content-revenue" style="display:none;">
            <div class="card glow-border mb-6">
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">ğŸ“ˆ ë§¤ì¶œ ë¶„ì„</h3>
                <button onclick="downloadReport('revenue')" class="btn-primary text-sm">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div class="grid md:grid-cols-2 gap-4 mb-6">
                <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 p-6 rounded-lg border border-green-500/30">
                  <p class="text-gray-400 text-sm mb-2">ìˆœì´ìµ (ë§¤ì¶œ - ë§¤ì…)</p>
                  <p class="text-3xl font-black text-green-400">â‚©2,760,000</p>
                  <p class="text-sm text-green-300 mt-2">â†‘ 15% ì „ì›” ëŒ€ë¹„</p>
                </div>
                <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-6 rounded-lg border border-purple-500/30">
                  <p class="text-gray-400 text-sm mb-2">ì¿ í° ê¸°ì—¬ ë§¤ì¶œ</p>
                  <p class="text-3xl font-black text-purple-400">â‚©1,890,000</p>
                  <p class="text-sm text-purple-300 mt-2">ì „ì²´ ë§¤ì¶œì˜ 41%</p>
                </div>
              </div>
            </div>
          </div>

          <!-- ğŸ“ íŒŒì¼ ê´€ë¦¬ì -->
          <div class="card glow-border mb-8">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">ğŸ“ íŒŒì¼ ê´€ë¦¬ì</h3>
              <div class="flex gap-2">
                <button onclick="uploadFile()" class="px-3 py-2 bg-purple-600 rounded text-sm hover:bg-purple-700">ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</button>
                <button onclick="createDocument()" class="px-3 py-2 bg-cyan-600 rounded text-sm hover:bg-cyan-700">ğŸ“ ìƒˆ ë¬¸ì„œ</button>
              </div>
            </div>
            
            <!-- íŒŒì¼ ëª©ë¡ -->
            <div class="grid md:grid-cols-3 gap-4 mb-6" id="file-list">
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700 hover:border-purple-500 transition cursor-pointer" onclick="openFileEditor('ë§¤ì¥ì†Œê°œ.txt')">
                <div class="flex items-center gap-3 mb-2">
                  <span class="text-2xl">ğŸ“„</span>
                  <div class="flex-1">
                    <p class="font-bold">ë§¤ì¥ì†Œê°œ.txt</p>
                    <p class="text-xs text-gray-400">2.3 KB Â· 12/19 ìˆ˜ì •</p>
                  </div>
                  <button onclick="event.stopPropagation(); downloadFile('ë§¤ì¥ì†Œê°œ.txt')" class="text-cyan-400 hover:text-cyan-300">ğŸ“¥</button>
                </div>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700 hover:border-purple-500 transition cursor-pointer" onclick="openFileEditor('ë©”ë‰´íŒ.xlsx')">
                <div class="flex items-center gap-3 mb-2">
                  <span class="text-2xl">ğŸ“Š</span>
                  <div class="flex-1">
                    <p class="font-bold">ë©”ë‰´íŒ.xlsx</p>
                    <p class="text-xs text-gray-400">15.8 KB Â· 12/18 ìˆ˜ì •</p>
                  </div>
                  <button onclick="event.stopPropagation(); downloadFile('ë©”ë‰´íŒ.xlsx')" class="text-cyan-400 hover:text-cyan-300">ğŸ“¥</button>
                </div>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700 hover:border-purple-500 transition cursor-pointer" onclick="openFileEditor('ë§¤ì¶œë³´ê³ ì„œ.pdf')">
                <div class="flex items-center gap-3 mb-2">
                  <span class="text-2xl">ğŸ“•</span>
                  <div class="flex-1">
                    <p class="font-bold">ë§¤ì¶œë³´ê³ ì„œ.pdf</p>
                    <p class="text-xs text-gray-400">1.2 MB Â· 12/15 ìˆ˜ì •</p>
                  </div>
                  <button onclick="event.stopPropagation(); downloadFile('ë§¤ì¶œë³´ê³ ì„œ.pdf')" class="text-cyan-400 hover:text-cyan-300">ğŸ“¥</button>
                </div>
              </div>
            </div>

            <!-- ì˜ìƒ ë“±ë¡ -->
            <div class="mt-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg">
              <h4 class="font-bold text-red-400 mb-3">ğŸ¬ í™ë³´ ì˜ìƒ ë“±ë¡</h4>
              <div class="flex gap-2 mb-3">
                <input type="url" id="file-video-url" class="flex-1 p-3 rounded bg-gray-900 border border-red-500" placeholder="YouTube URL ì…ë ¥ (https://youtube.com/watch?v=...)">
                <button onclick="registerFileVideo()" class="px-4 py-2 bg-red-500 rounded font-bold hover:bg-red-600">ë“±ë¡</button>
              </div>
              <div id="file-video-preview"></div>
              <div id="file-video-list" class="mt-3 space-y-2"></div>
            </div>

            <!-- íŒŒì¼ ì—…ë¡œë“œ -->
            <div class="mt-4 p-4 bg-cyan-500/10 border border-cyan-500/30 rounded-lg">
              <h4 class="font-bold text-cyan-400 mb-3">ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</h4>
              <input type="file" id="file-upload-input" class="hidden" onchange="handleFileUpload(this)" multiple>
              <button onclick="document.getElementById('file-upload-input').click()" class="w-full py-3 bg-cyan-500 rounded font-bold hover:bg-cyan-600">
                ğŸ“ íŒŒì¼ ì„ íƒ (ì˜ìƒ, ì´ë¯¸ì§€, ë¬¸ì„œ)
              </button>
              <p class="text-xs text-gray-400 mt-2">ì§€ì› í˜•ì‹: MP4, MOV, JPG, PNG, PDF, XLSX, DOCX</p>
              <div id="upload-file-list" class="mt-3 space-y-2"></div>
            </div>

            <!-- íŒŒì¼ í¸ì§‘ê¸° -->
            <div id="file-editor" class="bg-gray-900 rounded-lg border border-purple-500/30 p-4" style="display:none;">
              <div class="flex justify-between items-center mb-4">
                <h4 class="font-bold text-cyan-400" id="editor-filename">ğŸ“ íŒŒì¼ í¸ì§‘</h4>
                <div class="flex gap-2">
                  <button onclick="saveFileContent()" class="px-3 py-1 bg-green-600 rounded text-sm hover:bg-green-700">ğŸ’¾ ì €ì¥</button>
                  <button onclick="closeFileEditor()" class="px-3 py-1 bg-gray-700 rounded text-sm hover:bg-gray-600">âœ• ë‹«ê¸°</button>
                </div>
              </div>
              <textarea id="file-content" class="w-full h-48 p-4 bg-gray-800 rounded border border-gray-700 font-mono text-sm resize-none" placeholder="íŒŒì¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
              <p class="text-xs text-gray-500 mt-2">ğŸ’¡ íŒ: Ctrl+Së¡œ ì €ì¥, ìë™ ì €ì¥ ì§€ì›</p>
            </div>
          </div>

          <!-- ğŸ° Golden Rabbit CFO AI ì§€ë°°ì¸ -->
          <div id="golden-rabbit-cfo" class="card mb-8" style="display:none; background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(245, 158, 11, 0.1) 100%); border: 2px solid #f59e0b;">
            <div class="flex items-center gap-4 mb-4">
              <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-2xl">ğŸ°</div>
              <div>
                <h3 class="text-xl font-bold text-yellow-400">Golden Rabbit CFO <span class="bg-yellow-500 text-black px-2 py-0.5 rounded text-xs font-bold ml-2">PRO</span></h3>
                <p class="text-sm text-gray-400">â— Gemini 1.5 Pro Connected</p>
              </div>
              <button onclick="closeGoldenRabbitCFO()" class="ml-auto text-gray-400 hover:text-white">âœ•</button>
            </div>
            
            <div class="bg-gray-900/50 rounded-lg p-4 mb-4 max-h-[300px] overflow-y-auto" id="cfo-chat-messages">
              <div class="flex gap-3 mb-4">
                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-sm">ğŸ°</div>
                <div class="flex-1 bg-gray-800 p-3 rounded-lg">
                  <p class="text-sm">ì•ˆë…•í•˜ì„¸ìš”, ì‚¬ì¥ë‹˜!</p>
                  <p class="text-sm mt-2">AIRCTT ê³µì‹ ê²½ì˜ë¹„ì„œ "ê³¨ë“  ë˜ë¹—"ì…ë‹ˆë‹¤. ğŸ° âœ¨</p>
                  <p class="text-sm mt-2">ì‚¬ì¥ë‹˜ì˜ ë§¤ì¥ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤.<br>ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?</p>
                </div>
              </div>
            </div>
            
            <div class="flex gap-2 mb-4 flex-wrap">
              <button onclick="askCFO('sales')" class="px-3 py-2 bg-gray-800 rounded text-sm hover:bg-gray-700">ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„í•´ì¤˜</button>
              <button onclick="askCFO('tax')" class="px-3 py-2 bg-gray-800 rounded text-sm hover:bg-gray-700">ğŸ“‹ ì„¸ë¬´ ì‹ ê³  ë„ì™€ì¤˜</button>
              <button onclick="askCFO('marketing')" class="px-3 py-2 bg-gray-800 rounded text-sm hover:bg-gray-700">ğŸ“¢ ë§ˆì¼€íŒ… ì¡°ì–¸í•´ì¤˜</button>
            </div>
            
            <div class="flex gap-2">
              <input type="text" id="cfo-input" class="flex-1 p-3 rounded bg-gray-900 border border-yellow-500" placeholder="ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”... (ì˜ˆ: ì§€ë‚œë‹¬ë³´ë‹¤ ë§¤ì¶œ ì–´ë•Œ?)">
              <button onclick="sendToCFO()" class="btn-primary" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);">âœ¨</button>
            </div>
          </div>

          <button onclick="showCouponIssueForm()" class="btn-primary mb-8">ğŸ« ìƒˆ ì¿ í° ë°œê¸‰</button>

          <!-- ì¿ í° ë°œê¸‰ í¼ -->
          <div id="coupon-issue-form" class="card glow-border mb-8" style="display:none;">
            <h3 class="text-2xl font-bold mb-6">ğŸ« ì¿ í° ë°œê¸‰í•˜ê¸°</h3>
            <form onsubmit="issueCoupon(event)">
              <div class="mb-4">
                <label class="block mb-2">ì¿ í° ì œëª© *</label>
                <input type="text" id="coupon-title" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="ì˜ˆ: íŠ¹ì„  í•œì •ì‹ 20% í• ì¸" required>
              </div>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2">í• ì¸ ë°©ì‹ *</label>
                  <select id="coupon-discount-type" class="w-full p-3 rounded bg-gray-900 border border-purple-500" onchange="toggleDiscountInput()" required>
                    <option value="percentage">í¼ì„¼íŠ¸ í• ì¸ (%)</option>
                    <option value="fixed">ê¸ˆì•¡ í• ì¸ (â‚©)</option>
                  </select>
                </div>
                <div>
                  <label class="block mb-2">í• ì¸ê°’ *</label>
                  <input type="number" id="coupon-discount-value" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="20" required>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2">í¬ê·€ë„ *</label>
                  <select id="coupon-rarity" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required>
                    <option value="common">Common (ì¼ë°˜)</option>
                    <option value="rare">Rare (ë ˆì–´)</option>
                    <option value="epic" selected>Epic (ì—í”½)</option>
                    <option value="legendary">Legendary (ì „ì„¤)</option>
                    <option value="mythic">Mythic (ì‹ í™”)</option>
                  </select>
                </div>
                <div>
                  <label class="block mb-2">ë°œê¸‰ ìˆ˜ëŸ‰ *</label>
                  <input type="number" id="coupon-quantity" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="100" required>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block mb-2">ì‚¬ìš© ê¸°í•œ *</label>
                  <input type="date" id="coupon-expiry" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required>
                </div>
                <div>
                  <label class="block mb-2">ë°°í¬ ë°˜ê²½ (km)</label>
                  <input type="number" id="coupon-radius" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="5" value="5">
                </div>
              </div>

              <div class="mb-6">
                <label class="block mb-2">ì¿ í° ì„¤ëª…</label>
                <textarea id="coupon-description" class="w-full p-3 rounded bg-gray-900 border border-purple-500" rows="3" placeholder="ì¿ í° ì‚¬ìš© ì¡°ê±´ ë“±ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
              </div>

              <div class="flex gap-4">
                <button type="submit" class="btn-primary flex-1">ğŸš€ ì¿ í° ë°œê¸‰</button>
                <button type="button" onclick="hideCouponIssueForm()" class="btn-primary flex-1" style="opacity: 0.6;">ì·¨ì†Œ</button>
              </div>
            </form>
          </div>

          <div class="card glow-border">
            <h3 class="text-2xl font-bold mb-4">ë°œê¸‰í•œ ì¿ í° ëª©ë¡</h3>
            <div id="business-coupon-list"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ê´€ë¦¬ì í˜ì´ì§€ -->
    <div id="admin-page" class="page">
      <div class="max-w-6xl mx-auto px-4 py-20">
        <h2 class="text-4xl font-black mb-8 gradient-text">ğŸ” ê´€ë¦¬ì ì‹œìŠ¤í…œ</h2>
        
        <!-- ê´€ë¦¬ì íƒ€ì… ì„ íƒ íƒ­ -->
        <div class="flex gap-4 mb-8 flex-wrap">
          <button onclick="showAdminTab('super')" id="tab-super" class="btn-primary" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">ğŸ‘‘ ìµœì¢… ê´€ë¦¬ì</button>
          <button onclick="showAdminTab('store')" id="tab-store" class="btn-primary" style="background: linear-gradient(135deg, #22c55e 0%, #10b981 100%);">ğŸª ë§¤ì¥ ê´€ë¦¬ì</button>
          <button onclick="showAdminTab('users')" id="tab-users" class="btn-primary">ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬</button>
          <button onclick="showAdminTab('coupons')" id="tab-coupons" class="btn-primary">ğŸ« ì¿ í° ìŠ¹ì¸</button>
        </div>
        
        <!-- ========== ğŸ‘‘ ìµœì¢… ê´€ë¦¬ì (Super Admin) ========== -->
        <div id="admin-super" class="admin-section">
          <div class="card glow-border mb-8" style="border-color: #ef4444;">
            <h3 class="text-2xl font-bold mb-4 text-red-400">ğŸ‘‘ ìµœì¢… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h3>
            <p class="text-gray-400 mb-6">í”Œë«í¼ ì „ì²´ ê´€ë¦¬ Â· ë§¤ì¥ ìŠ¹ì¸ Â· ì‹œìŠ¤í…œ ì„¤ì •</p>
            
            <div class="grid md:grid-cols-4 gap-4 mb-8">
              <div class="bg-gradient-to-br from-red-500/20 to-orange-500/20 p-4 rounded-lg text-center border border-red-500/30">
                <p class="text-3xl font-bold text-red-400" id="super-total-stores">23</p>
                <p class="text-sm text-gray-400">ë“±ë¡ ë§¤ì¥</p>
              </div>
              <div class="bg-gradient-to-br from-green-500/20 to-emerald-500/20 p-4 rounded-lg text-center border border-green-500/30">
                <p class="text-3xl font-bold text-green-400" id="super-active-stores">18</p>
                <p class="text-sm text-gray-400">í™œì„± ë§¤ì¥</p>
              </div>
              <div class="bg-gradient-to-br from-purple-500/20 to-pink-500/20 p-4 rounded-lg text-center border border-purple-500/30">
                <p class="text-3xl font-bold text-purple-400" id="super-total-users">1,247</p>
                <p class="text-sm text-gray-400">ì´ ì‚¬ìš©ì</p>
              </div>
              <div class="bg-gradient-to-br from-cyan-500/20 to-blue-500/20 p-4 rounded-lg text-center border border-cyan-500/30">
                <p class="text-3xl font-bold text-cyan-400" id="super-total-revenue">â‚©12,450,000</p>
                <p class="text-sm text-gray-400">ì´ ê±°ë˜ì•¡</p>
              </div>
            </div>
          </div>
          
          <!-- ë§¤ì¥ ìŠ¹ì¸ ê´€ë¦¬ -->
          <div class="card glow-border mb-8" style="border-color: #ef4444;">
            <h3 class="text-xl font-bold mb-4">ğŸª ë§¤ì¥ ìŠ¹ì¸ ëŒ€ê¸°</h3>
            <div id="super-pending-stores">
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div>
                    <h4 class="text-lg font-bold">â˜• ì•„ë¯¸ ë‹¤ë°©</h4>
                    <p class="text-sm text-gray-400">ì¹´í˜ Â· ì„œìš¸ ê°•ë‚¨êµ¬ Â· ì‹ ì²­ì¼: 2025-12-18</p>
                    <p class="text-sm text-yellow-400">ëŒ€í‘œ: ê¹€ë‹¤ë°© Â· 010-1234-5678</p>
                  </div>
                  <div class="flex gap-2 flex-wrap">
                    <button onclick="approveStore('store-002')" class="px-4 py-2 bg-green-500 rounded text-white font-bold">âœ“ ìŠ¹ì¸</button>
                    <button onclick="reviewStore('store-002')" class="px-4 py-2 bg-yellow-500 rounded text-white font-bold">ğŸ” ê²€í† ì¤‘</button>
                    <button onclick="rejectStore('store-002')" class="px-4 py-2 bg-red-500 rounded text-white font-bold">âœ• ìŠ¹ì¸ì·¨ì†Œ</button>
                  </div>
                </div>
              </div>
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div>
                    <h4 class="text-lg font-bold">ğŸ— í™©ê¸ˆì˜¬ë¦¬ë¸Œ ì¹˜í‚¨</h4>
                    <p class="text-sm text-gray-400">ì¹˜í‚¨ Â· ì„œìš¸ ì†¡íŒŒêµ¬ Â· ì‹ ì²­ì¼: 2025-12-17</p>
                    <p class="text-sm text-yellow-400">ëŒ€í‘œ: ë°•ì¹˜í‚¨ Â· 010-9876-5432</p>
                  </div>
                  <div class="flex gap-2 flex-wrap">
                    <button onclick="approveStore('store-003')" class="px-4 py-2 bg-green-500 rounded text-white font-bold">âœ“ ìŠ¹ì¸</button>
                    <button onclick="reviewStore('store-003')" class="px-4 py-2 bg-yellow-500 rounded text-white font-bold">ğŸ” ê²€í† ì¤‘</button>
                    <button onclick="rejectStore('store-003')" class="px-4 py-2 bg-red-500 rounded text-white font-bold">âœ• ìŠ¹ì¸ì·¨ì†Œ</button>
                  </div>
                </div>
              </div>
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div>
                    <h4 class="text-lg font-bold">ğŸ¥© í˜„ì‹¤ ë ˆìŠ¤í† ë‘</h4>
                    <p class="text-sm text-gray-400">ì–‘ì‹ Â· ì„œìš¸ ì¤‘ë‘êµ¬ ë©´ëª©ë™ Â· ì‹ ì²­ì¼: 2025-12-19</p>
                    <p class="text-sm text-yellow-400">ëŒ€í‘œ: ì´í˜„ì‹¤ Â· 010-5555-1234</p>
                  </div>
                  <div class="flex gap-2 flex-wrap">
                    <button onclick="approveStore('store-004')" class="px-4 py-2 bg-green-500 rounded text-white font-bold">âœ“ ìŠ¹ì¸</button>
                    <button onclick="reviewStore('store-004')" class="px-4 py-2 bg-yellow-500 rounded text-white font-bold">ğŸ” ê²€í† ì¤‘</button>
                    <button onclick="rejectStore('store-004')" class="px-4 py-2 bg-red-500 rounded text-white font-bold">âœ• ìŠ¹ì¸ì·¨ì†Œ</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- ì „ì²´ ë§¤ì¥ ëª©ë¡ -->
          <div class="card glow-border" style="border-color: #ef4444;">
            <h3 class="text-xl font-bold mb-4">ğŸ“‹ ì „ì²´ ë§¤ì¥ ëª©ë¡</h3>
            <div class="overflow-x-auto">
              <table class="w-full text-left">
                <thead>
                  <tr class="border-b border-gray-700">
                    <th class="p-3">ë§¤ì¥ëª…</th>
                    <th class="p-3">ì—…ì¢…</th>
                    <th class="p-3">ëŒ€í‘œ</th>
                    <th class="p-3">ìƒíƒœ</th>
                    <th class="p-3">ë“±ê¸‰</th>
                    <th class="p-3">ê´€ë¦¬</th>
                  </tr>
                </thead>
                <tbody id="super-store-list">
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3 font-bold">ğŸš ì•„ë¯¸ í•œì •ì‹</td>
                    <td class="p-3">í•œì‹</td>
                    <td class="p-3">ë…¸ìš©í˜¸</td>
                    <td class="p-3"><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ON</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-sm">Grade 1</span></td>
                    <td class="p-3">
                      <button onclick="toggleStoreActive('store-001')" class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ìƒíƒœë³€ê²½</button>
                    </td>
                  </tr>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3 font-bold">â˜• ì•„ë¯¸ ë‹¤ë°©</td>
                    <td class="p-3">ì¹´í˜</td>
                    <td class="p-3">ê¹€ë‹¤ë°©</td>
                    <td class="p-3"><span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ê²€í† ì¤‘</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-gray-500/20 text-gray-400 rounded text-sm">Grade 0</span></td>
                    <td class="p-3">
                      <button onclick="toggleStoreActive('store-002')" class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ìƒíƒœë³€ê²½</button>
                    </td>
                  </tr>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3 font-bold">ğŸ¥© í˜„ì‹¤ ë ˆìŠ¤í† ë‘</td>
                    <td class="p-3">ì–‘ì‹</td>
                    <td class="p-3">ì´í˜„ì‹¤</td>
                    <td class="p-3"><span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ëŒ€ê¸°</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-gray-500/20 text-gray-400 rounded text-sm">Grade 0</span></td>
                    <td class="p-3">
                      <button onclick="toggleStoreActive('store-004')" class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ìƒíƒœë³€ê²½</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- ========== ğŸª ë§¤ì¥ ê´€ë¦¬ì (Store Admin) ========== -->
        <div id="admin-store" class="admin-section" style="display:none;">
          <div class="card glow-border mb-8" style="border-color: #22c55e;">
            <h3 class="text-2xl font-bold mb-4 text-green-400">ğŸª ë§¤ì¥ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h3>
            <p class="text-gray-400 mb-6">ë‚´ ë§¤ì¥ ê´€ë¦¬ Â· ì¿ í° ë°œê¸‰ Â· ì£¼ë¬¸ ê´€ë¦¬ Â· ë§¤ì¶œ ë¶„ì„</p>
            
            <!-- ë§¤ì¥ ì •ë³´ -->
            <div class="bg-gradient-to-r from-green-500/10 to-emerald-500/10 p-6 rounded-lg border border-green-500/30 mb-6">
              <div class="flex items-center gap-4 mb-4">
                <span class="text-6xl">ğŸš</span>
                <div>
                  <h4 class="text-2xl font-bold">ì•„ë¯¸ í•œì •ì‹</h4>
                  <p class="text-gray-400">í•œì‹ Â· ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</p>
                  <p class="text-green-400">â­ 4.8 (1,234ê°œ ë¦¬ë·°) Â· ì˜ì—…ì¤‘</p>
                </div>
              </div>
            </div>
            
            <div class="grid md:grid-cols-4 gap-4">
              <div class="bg-gradient-to-br from-green-500/20 to-emerald-500/20 p-4 rounded-lg text-center border border-green-500/30">
                <p class="text-3xl font-bold text-green-400" id="store-today-orders">47</p>
                <p class="text-sm text-gray-400">ì˜¤ëŠ˜ ì£¼ë¬¸</p>
              </div>
              <div class="bg-gradient-to-br from-cyan-500/20 to-blue-500/20 p-4 rounded-lg text-center border border-cyan-500/30">
                <p class="text-3xl font-bold text-cyan-400" id="store-today-revenue">â‚©892,000</p>
                <p class="text-sm text-gray-400">ì˜¤ëŠ˜ ë§¤ì¶œ</p>
              </div>
              <div class="bg-gradient-to-br from-purple-500/20 to-pink-500/20 p-4 rounded-lg text-center border border-purple-500/30">
                <p class="text-3xl font-bold text-purple-400" id="store-active-coupons">127</p>
                <p class="text-sm text-gray-400">í™œì„± ì¿ í°</p>
              </div>
              <div class="bg-gradient-to-br from-yellow-500/20 to-orange-500/20 p-4 rounded-lg text-center border border-yellow-500/30">
                <p class="text-3xl font-bold text-yellow-400" id="store-coupon-used">89</p>
                <p class="text-sm text-gray-400">ì¿ í° ì‚¬ìš©</p>
              </div>
            </div>
          </div>
          
          <!-- ì‹¤ì‹œê°„ ì£¼ë¬¸ í˜„í™© -->
          <div class="card glow-border mb-8" style="border-color: #22c55e;">
            <h3 class="text-xl font-bold mb-4">ğŸ“¦ ì‹¤ì‹œê°„ ì£¼ë¬¸ í˜„í™©</h3>
            <div id="store-orders-list">
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div>
                    <span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm">ğŸšš ë°°ë‹¬</span>
                    <h4 class="text-lg font-bold mt-2">ì£¼ë¬¸ë²ˆí˜¸: ORD-2024121801</h4>
                    <p class="text-sm text-gray-400">ë¶ˆê³ ê¸° ì •ì‹ x2, ëœì¥ì°Œê°œ x1</p>
                    <p class="text-sm text-cyan-400">ì´ì•¡: â‚©59,000 (ì¿ í° -â‚©11,800 = â‚©47,200)</p>
                  </div>
                  <div class="flex gap-2">
                    <button onclick="acceptOrder('ORD-001')" class="px-4 py-2 bg-green-500 rounded text-white font-bold">âœ“ ì ‘ìˆ˜</button>
                    <button onclick="rejectOrder('ORD-001')" class="px-4 py-2 bg-red-500 rounded text-white font-bold">âœ• ê±°ì ˆ</button>
                  </div>
                </div>
              </div>
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center flex-wrap gap-4">
                  <div>
                    <span class="px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded text-sm">ğŸƒ í¬ì¥</span>
                    <h4 class="text-lg font-bold mt-2">ì£¼ë¬¸ë²ˆí˜¸: ORD-2024121802</h4>
                    <p class="text-sm text-gray-400">ì•„ë¯¸ ì •ì‹ x1, ì™•ê°ˆë¹„íƒ• x1</p>
                    <p class="text-sm text-cyan-400">ì´ì•¡: â‚©40,000 (ì¿ í° -â‚©20,000 = â‚©20,000)</p>
                  </div>
                  <div class="flex gap-2">
                    <span class="px-4 py-2 bg-blue-500/20 text-blue-400 rounded font-bold">ğŸ³ ì¡°ë¦¬ì¤‘</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- ë©”ë‰´ ê´€ë¦¬ -->
          <div class="card glow-border mb-8" style="border-color: #22c55e;">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">ğŸ“‹ ë©”ë‰´ ê´€ë¦¬</h3>
              <button onclick="showAddMenuForm()" class="px-4 py-2 bg-green-500 rounded text-white font-bold">+ ë©”ë‰´ ì¶”ê°€</button>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="store-menu-list">
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700">
                <div class="flex items-center gap-3">
                  <span class="text-4xl">ğŸš</span>
                  <div class="flex-1">
                    <h4 class="font-bold">ì•„ë¯¸ ì •ì‹</h4>
                    <p class="text-cyan-400 font-bold">â‚©22,000</p>
                  </div>
                  <div class="flex flex-col gap-1">
                    <button onclick="editMenu('menu-001')" class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs">ìˆ˜ì •</button>
                    <button onclick="deleteMenu('menu-001')" class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs">ì‚­ì œ</button>
                  </div>
                </div>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700">
                <div class="flex items-center gap-3">
                  <span class="text-4xl">ğŸ–</span>
                  <div class="flex-1">
                    <h4 class="font-bold">ì™•ê°ˆë¹„íƒ•</h4>
                    <p class="text-cyan-400 font-bold">â‚©18,000</p>
                  </div>
                  <div class="flex flex-col gap-1">
                    <button onclick="editMenu('menu-002')" class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs">ìˆ˜ì •</button>
                    <button onclick="deleteMenu('menu-002')" class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs">ì‚­ì œ</button>
                  </div>
                </div>
              </div>
              <div class="bg-gray-800/50 p-4 rounded-lg border border-gray-700">
                <div class="flex items-center gap-3">
                  <span class="text-4xl">ğŸ¥©</span>
                  <div class="flex-1">
                    <h4 class="font-bold">ë¶ˆê³ ê¸° ì •ì‹</h4>
                    <p class="text-cyan-400 font-bold">â‚©25,000</p>
                  </div>
                  <div class="flex flex-col gap-1">
                    <button onclick="editMenu('menu-003')" class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs">ìˆ˜ì •</button>
                    <button onclick="deleteMenu('menu-003')" class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs">ì‚­ì œ</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- ë§¤ì¶œ ë¶„ì„ -->
          <div class="card glow-border" style="border-color: #22c55e;">
            <h3 class="text-xl font-bold mb-4">ğŸ“Š ë§¤ì¶œ ë¶„ì„</h3>
            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <h4 class="font-bold mb-3 text-gray-400">ì´ë²ˆ ì£¼ ë§¤ì¶œ</h4>
                <div class="space-y-2">
                  <div class="flex justify-between items-center">
                    <span>ì›”</span>
                    <div class="flex-1 mx-4 bg-gray-700 rounded h-4">
                      <div class="bg-green-500 h-4 rounded" style="width:70%"></div>
                    </div>
                    <span class="text-green-400">â‚©756,000</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span>í™”</span>
                    <div class="flex-1 mx-4 bg-gray-700 rounded h-4">
                      <div class="bg-green-500 h-4 rounded" style="width:85%"></div>
                    </div>
                    <span class="text-green-400">â‚©892,000</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span>ìˆ˜</span>
                    <div class="flex-1 mx-4 bg-gray-700 rounded h-4">
                      <div class="bg-green-500 h-4 rounded" style="width:60%"></div>
                    </div>
                    <span class="text-green-400">â‚©634,000</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span>ëª©</span>
                    <div class="flex-1 mx-4 bg-gray-700 rounded h-4">
                      <div class="bg-cyan-500 h-4 rounded" style="width:95%"></div>
                    </div>
                    <span class="text-cyan-400">â‚©1,023,000</span>
                  </div>
                </div>
              </div>
              <div>
                <h4 class="font-bold mb-3 text-gray-400">ì¸ê¸° ë©”ë‰´ TOP 5</h4>
                <div class="space-y-2">
                  <div class="flex justify-between items-center p-2 bg-yellow-500/10 rounded">
                    <span>ğŸ¥‡ ë¶ˆê³ ê¸° ì •ì‹</span>
                    <span class="text-yellow-400">127ê±´</span>
                  </div>
                  <div class="flex justify-between items-center p-2 bg-gray-500/10 rounded">
                    <span>ğŸ¥ˆ ì•„ë¯¸ ì •ì‹</span>
                    <span class="text-gray-400">98ê±´</span>
                  </div>
                  <div class="flex justify-between items-center p-2 bg-orange-500/10 rounded">
                    <span>ğŸ¥‰ ì™•ê°ˆë¹„íƒ•</span>
                    <span class="text-orange-400">76ê±´</span>
                  </div>
                  <div class="flex justify-between items-center p-2 rounded">
                    <span>4. í•´ë¬¼íŒŒì „</span>
                    <span class="text-gray-400">54ê±´</span>
                  </div>
                  <div class="flex justify-between items-center p-2 rounded">
                    <span>5. ëœì¥ì°Œê°œ</span>
                    <span class="text-gray-400">43ê±´</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ========== ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬ ========== -->
        <div id="admin-users" class="admin-section" style="display:none;">
          <div class="card glow-border mb-8">
            <h3 class="text-2xl font-bold mb-4">ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬</h3>
            <p class="text-gray-400 mb-6">ë“±ë¡ëœ ì‚¬ìš©ì ëª©ë¡ ë° ê¶Œí•œ ê´€ë¦¬</p>
            
            <div class="flex gap-4 mb-6">
              <input type="text" placeholder="ì‚¬ìš©ì ê²€ìƒ‰..." class="flex-1 p-3 rounded bg-gray-900 border border-purple-500">
              <select class="p-3 rounded bg-gray-900 border border-purple-500">
                <option>ì „ì²´</option>
                <option>ì¼ë°˜ ì‚¬ìš©ì</option>
                <option>ë§¤ì¥ ê´€ë¦¬ì</option>
                <option>ìµœì¢… ê´€ë¦¬ì</option>
              </select>
            </div>
            
            <div class="overflow-x-auto">
              <table class="w-full text-left">
                <thead>
                  <tr class="border-b border-gray-700">
                    <th class="p-3">ID</th>
                    <th class="p-3">ì´ë¦„</th>
                    <th class="p-3">ì´ë©”ì¼</th>
                    <th class="p-3">ë“±ê¸‰</th>
                    <th class="p-3">ìƒíƒœ</th>
                    <th class="p-3">ê°€ì…ì¼</th>
                    <th class="p-3">ê´€ë¦¬</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3">admin001</td>
                    <td class="p-3 font-bold">ë…¸ìš©í˜¸</td>
                    <td class="p-3">admin@airctt.com</td>
                    <td class="p-3"><span class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-sm">Grade 3 (Super)</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ON</span></td>
                    <td class="p-3">2025-01-01</td>
                    <td class="p-3">-</td>
                  </tr>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3">store001</td>
                    <td class="p-3 font-bold">ê¹€ë‹¤ë°©</td>
                    <td class="p-3">store@amidabang.com</td>
                    <td class="p-3"><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">Grade 2 (Store)</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ON</span></td>
                    <td class="p-3">2025-06-15</td>
                    <td class="p-3"><button onclick="modifyUserActive('store001')" class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-xs">ìƒíƒœë³€ê²½</button></td>
                  </tr>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3">user001</td>
                    <td class="p-3 font-bold">í™ê¸¸ë™</td>
                    <td class="p-3">user@example.com</td>
                    <td class="p-3"><span class="px-2 py-1 bg-gray-500/20 text-gray-400 rounded text-sm">Grade 1 (User)</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-sm">ON</span></td>
                    <td class="p-3">2025-12-01</td>
                    <td class="p-3"><button onclick="modifyUserActive('user001')" class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-xs">ìƒíƒœë³€ê²½</button></td>
                  </tr>
                  <tr class="border-b border-gray-700/50">
                    <td class="p-3">user002</td>
                    <td class="p-3 font-bold">ì´ì˜í¬</td>
                    <td class="p-3">lee@example.com</td>
                    <td class="p-3"><span class="px-2 py-1 bg-gray-500/20 text-gray-400 rounded text-sm">Grade 1 (User)</span></td>
                    <td class="p-3"><span class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-sm">OFF</span></td>
                    <td class="p-3">2025-11-20</td>
                    <td class="p-3"><button onclick="modifyUserActive('user002')" class="px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-xs">ìƒíƒœë³€ê²½</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- ========== ğŸ« ì¿ í° ìŠ¹ì¸ ========== -->
        <div id="admin-coupons" class="admin-section" style="display:none;">
          <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="card glow-border text-center">
              <div class="text-5xl mb-4">ğŸ«</div>
              <h3 class="text-xl font-bold mb-2">ìŠ¹ì¸ ëŒ€ê¸°</h3>
              <p class="text-3xl font-black gradient-text" id="admin-pending">0</p>
            </div>
            
            <div class="card glow-border text-center">
              <div class="text-5xl mb-4">âœ…</div>
              <h3 class="text-xl font-bold mb-2">ìŠ¹ì¸ ì™„ë£Œ</h3>
              <p class="text-3xl font-black gradient-text" id="admin-approved">127</p>
            </div>
            
            <div class="card glow-border text-center">
              <div class="text-5xl mb-4">ğŸ’°</div>
              <h3 class="text-xl font-bold mb-2">ì´ ìˆ˜ìµ</h3>
              <p class="text-3xl font-black gradient-text" id="admin-revenue">â‚©6,350</p>
            </div>
          </div>

          <div class="card glow-border mb-8">
            <h3 class="text-2xl font-bold mb-4">ğŸ“‹ ì¿ í° ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡</h3>
            <div id="admin-pending-list">
              <p class="text-gray-400 text-center py-8">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
          </div>

          <div class="card glow-border">
            <h3 class="text-2xl font-bold mb-4">âœ… ìŠ¹ì¸ ì™„ë£Œ ì¿ í°</h3>
            <div id="admin-approved-list">
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center">
                  <div>
                    <span class="rarity-badge rare">RARE</span>
                    <h4 class="text-lg font-bold mt-2">ì•„ë¯¸ í•œì •ì‹ 20% í• ì¸</h4>
                    <p class="text-sm text-gray-400">ë°œê¸‰: 50ê°œ | ë¹„ìš©: â‚©2,500 | ë§¤ì¥: ì•„ë¯¸ í•œì •ì‹</p>
                  </div>
                  <span class="text-green-400">âœ… ìŠ¹ì¸ë¨</span>
                </div>
              </div>
              
              <div class="border-b border-gray-700 pb-4 mb-4">
                <div class="flex justify-between items-center">
                  <div>
                    <span class="rarity-badge epic">EPIC</span>
                    <h4 class="text-lg font-bold mt-2">ì•„ë¯¸ í•œì •ì‹ 5000ì› í• ì¸</h4>
                    <p class="text-sm text-gray-400">ë°œê¸‰: 77ê°œ | ë¹„ìš©: â‚©3,850 | ë§¤ì¥: ì•„ë¯¸ í•œì •ì‹</p>
                  </div>
                  <span class="text-green-400">âœ… ìŠ¹ì¸ë¨</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ========== ğŸ“œ ìŠ¹ì¸ ê¸°ë¡ ========== -->
        <div id="admin-history" class="admin-section" style="display:none;">
          <div class="card glow-border mb-8" style="border-color: #6366f1;">
            <h3 class="text-2xl font-bold mb-4 text-indigo-400">ğŸ“œ ìŠ¹ì¸/ê±°ë¶€ ê¸°ë¡</h3>
            <p class="text-gray-400 mb-6">ëª¨ë“  ìŠ¹ì¸ ë° ê±°ë¶€ ë‚´ì—­ì´ ê¸°ë¡ë©ë‹ˆë‹¤.</p>
            
            <!-- í•„í„° -->
            <div class="flex gap-2 mb-6 flex-wrap">
              <button onclick="filterHistory('all')" class="px-4 py-2 bg-indigo-500 rounded-lg font-bold">ì „ì²´</button>
              <button onclick="filterHistory('store')" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">ë§¤ì¥ ì‹ ì²­</button>
              <button onclick="filterHistory('coupon')" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600">ì¿ í° ì‹ ì²­</button>
              <button onclick="filterHistory('approved')" class="px-4 py-2 bg-green-500/50 rounded-lg hover:bg-green-500">ìŠ¹ì¸</button>
              <button onclick="filterHistory('rejected')" class="px-4 py-2 bg-red-500/50 rounded-lg hover:bg-red-500">ê±°ë¶€</button>
            </div>
            
            <!-- ê¸°ë¡ ëª©ë¡ -->
            <div id="approval-history-list" class="space-y-3">
              <!-- ìƒ˜í”Œ ê¸°ë¡ -->
              <div class="bg-green-500/10 border border-green-500/30 p-4 rounded-lg">
                <div class="flex items-center justify-between flex-wrap gap-2">
                  <div class="flex items-center gap-3">
                    <span class="text-2xl">âœ…</span>
                    <div>
                      <p class="font-bold">ì•„ë¯¸ í•œì •ì‹ - ë§¤ì¥ ìŠ¹ì¸</p>
                      <p class="text-sm text-gray-400">ì²˜ë¦¬ì: ê´€ë¦¬ì | ì‚¬ìœ : ì„œë¥˜ í™•ì¸ ì™„ë£Œ</p>
                    </div>
                  </div>
                  <span class="text-sm text-gray-400">2025-12-18 14:30</span>
                </div>
              </div>
              
              <div class="bg-green-500/10 border border-green-500/30 p-4 rounded-lg">
                <div class="flex items-center justify-between flex-wrap gap-2">
                  <div class="flex items-center gap-3">
                    <span class="text-2xl">âœ…</span>
                    <div>
                      <p class="font-bold">ì•„ë¯¸ í•œì •ì‹ 30% í• ì¸ ì¿ í° - ìŠ¹ì¸</p>
                      <p class="text-sm text-gray-400">ì²˜ë¦¬ì: ê´€ë¦¬ì | ë°œê¸‰ìˆ˜ëŸ‰: 100ì¥</p>
                    </div>
                  </div>
                  <span class="text-sm text-gray-400">2025-12-18 15:45</span>
                </div>
              </div>
              
              <div class="bg-red-500/10 border border-red-500/30 p-4 rounded-lg">
                <div class="flex items-center justify-between flex-wrap gap-2">
                  <div class="flex items-center gap-3">
                    <span class="text-2xl">âŒ</span>
                    <div>
                      <p class="font-bold">í…ŒìŠ¤íŠ¸ ë§¤ì¥ - ê±°ë¶€</p>
                      <p class="text-sm text-gray-400">ì²˜ë¦¬ì: ê´€ë¦¬ì | ì‚¬ìœ : ì‚¬ì—…ìë“±ë¡ì¦ ë¯¸ì œì¶œ</p>
                    </div>
                  </div>
                  <span class="text-sm text-gray-400">2025-12-17 10:20</span>
                </div>
              </div>
              
              <div class="bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-lg">
                <div class="flex items-center justify-between flex-wrap gap-2">
                  <div class="flex items-center gap-3">
                    <span class="text-2xl">ğŸ”</span>
                    <div>
                      <p class="font-bold">í™©ê¸ˆì˜¬ë¦¬ë¸Œ ì¹˜í‚¨ - ê²€í† ì¤‘</p>
                      <p class="text-sm text-gray-400">ì²˜ë¦¬ì: ê´€ë¦¬ì | ë©”ëª¨: ì¶”ê°€ ì„œë¥˜ ìš”ì²­</p>
                    </div>
                  </div>
                  <span class="text-sm text-gray-400">2025-12-19 09:00</span>
                </div>
              </div>
            </div>
            
            <!-- ì—‘ì…€ ë‹¤ìš´ë¡œë“œ -->
            <div class="mt-6 flex gap-2">
              <button onclick="downloadReport('history')" class="px-4 py-2 bg-indigo-500 rounded hover:bg-indigo-600">ğŸ“¥ ê¸°ë¡ ë‹¤ìš´ë¡œë“œ</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div id="login-page" class="page">
      <div class="max-w-md mx-auto px-4 py-20">
        <div class="card glow-border">
          <h2 class="text-3xl font-black mb-8 text-center gradient-text">ë¡œê·¸ì¸</h2>
          
          <!-- ì†Œì…œ ë¡œê·¸ì¸ -->
          <div class="mb-6">
            <!-- êµ¬ê¸€ ë¡œê·¸ì¸ -->
            <button onclick="loginWithGoogle()" class="social-btn btn-google">
              <svg width="20" height="20" viewBox="0 0 20 20">
                <path fill="#4285F4" d="M19.6 10.23c0-.82-.1-1.42-.25-2.05H10v3.72h5.5c-.15.96-.74 2.31-2.04 3.22v2.45h3.16c1.89-1.73 2.98-4.3 2.98-7.34z"/>
                <path fill="#34A853" d="M13.46 15.13c-.83.59-1.96 1-3.46 1-2.64 0-4.88-1.74-5.68-4.15H1.07v2.52C2.72 17.75 6.09 20 10 20c2.7 0 4.96-.89 6.62-2.42l-3.16-2.45z"/>
                <path fill="#FBBC05" d="M3.99 10c0-.69.12-1.35.32-1.97V5.51H1.07A9.973 9.973 0 000 10c0 1.61.39 3.14 1.07 4.49l3.24-2.52c-.2-.62-.32-1.28-.32-1.97z"/>
                <path fill="#EA4335" d="M10 3.88c1.88 0 3.13.81 3.85 1.48l2.84-2.76C14.96.99 12.7 0 10 0 6.09 0 2.72 2.25 1.07 5.51l3.24 2.52C5.12 5.62 7.36 3.88 10 3.88z"/>
              </svg>
              êµ¬ê¸€ë¡œ ì‹œì‘í•˜ê¸°
            </button>
            
            <!-- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ -->
            <button onclick="loginWithKakao()" class="social-btn btn-kakao">
              <svg width="20" height="20" viewBox="0 0 20 20">
                <path fill="#000000" d="M10 0C4.477 0 0 3.462 0 7.727c0 2.805 1.861 5.26 4.658 6.608-.186.674-.678 2.419-.777 2.806-.122.477.175.47.37.342.15-.099 2.428-1.622 3.368-2.273.437.06.885.09 1.34.09 5.522 0 10-3.462 10-7.727S15.522 0 10 0z"/>
              </svg>
              ì¹´ì¹´ì˜¤ë¡œ ì‹œì‘í•˜ê¸°
            </button>
            
            <!-- ë„¤ì´ë²„ ë¡œê·¸ì¸ -->
            <button onclick="loginWithNaver()" class="social-btn btn-naver">
              <svg width="20" height="20" viewBox="0 0 20 20">
                <path fill="#FFFFFF" d="M13.6 0H6.4L6.4 11.4L13.6 20V8.6L13.6 0Z"/>
              </svg>
              ë„¤ì´ë²„ë¡œ ì‹œì‘í•˜ê¸°
            </button>
          </div>
          
          <div class="divider">
            <span>ë˜ëŠ”</span>
          </div>
          
          <!-- ì´ë©”ì¼ ë¡œê·¸ì¸ -->
          <form onsubmit="handleLogin(event)">
            <div class="mb-4">
              <label class="block mb-2">ì´ë©”ì¼</label>
              <input type="email" id="login-email" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required>
            </div>
            <div class="mb-6">
              <label class="block mb-2">ë¹„ë°€ë²ˆí˜¸</label>
              <input type="password" id="login-password" class="w-full p-3 rounded bg-gray-900 border border-purple-500" required>
            </div>
            <button type="submit" class="btn-primary w-full">ë¡œê·¸ì¸</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- ë§¤ì¥ í™ˆí˜ì´ì§€ ë¹Œë” í˜ì´ì§€ -->
  <div id="store-builder-page" class="page">
    <div class="max-w-7xl mx-auto px-4 py-20">
      <h2 class="text-4xl font-black mb-4 gradient-text">ğŸ¨ ë§¤ì¥ í™ˆí˜ì´ì§€ ë¹Œë”</h2>
      <p class="text-gray-400 mb-8">ë‚´ ë§¤ì¥ì„ ë©‹ì§€ê²Œ ê¾¸ë¯¸ê³  ê³ ê°ì—ê²Œ ë³´ì—¬ì£¼ì„¸ìš”!</p>

      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="card glow-border">
          <h3 class="text-xl font-bold mb-4 text-purple-400">ğŸ“ ê¸°ë³¸ ì •ë³´</h3>
          <div class="space-y-4">
            <div>
              <label class="block mb-2 text-sm">ë§¤ì¥ëª…</label>
              <input type="text" id="builder-name" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="ì•„ë¯¸ í•œì •ì‹" onchange="updateStorePreview()">
            </div>
            <div>
              <label class="block mb-2 text-sm">ì—…ì¢…</label>
              <select id="builder-category" class="w-full p-3 rounded bg-gray-900 border border-purple-500" onchange="updateStorePreview()">
                <option value="í•œì‹">í•œì‹</option>
                <option value="ì¤‘ì‹">ì¤‘ì‹</option>
                <option value="ì¼ì‹">ì¼ì‹</option>
                <option value="ì–‘ì‹">ì–‘ì‹</option>
                <option value="ì¹´í˜">ì¹´í˜</option>
                <option value="ë·°í‹°">ë·°í‹°</option>
                <option value="ë¬¸í™”/ê³µì—°">ë¬¸í™”/ê³µì—°</option>
              </select>
            </div>
            <div>
              <label class="block mb-2 text-sm">í•œì¤„ ì†Œê°œ</label>
              <textarea id="builder-description" class="w-full p-3 rounded bg-gray-900 border border-purple-500" rows="2" onchange="updateStorePreview()">ì •ì„±ì„ ë‹´ì•„ ë§Œë“œëŠ” ê±´ê°•í•œ í•œì •ì‹</textarea>
            </div>
            <div>
              <label class="block mb-2 text-sm">ë¡œê³  ì´ëª¨ì§€</label>
              <select id="builder-logo" class="w-full p-3 rounded bg-gray-900 border border-purple-500" onchange="updateStorePreview()">
                <option value="ğŸ±">ğŸ± í•œì‹</option>
                <option value="ğŸœ">ğŸœ ì¤‘ì‹</option>
                <option value="ğŸ£">ğŸ£ ì¼ì‹</option>
                <option value="ğŸ">ğŸ ì–‘ì‹</option>
                <option value="â˜•">â˜• ì¹´í˜</option>
                <option value="ğŸ’‡">ğŸ’‡ ë·°í‹°</option>
                <option value="ğŸ­">ğŸ­ ê³µì—°</option>
              </select>
            </div>
          </div>
        </div>

        <!-- í…Œë§ˆ & ë¯¸ë””ì–´ -->
        <div class="card glow-border">
          <h3 class="text-xl font-bold mb-4 text-cyan-400">ğŸ¨ í…Œë§ˆ & ë¯¸ë””ì–´</h3>
          <div class="space-y-4">
            <div>
              <label class="block mb-2 text-sm">ë©”ì¸ ì»¬ëŸ¬</label>
              <div class="flex gap-2 flex-wrap">
                <button onclick="setBuilderColor('#a855f7')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#a855f7"></button>
                <button onclick="setBuilderColor('#22d3ee')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#22d3ee"></button>
                <button onclick="setBuilderColor('#ef4444')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#ef4444"></button>
                <button onclick="setBuilderColor('#22c55e')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#22c55e"></button>
                <button onclick="setBuilderColor('#f59e0b')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#f59e0b"></button>
                <button onclick="setBuilderColor('#ec4899')" class="w-10 h-10 rounded-full border-2 border-transparent hover:border-white transition" style="background:#ec4899"></button>
              </div>
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ¬ í™ë³´ ë™ì˜ìƒ (YouTube URL)</label>
              <div class="flex gap-2">
                <input type="url" id="builder-video" class="flex-1 p-3 rounded bg-gray-900 border border-purple-500" placeholder="https://youtube.com/watch?v=...">
                <button onclick="previewVideo()" class="px-4 py-2 bg-red-500 rounded hover:bg-red-600 transition" title="ë¯¸ë¦¬ë³´ê¸°">â–¶ï¸</button>
              </div>
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ“¸ ë°°ë„ˆ ì´ë¯¸ì§€ URL</label>
              <input type="url" id="builder-banner" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="https://...">
            </div>
          </div>
        </div>

        <!-- SNS & ì—°ë½ì²˜ -->
        <div class="card glow-border">
          <h3 class="text-xl font-bold mb-4 text-amber-400">ğŸ”— SNS & ì—°ë½ì²˜</h3>
          <div class="space-y-4">
            <div>
              <label class="block mb-2 text-sm">ğŸŒ í™ˆí˜ì´ì§€</label>
              <input type="url" id="builder-website" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="https://mystore.com">
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ“¸ ì¸ìŠ¤íƒ€ê·¸ë¨</label>
              <input type="text" id="builder-instagram" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="@username">
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ì±„ë„</label>
              <input type="url" id="builder-kakao" class="w-full p-3 rounded bg-gray-900 border border-purple-500" placeholder="https://pf.kakao.com/...">
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ“ ì „í™”ë²ˆí˜¸</label>
              <input type="tel" id="builder-phone" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="02-1234-5678">
            </div>
            <div>
              <label class="block mb-2 text-sm">ğŸ“ ì£¼ì†Œ</label>
              <input type="text" id="builder-address" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123">
            </div>
          </div>
        </div>
      </div>

      <!-- ì˜ì—…ì‹œê°„ -->
      <div class="card glow-border mb-8">
        <h3 class="text-xl font-bold mb-4 text-green-400">ğŸ• ì˜ì—…ì‹œê°„</h3>
        <div class="grid md:grid-cols-4 gap-4">
          <div>
            <label class="block mb-2 text-sm">ì›”~ê¸ˆ</label>
            <input type="text" id="builder-hours-weekday" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="11:00 - 22:00">
          </div>
          <div>
            <label class="block mb-2 text-sm">í† ìš”ì¼</label>
            <input type="text" id="builder-hours-sat" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="11:00 - 22:00">
          </div>
          <div>
            <label class="block mb-2 text-sm">ì¼ìš”ì¼</label>
            <input type="text" id="builder-hours-sun" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="12:00 - 21:00">
          </div>
          <div>
            <label class="block mb-2 text-sm">ë¸Œë ˆì´í¬íƒ€ì„</label>
            <input type="text" id="builder-breaktime" class="w-full p-3 rounded bg-gray-900 border border-purple-500" value="15:00 - 17:00">
          </div>
        </div>
      </div>

      <!-- ë©”ë‰´ ê´€ë¦¬ -->
      <div class="card glow-border mb-8">
        <h3 class="text-xl font-bold mb-4 text-pink-400">ğŸ½ï¸ ë©”ë‰´ ê´€ë¦¬</h3>
        <div id="menu-editor-list" class="space-y-4 mb-4">
          <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
        </div>
        <button onclick="addNewMenuItem()" class="btn-primary">+ ë©”ë‰´ ì¶”ê°€</button>
      </div>

      <!-- ë¯¸ë¦¬ë³´ê¸° & ì €ì¥ -->
      <div class="card glow-border">
        <h3 class="text-xl font-bold mb-4">ğŸ“± ë¯¸ë¦¬ë³´ê¸°</h3>
        <div id="store-preview" class="bg-gray-900 rounded-xl p-6 mb-6 border-2 border-purple-500" style="max-width: 400px; margin: 0 auto; box-shadow: 0 0 30px rgba(168,85,247,0.3);">
          <div class="text-center mb-4">
            <span id="preview-logo" class="text-6xl">ğŸ±</span>
          </div>
          <h4 id="preview-name" class="text-2xl font-bold text-center mb-2">ì•„ë¯¸ í•œì •ì‹</h4>
          <p id="preview-category" class="text-gray-400 text-center mb-2">í•œì‹ Â· ê°•ë‚¨êµ¬</p>
          <p id="preview-description" class="text-sm text-gray-300 text-center mb-4">ì •ì„±ì„ ë‹´ì•„ ë§Œë“œëŠ” ê±´ê°•í•œ í•œì •ì‹</p>
          <div class="flex justify-center gap-4 mb-4">
            <span class="text-2xl cursor-pointer hover:scale-110 transition" title="í™ˆí˜ì´ì§€">ğŸŒ</span>
            <span class="text-2xl cursor-pointer hover:scale-110 transition" title="ì¸ìŠ¤íƒ€ê·¸ë¨">ğŸ“¸</span>
            <span class="text-2xl cursor-pointer hover:scale-110 transition" title="ì¹´ì¹´ì˜¤í†¡">ğŸ’¬</span>
            <span class="text-2xl cursor-pointer hover:scale-110 transition" title="ì „í™”">ğŸ“</span>
          </div>
          <div class="text-center text-sm text-gray-400">
            <p>ğŸ“ ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</p>
            <p>ğŸ• 11:00 - 22:00</p>
          </div>
        </div>

        <div class="flex gap-4 justify-center flex-wrap">
          <button onclick="saveStoreSettings()" class="btn-primary">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
          <button onclick="openFullPreview()" class="btn-primary" style="background: linear-gradient(135deg, #22d3ee 0%, #06b6d4 100%);">ğŸ‘ï¸ ì „ì²´í™”ë©´ ë¯¸ë¦¬ë³´ê¸°</button>
          <a href="store_homepage_full.html" target="_blank" class="btn-primary inline-block text-center" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); text-decoration: none;">ğŸš€ ê³ ê¸‰ ë¹Œë” ì—´ê¸°</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ê²Œì„ ì»¨í…Œì´ë„ˆ -->
  <div id="game-container">
    <div class="game-hud">
      <div class="hud-item">
        <span class="hud-label">ì ìˆ˜</span>
        <span class="hud-value" id="score">0</span>
      </div>
      <div class="hud-item">
        <span class="hud-label">íšë“</span>
        <span class="hud-value" id="caught">0</span>
      </div>
    </div>
    <canvas id="game-canvas"></canvas>
    <button onclick="endGame()" class="btn-primary" style="position: absolute; top: 20px; right: 20px; z-index: 1002;">âŒ ì¢…ë£Œ</button>
  </div>

  <!-- ì¿ í° ìƒì„¸ ëª¨ë‹¬ -->
  <div id="coupon-modal" class="modal">
    <div class="modal-content">
      <h3 class="text-2xl font-bold mb-4" id="modal-title"></h3>
      <div id="modal-body"></div>
      <div class="flex gap-4 mt-6">
        <button onclick="useCoupon()" class="btn-primary">ì‚¬ìš©í•˜ê¸°</button>
        <button onclick="closeModal()" class="btn-primary">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼ (ìˆ¨ê¹€) -->
  <div id="naverIdLogin" style="display:none;"></div>

  <script>
    // ============================================
    // CTT ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ë°ì´í„° êµ¬ì¡°
    // ============================================
    
    const API_URL = 'http://localhost:5000/api';
    
    // í˜„ì¬ ì‚¬ìš©ì (users í…Œì´ë¸” êµ¬ì¡°)
    let currentUser = null; // { id, email, full_name, contact_no, user_type, profile_image, total_coupons_used, total_savings }
    let authToken = localStorage.getItem('token');
    
    // ì¿ í° ê´€ë ¨
    let allCoupons = []; // coupons í…Œì´ë¸” êµ¬ì¡°
    let userCoupons = []; // user_coupons í…Œì´ë¸” êµ¬ì¡°
    let selectedCoupon = null;
    let selectedCouponForStore = null;
    
    // ì£¼ë¬¸ ê´€ë ¨
    let cart = []; // ordered_products êµ¬ì¡°
    let currentOrderType = null; // 'pickup', 'delivery', 'reservation'
    
    // ë§¤ì¥ ë°œê¸‰ ì¿ í° (ìŠ¹ì¸ëœ ì¿ í°ë§Œ ê²Œì„ì— ë°°í¬)
    // ğŸ–¼ï¸ 3D ì¿ í° ì´ë¯¸ì§€ URL
    const COUPON_IMAGES = {
      'ami-10': 'coupon-10.png',
      'ami-30': 'coupon-10.png',
      'ami-50': 'coupon-50.png',
      'ami-100': 'coupon-100.png',
      'cafe-50': 'coupon-50.png',
      'cafe-90': 'coupon-90-cafe.png',
      'real-30': 'coupon-50.png'
    };
    
    let gameIssuedCoupons = [
      {
        id: 'store-coupon-001',
        store_id: 'store-001',
        store_name: 'ì•„ë¯¸ í•œì •ì‹',
        store_emoji: 'ğŸš',
        title: 'ì•„ë¯¸ í•œì •ì‹ 30% í• ì¸',
        discount_type: 'percentage',
        discount_value: 30,
        rarity: 'epic',
        total_quantity: 100,
        remaining: 55,
        status: 'approved',
        expiry: '2026-05-31',
        image_url: 'coupon-50.png'
      },
      {
        id: 'store-coupon-002',
        store_id: 'store-002',
        store_name: 'ì•„ë¯¸ ë‹¤ë°©',
        store_emoji: 'â˜•',
        title: 'ì•„ë¯¸ ë‹¤ë°© ì»¤í”¼ 90% í• ì¸',
        discount_type: 'percentage',
        discount_value: 90,
        rarity: 'legendary',
        total_quantity: 50,
        remaining: 38,
        status: 'approved',
        expiry: '2026-03-15',
        image_url: 'coupon-90-cafe.png'
      },
      {
        id: 'store-coupon-003',
        store_id: 'store-004',
        store_name: 'í˜„ì‹¤ ë ˆìŠ¤í† ë‘',
        store_emoji: 'ğŸ¥©',
        title: 'í˜„ì‹¤ ë ˆìŠ¤í† ë‘ 30% í• ì¸',
        discount_type: 'percentage',
        discount_value: 30,
        rarity: 'rare',
        total_quantity: 80,
        remaining: 80,
        status: 'approved',
        expiry: '2026-05-31',
        image_url: 'coupon-50.png'
      },
      {
        id: 'store-coupon-004',
        store_id: 'store-001',
        store_name: 'ì•„ë¯¸ í•œì •ì‹',
        store_emoji: 'ğŸš',
        title: 'ì•„ë¯¸ í•œì •ì‹ 10% í• ì¸',
        discount_type: 'percentage',
        discount_value: 10,
        rarity: 'common',
        total_quantity: 200,
        remaining: 120,
        status: 'approved',
        expiry: '2026-12-31',
        image_url: 'coupon-10.png'
      },
      {
        id: 'store-coupon-005',
        store_id: 'store-001',
        store_name: 'ì•„ë¯¸ í•œì •ì‹',
        store_emoji: 'ğŸš',
        title: 'ì•„ë¯¸ í•œì •ì‹ 100% ë¬´ë£Œ!',
        discount_type: 'percentage',
        discount_value: 100,
        rarity: 'mythic',
        total_quantity: 5,
        remaining: 2,
        status: 'approved',
        expiry: '2026-01-31',
        image_url: 'coupon-100.png'
      }
    ];
    
    // ë§¤ì¥ ë°ì´í„°
    const STORES = {
      'store-001': { name: 'ì•„ë¯¸ í•œì •ì‹', emoji: 'ğŸš', category: 'í•œì‹', address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123', status: 'approved' },
      'store-002': { name: 'ì•„ë¯¸ ë‹¤ë°©', emoji: 'â˜•', category: 'ì¹´í˜', address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬', status: 'reviewing' },
      'store-003': { name: 'í™©ê¸ˆì˜¬ë¦¬ë¸Œ ì¹˜í‚¨', emoji: 'ğŸ—', category: 'ì¹˜í‚¨', address: 'ì„œìš¸ì‹œ ì†¡íŒŒêµ¬', status: 'pending' },
      'store-004': { name: 'í˜„ì‹¤ ë ˆìŠ¤í† ë‘', emoji: 'ğŸ¥©', category: 'ì–‘ì‹', address: 'ì„œìš¸ì‹œ ì¤‘ë‘êµ¬ ë©´ëª©ë™', status: 'approved' }
    };
    
    // CTT products í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ê¸°ë°˜
    const MENU_ITEMS = [
      {
        id: 'product-001',
        store_id: 'store-001',
        product_name: 'íŠ¹ì„  í•œì •ì‹',
        name: 'íŠ¹ì„  í•œì •ì‹',
        description: 'ì œì²  ì¬ë£Œë¡œ ë§Œë“  íŠ¹ì„  í•œì •ì‹',
        category: 'í•œì •ì‹',
        price: 35000,
        original_price: 38000,
        image: 'ğŸ±',
        stock_quantity: 50,
        is_in_stock: true,
        is_active: true,
        is_featured: true,
        rating: 4.8,
        review_count: 67
      },
      {
        id: 'product-002',
        store_id: 'store-001',
        product_name: 'ì™•ê°ˆë¹„íƒ•',
        name: 'ì™•ê°ˆë¹„íƒ•',
        description: 'í‘¸ì§í•œ ì™•ê°ˆë¹„íƒ•',
        category: 'íƒ•ë¥˜',
        price: 18000,
        original_price: 20000,
        image: 'ğŸ–',
        stock_quantity: 30,
        is_in_stock: true,
        is_active: true,
        is_featured: false,
        rating: 4.7,
        review_count: 42
      },
      {
        id: 'product-003',
        store_id: 'store-001',
        product_name: 'ì „ë³µì£½',
        name: 'ì „ë³µì£½',
        description: 'ì‹ ì„ í•œ ì „ë³µìœ¼ë¡œ ë“ì¸ ì˜ì–‘ ì£½',
        category: 'ì£½',
        price: 15000,
        original_price: 16000,
        image: 'ğŸ¥£',
        stock_quantity: 20,
        is_in_stock: true,
        is_active: true,
        is_featured: false,
        rating: 4.6,
        review_count: 28
      },
      {
        id: 'product-004',
        store_id: 'store-001',
        product_name: 'ë¶ˆê³ ê¸° ì •ì‹',
        name: 'ë¶ˆê³ ê¸° ì •ì‹',
        description: 'í•œìš° ë¶ˆê³ ê¸° ì •ì‹',
        category: 'ì •ì‹',
        price: 25000,
        original_price: 27000,
        image: 'ğŸ¥©',
        stock_quantity: 40,
        is_in_stock: true,
        is_active: true,
        is_featured: true,
        rating: 4.9,
        review_count: 87
      },
      {
        id: 'product-005',
        store_id: 'store-001',
        product_name: 'í•´ë¬¼íŒŒì „',
        name: 'í•´ë¬¼íŒŒì „',
        description: 'ë°”ì‚­í•œ í•´ë¬¼íŒŒì „',
        category: 'ì „',
        price: 18000,
        original_price: 19000,
        image: 'ğŸ¥',
        stock_quantity: 25,
        is_in_stock: true,
        is_active: true,
        is_featured: false,
        rating: 4.5,
        review_count: 34
      },
      {
        id: 'product-006',
        store_id: 'store-001',
        product_name: 'LAê°ˆë¹„',
        name: 'LAê°ˆë¹„',
        description: 'í”„ë¦¬ë¯¸ì—„ LAê°ˆë¹„',
        category: 'êµ¬ì´',
        price: 45000,
        original_price: 48000,
        image: 'ğŸ—',
        stock_quantity: 15,
        is_in_stock: true,
        is_active: true,
        is_featured: true,
        rating: 5.0,
        review_count: 65
      }
    ];
    
    // ============================================
    // ê´€ë¦¬ì ê¸°ëŠ¥
    // ============================================
    
    let pendingCoupons = []; // ìŠ¹ì¸ ëŒ€ê¸° ì¿ í°
    let approvedCoupons = []; // ìŠ¹ì¸ ì™„ë£Œ ì¿ í°
    let currentAdminTab = 'super'; // í˜„ì¬ ì„ íƒëœ ê´€ë¦¬ì íƒ­
    
    // ê´€ë¦¬ì íƒ­ ì „í™˜
    function showAdminTab(tab) {
      currentAdminTab = tab;
      
      // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      document.querySelectorAll('.admin-section').forEach(el => el.style.display = 'none');
      
      // ì„ íƒëœ ì„¹ì…˜ ë³´ì´ê¸°
      const section = document.getElementById('admin-' + tab);
      if (section) section.style.display = 'block';
      
      // íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
      const tabs = ['super', 'store', 'users', 'coupons', 'history'];
      tabs.forEach(t => {
        const btn = document.getElementById('tab-' + t);
        if (btn) {
          btn.style.opacity = t === tab ? '1' : '0.5';
        }
      });
      
      // ğŸ”„ ì¿ í° ìŠ¹ì¸ íƒ­ì¼ ë•Œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
      if (tab === 'coupons') {
        renderPendingCoupons();
      }
      
      // ğŸ“œ ìŠ¹ì¸ ê¸°ë¡ íƒ­ì¼ ë•Œ ê¸°ë¡ ë Œë”ë§
      if (tab === 'history') {
        renderApprovalHistory();
      }
    }
    
    // ===== ğŸ”” ê´€ë¦¬ì ì•Œë¦¼ ì‹œìŠ¤í…œ =====
    let adminNotificationsEnabled = false;
    let notificationAudio = null;
    
    function enableAdminNotifications() {
      adminNotificationsEnabled = true;
      
      // ì•Œë¦¼ìŒ ë¯¸ë¦¬ ë¡œë“œ (ì°¨ì„ë²¨ ì†Œë¦¬)
      notificationAudio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdH2Onp6WjH13b3R+iJafoJqPgXRqZWx4hpKcoJuQgHJmYWdweoeVn6GZjH5wZGFmbHmIl6Ccl4t8b2NfZGx5iJijop6Qf29gW19qeIqZpKOfjn1tYF1hanuMm6WjoJB/bmBeYGl7jp2mpKCOf2xfXGBpfJCgp6ahkIBtYF5hanySoamooZJ/bGBdYWl8k6OrqaORgGxgXWBpfJOjq6qikYBsYF1ganySoqqqoZGAbWBdYGl8kqKqqqGRgG1gXmFpfJKiqqmgkX9sX11gaXuSoqqpoJF/bF9dYGl7kaGpqKCRf2xfXWBoe5GhqKefkH9sX11faHuRoainn49/bF9dX2h7kaCnp5+Pf2xfXV9oe5CgpqaejX5rXlxeZ3qQn6WlnYx9al1bXWZ5j56kpJyLfGlcWlxld4+dpKObin1oW1lbZHaPnKOimol8Z1pYWmNziZqhn5eGemZYV1hhcoiYn56Vg3hkVlRYX2+GlZ2ckYF1YlRSVV1shZOam5B/c19RUFRaaoKRmJmNfHBdTk5SWGeBj5aXi3ltWk1LT1Vle42TlYh2aVZKSU1SYXmLkJOEdmZUSkdLUF94iI6RgXJiUEdESk5bd4WLjn5wX0tEQkdMV3OBiIp7bVtIQj9ES1Rve4WHd2lXRT49QUdQaniBhHVlUkE7OT5DSmRyfXxyXUo8NjU6P0ddbHV6bl5KPTMwNTpCU2VsdGteSTswLC0yOUJTYmpuX0s7MCgqLTQ+TVljZ1xIPi4oJiktNkFPW2JZRDssJiMmKjM+SlZdVUE4Kh8fIicuN0RNVFI/NScbGh4iKzI7RE1MQDQoGxkaHiUuN0FJSD4yJhkXGR0lLTZARkQ7LyMYFRgcIis0PENBOCwiGBQWGSAqMjpAPjUqHxcTFRkfKDE5PTowJRwVERMXHigwNzo1LCIaExETFx4nLzY4MikeGBIQExccJi41NzAlHBcQDxIXHCUtNDUvIxsVDw8SGRwlLDQzLCEZExAPEhgcJCszMislHBUPDhEWGiMqMTAoIhoTDg4RFRoiKi8wJiAYEg4OEBQZICgsMCYfFxEODRATFx8mKy0kHhYRDQwPExccIygqJB0WEA0MDxIWGiElJiEaFA8MDBATFRYWHR8fGhUQDA0KDA8SFRYXGR0fHBkTDgoJCgsNEBQYHB0cGxkYFBIRDw0LCQoLDREUFhkZGBcXFRUUEhAQDg4NDAsKCwwODxASExUXFxcXFhYVFRQTExIREA8PDg0NCwsLCgoKCwsLDA0ODw==');
      
      // ë°°ë„ˆ ìˆ¨ê¸°ê¸°
      const banner = document.getElementById('admin-notification-banner');
      if (banner) {
        banner.innerHTML = `
          <div class="flex items-center gap-3">
            <span class="text-3xl">ğŸ””</span>
            <div>
              <p class="font-bold text-green-400">âœ… ì•Œë¦¼ í™œì„±í™”ë¨</p>
              <p class="text-sm text-gray-400">ìƒˆ ì‹ ì²­ ì‹œ ì•Œë¦¼ìŒì´ ì¬ìƒë©ë‹ˆë‹¤.</p>
            </div>
          </div>
          <button onclick="testNotificationSound()" class="px-4 py-2 bg-gray-700 rounded-lg font-bold hover:bg-gray-600 transition">ğŸ”Š í…ŒìŠ¤íŠ¸</button>
        `;
        banner.classList.remove('border-yellow-500/30');
        banner.classList.add('border-green-500/30');
      }
      
      alert('ğŸ”” ì•Œë¦¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìƒˆë¡œìš´ ë§¤ì¥/ì¿ í° ì‹ ì²­ ì‹œ ì•Œë¦¼ìŒì´ ì¬ìƒë©ë‹ˆë‹¤.');
    }
    
    function testNotificationSound() {
      playNotificationSound();
    }
    
    function playNotificationSound() {
      if (adminNotificationsEnabled && notificationAudio) {
        notificationAudio.currentTime = 0;
        notificationAudio.play().catch(e => console.log('ì•Œë¦¼ìŒ ì¬ìƒ ì‹¤íŒ¨:', e));
      }
    }
    
    function showNewRequestAlert(type, name) {
      const alert = document.getElementById('new-requests-alert');
      const nameEl = document.getElementById('new-request-name');
      const infoEl = document.getElementById('new-request-info');
      
      if (alert && nameEl) {
        nameEl.textContent = name;
        infoEl.textContent = type === 'store' ? `ë§¤ì¥ ì…ì  ì‹ ì²­: ${name}` : `ì¿ í° ë°œê¸‰ ì‹ ì²­: ${name}`;
        alert.style.display = 'block';
        playNotificationSound();
      }
    }
    
    function hideNewRequestAlert() {
      const alert = document.getElementById('new-requests-alert');
      if (alert) alert.style.display = 'none';
    }
    
    // ìŠ¹ì¸ ê¸°ë¡ ì €ì¥
    let approvalHistory = JSON.parse(localStorage.getItem('approvalHistory') || '[]');
    
    function addApprovalRecord(type, name, status, reason = '') {
      const record = {
        id: Date.now(),
        type: type, // 'store' or 'coupon'
        name: name,
        status: status, // 'approved', 'rejected', 'reviewing'
        reason: reason,
        admin: currentUser?.name || 'ê´€ë¦¬ì',
        timestamp: new Date().toISOString()
      };
      
      approvalHistory.unshift(record);
      localStorage.setItem('approvalHistory', JSON.stringify(approvalHistory));
      
      return record;
    }
    
    function filterHistory(filter) {
      let filtered = [...approvalHistory];
      
      if (filter === 'store') {
        filtered = filtered.filter(r => r.type === 'store');
      } else if (filter === 'coupon') {
        filtered = filtered.filter(r => r.type === 'coupon');
      } else if (filter === 'approved') {
        filtered = filtered.filter(r => r.status === 'approved');
      } else if (filter === 'rejected') {
        filtered = filtered.filter(r => r.status === 'rejected');
      }
      
      renderApprovalHistory(filtered);
    }
    
    function renderApprovalHistory(records = approvalHistory) {
      const container = document.getElementById('approval-history-list');
      if (!container) return;
      
      if (records.length === 0) {
        container.innerHTML = '<p class="text-center text-gray-400 py-8">ìŠ¹ì¸/ê±°ë¶€ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }
      
      const formatDate = (isoStr) => {
        const d = new Date(isoStr);
        return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
      };
      
      container.innerHTML = records.map(record => {
        const statusColors = {
          approved: 'green',
          rejected: 'red',
          reviewing: 'yellow'
        };
        const statusEmojis = {
          approved: 'âœ…',
          rejected: 'âŒ',
          reviewing: 'ğŸ”'
        };
        const statusLabels = {
          approved: 'ìŠ¹ì¸',
          rejected: 'ê±°ë¶€',
          reviewing: 'ê²€í† ì¤‘'
        };
        const color = statusColors[record.status] || 'gray';
        const emoji = statusEmojis[record.status] || 'ğŸ“‹';
        const label = statusLabels[record.status] || record.status;
        
        return `
          <div class="bg-${color}-500/10 border border-${color}-500/30 p-4 rounded-lg">
            <div class="flex items-center justify-between flex-wrap gap-2">
              <div class="flex items-center gap-3">
                <span class="text-2xl">${emoji}</span>
                <div>
                  <p class="font-bold">${record.name} - ${record.type === 'store' ? 'ë§¤ì¥' : 'ì¿ í°'} ${label}</p>
                  <p class="text-sm text-gray-400">ì²˜ë¦¬ì: ${record.admin} ${record.reason ? '| ì‚¬ìœ : ' + record.reason : ''}</p>
                </div>
              </div>
              <span class="text-sm text-gray-400">${formatDate(record.timestamp)}</span>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // ===== ìµœì¢… ê´€ë¦¬ì ê¸°ëŠ¥ =====
    function approveStore(storeId) {
      if (confirm('ì´ ë§¤ì¥ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        // ìŠ¹ì¸ ê¸°ë¡ ì €ì¥
        addApprovalRecord('store', storeId, 'approved', 'ì„œë¥˜ í™•ì¸ ì™„ë£Œ');
        alert('âœ… ë§¤ì¥ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në§¤ì¥ ID: ' + storeId);
        playNotificationSound();
        
        // ê¸°ë¡ ìƒˆë¡œê³ ì¹¨
        renderApprovalHistory();
      }
    }
    
    function rejectStore(storeId) {
      const reason = prompt('ê±°ì ˆ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
      if (reason) {
        // ê±°ë¶€ ê¸°ë¡ ì €ì¥
        addApprovalRecord('store', storeId, 'rejected', reason);
        alert('âŒ ë§¤ì¥ ìŠ¹ì¸ì´ ê±°ì ˆë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì‚¬ìœ : ' + reason);
        
        // ê¸°ë¡ ìƒˆë¡œê³ ì¹¨
        renderApprovalHistory();
      }
    }
    
    function reviewStore(storeId) {
      const memo = prompt('ê²€í†  ë©”ëª¨ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ì„ íƒ):');
      addApprovalRecord('store', storeId, 'reviewing', memo || 'ì¶”ê°€ ê²€í†  í•„ìš”');
      alert('ğŸ” ê²€í† ì¤‘ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      // ê¸°ë¡ ìƒˆë¡œê³ ì¹¨
      renderApprovalHistory();
    }
    
    function toggleStoreActive(storeId) {
      if (confirm('ë§¤ì¥ ìƒíƒœë¥¼ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ON â†” OFF)')) {
        alert('âœ… ë§¤ì¥ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    // ===== ì‚¬ì—…ì ì…ì  í”Œë¡œìš° (ì¿ íŒ¡ ìŠ¤íƒ€ì¼ 4ë‹¨ê³„) =====
    let currentRegStep = 0;
    let registrationData = {};
    
    function startRegistration() {
      if (!currentUser) {
        alert('âš ï¸ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        showPage('login');
        return;
      }
      
      // ì§„í–‰ í‘œì‹œê¸° ë³´ì´ê¸°
      document.getElementById('register-progress').style.display = 'block';
      showRegisterStep('basic');
      updateStepIndicator(1);
    }
    
    function showRegisterStep(step) {
      // ëª¨ë“  ìŠ¤í… ìˆ¨ê¸°ê¸°
      ['welcome', 'basic', 'operation', 'agreement', 'complete'].forEach(s => {
        const el = document.getElementById('register-step-' + s);
        if (el) el.style.display = 'none';
      });
      
      // ì„ íƒëœ ìŠ¤í… í‘œì‹œ
      const targetStep = document.getElementById('register-step-' + step);
      if (targetStep) targetStep.style.display = 'block';
      
      // í™˜ì˜ í™”ë©´ì´ë©´ ì§„í–‰ í‘œì‹œê¸° ìˆ¨ê¸°ê¸°
      if (step === 'welcome') {
        document.getElementById('register-progress').style.display = 'none';
      }
    }
    
    function updateStepIndicator(step) {
      currentRegStep = step;
      
      for (let i = 1; i <= 4; i++) {
        const indicator = document.getElementById('step-ind-' + i);
        if (indicator) {
          const circle = indicator.querySelector('div');
          const text = indicator.querySelector('span');
          
          if (i < step) {
            // ì™„ë£Œëœ ë‹¨ê³„
            circle.className = 'w-10 h-10 rounded-full bg-green-500 text-white flex items-center justify-center font-bold';
            circle.innerHTML = 'âœ“';
            text.className = 'text-xs mt-1 text-green-400';
          } else if (i === step) {
            // í˜„ì¬ ë‹¨ê³„
            circle.className = 'w-10 h-10 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold';
            circle.innerHTML = i;
            text.className = 'text-xs mt-1 text-purple-400';
          } else {
            // ë¯¸ì™„ë£Œ ë‹¨ê³„
            circle.className = 'w-10 h-10 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center font-bold';
            circle.innerHTML = i;
            text.className = 'text-xs mt-1 text-gray-400';
          }
        }
      }
    }
    
    function goToStep2() {
      // Step 1 ìœ íš¨ì„± ê²€ì‚¬
      const storeName = document.getElementById('reg-store-name').value.trim();
      const category = document.getElementById('reg-category').value;
      const bizNumber = document.getElementById('reg-biz-number').value.trim();
      const ownerName = document.getElementById('reg-owner-name').value.trim();
      const ownerPhone = document.getElementById('reg-owner-phone').value.trim();
      const email = document.getElementById('reg-email').value.trim();
      
      if (!storeName || !category || !bizNumber || !ownerName || !ownerPhone || !email) {
        alert('âš ï¸ ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // ë°ì´í„° ì €ì¥
      registrationData.storeName = storeName;
      registrationData.category = category;
      registrationData.bizNumber = bizNumber;
      registrationData.ownerName = ownerName;
      registrationData.ownerPhone = ownerPhone;
      registrationData.email = email;
      
      showRegisterStep('operation');
      updateStepIndicator(2);
    }
    
    function goToStep3() {
      // Step 2 ìœ íš¨ì„± ê²€ì‚¬
      const address = document.getElementById('reg-address').value.trim();
      const storePhone = document.getElementById('reg-store-phone').value.trim();
      
      if (!address || !storePhone) {
        alert('âš ï¸ ë§¤ì¥ ì£¼ì†Œì™€ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // ë°ì´í„° ì €ì¥
      registrationData.address = address;
      registrationData.addressDetail = document.getElementById('reg-address-detail').value.trim();
      registrationData.storePhone = storePhone;
      registrationData.hours = document.getElementById('reg-hours').value.trim();
      registrationData.closed = document.getElementById('reg-closed').value.trim();
      registrationData.description = document.getElementById('reg-description').value.trim();
      
      showRegisterStep('agreement');
      updateStepIndicator(3);
    }
    
    function submitFinalRegistration() {
      // ì•½ê´€ ë™ì˜ ê²€ì‚¬
      const required = ['agree-terms', 'agree-privacy', 'agree-fee', 'agree-operation'];
      const allChecked = required.every(id => {
        const el = document.getElementById(id);
        return el && el.checked;
      });
      
      if (!allChecked) {
        alert('âš ï¸ ëª¨ë“  í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // ì‹ ì²­ ì™„ë£Œ
      registrationData.submittedAt = new Date().toISOString();
      registrationData.status = 'pending';
      
      // localStorageì— ì €ì¥
      const pendingStores = JSON.parse(localStorage.getItem('pendingStores') || '[]');
      pendingStores.push({
        id: 'store-' + Date.now(),
        ...registrationData
      });
      localStorage.setItem('pendingStores', JSON.stringify(pendingStores));
      
      // ì™„ë£Œ í™”ë©´ í‘œì‹œ
      document.getElementById('submitted-store-name').textContent = registrationData.storeName;
      document.getElementById('submitted-date').textContent = new Date().toLocaleDateString('ko-KR');
      
      showRegisterStep('complete');
      updateStepIndicator(4);
      
      // ê´€ë¦¬ì ì•Œë¦¼ (ì‹œë®¬ë ˆì´ì…˜)
      setTimeout(() => {
        showNewRequestAlert('store', registrationData.storeName);
      }, 1000);
      
      alert('ğŸ‰ ë§¤ì¥ ì…ì  ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê´€ë¦¬ì ê²€í†  í›„ ìŠ¹ì¸ ì•ˆë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
    }
    
    function searchAddress() {
      // ì‹¤ì œë¡œëŠ” ì¹´ì¹´ì˜¤/ë„¤ì´ë²„ ì£¼ì†Œ API ì—°ë™
      alert('ğŸ” ì£¼ì†Œ ê²€ìƒ‰\n\nì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì¹´ì¹´ì˜¤/ë„¤ì´ë²„ ì£¼ì†Œ APIê°€ ì—°ë™ë©ë‹ˆë‹¤.');
      document.getElementById('reg-zipcode').value = '06234';
      document.getElementById('reg-address').value = 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123';
    }
    
    function previewRegImage(input) {
      if (input.files && input.files[0]) {
        const preview = document.getElementById('reg-image-preview');
        if (preview) {
          preview.innerHTML = `<img src="${URL.createObjectURL(input.files[0])}" class="w-24 h-24 object-cover rounded-lg mx-auto">`;
        }
      }
    }
    
    function toggleAllAgreements(checkbox) {
      const allChecks = ['agree-terms', 'agree-privacy', 'agree-fee', 'agree-operation'];
      allChecks.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.checked = checkbox.checked;
      });
    }
    
    function validateAgreementsAndProceed() {
      const required = ['agree-terms', 'agree-privacy', 'agree-fee', 'agree-operation'];
      const allChecked = required.every(id => {
        const el = document.getElementById(id);
        return el && el.checked;
      });
      
      if (!allChecked) {
        alert('âš ï¸ ëª¨ë“  í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      showRegisterStep('form');
    }
    
    function submitStoreRegistration(e) {
      e.preventDefault();
      
      const storeName = document.getElementById('business-name').value;
      const category = document.getElementById('business-category').value;
      const address = document.getElementById('business-address').value;
      
      // ì‹ ì²­ ì™„ë£Œ í‘œì‹œ
      document.getElementById('submitted-store-name').textContent = storeName;
      document.getElementById('submitted-date').textContent = new Date().toLocaleDateString('ko-KR');
      
      // ê´€ë¦¬ì ì•Œë¦¼ (ì‹œë®¬ë ˆì´ì…˜)
      setTimeout(() => {
        showNewRequestAlert('store', storeName);
      }, 1000);
      
      showRegisterStep('complete');
      alert('ğŸ‰ ë§¤ì¥ ì…ì  ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê´€ë¦¬ì ê²€í†  í›„ ìŠ¹ì¸ ì•ˆë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
    }
    
    function showTermsModal(type) {
      alert('ğŸ“‹ ' + (type === 'terms' ? 'ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€' : 'ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨') + ' ì „ë¬¸\n\n(ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ëª¨ë‹¬ì°½ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤)');
    }
    
    // ===== ë‚´ ë§¤ì¥ ëŒ€ì‹œë³´ë“œ =====
    function showMyStoreDashTab(tab) {
      // ëª¨ë“  ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
      ['orders', 'sales', 'coupons', 'decorate'].forEach(t => {
        const content = document.getElementById('mystore-content-' + t);
        const btn = document.getElementById('mystore-tab-' + t);
        if (content) content.style.display = 'none';
        if (btn) {
          btn.classList.remove('bg-gradient-to-r', 'from-cyan-500', 'to-purple-500');
          btn.classList.add('bg-gray-700');
        }
      });
      
      // ì„ íƒëœ ì½˜í…ì¸  í‘œì‹œ
      const targetContent = document.getElementById('mystore-content-' + tab);
      const targetBtn = document.getElementById('mystore-tab-' + tab);
      if (targetContent) targetContent.style.display = 'block';
      if (targetBtn) {
        targetBtn.classList.remove('bg-gray-700');
        targetBtn.classList.add('bg-gradient-to-r', 'from-cyan-500', 'to-purple-500');
      }
    }
    
    // ===== ğŸ° Golden Rabbit CFO ê¸°ëŠ¥ =====
    function toggleRabbitWidget() {
      const widget = document.getElementById('golden-rabbit-widget');
      if (widget.style.display === 'none') {
        widget.style.display = 'block';
      } else {
        widget.style.display = 'none';
      }
    }
    
    // ë©”ì¸ Golden Rabbit (ë‚´ ë§¤ì¥ íƒ­ ìµœìƒë‹¨)
    function askRabbitMain(topic) {
      const analysisDiv = document.getElementById('rabbit-main-analysis');
      
      // ë¡œë”© í‘œì‹œ
      analysisDiv.innerHTML = `
        <div class="flex items-center gap-3">
          <span class="text-2xl animate-bounce">ğŸ°</span>
          <span class="text-yellow-400">ë¶„ì„ ì¤‘...</span>
        </div>
      `;
      
      setTimeout(() => {
        let response = '';
        
        if (topic === 'sales') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„ ê²°ê³¼</span>
            </div>
            <ul class="space-y-1 text-sm">
              <li>â€¢ ì´ ë§¤ì¶œ: <span class="text-cyan-400 font-bold">â‚©340,000</span> (ì „ì¼ ëŒ€ë¹„ <span class="text-green-400">+12%</span>)</li>
              <li>â€¢ ì£¼ë¬¸ ê±´ìˆ˜: <span class="text-white font-bold">12ê±´</span></li>
              <li>â€¢ ê°ë‹¨ê°€: <span class="text-white font-bold">â‚©28,333</span></li>
            </ul>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm">ğŸ¯ í”¼í¬ ì‹œê°„ëŒ€: <span class="text-cyan-400">ì˜¤í›„ 12ì‹œ~1ì‹œ (ì ì‹¬)</span></p>
              <p class="text-sm text-yellow-300">ğŸ’¡ ì¶”ì²œ: ì €ë… ì‹œê°„ëŒ€ í”„ë¡œëª¨ì…˜ ê°•í™”í•˜ë©´ ë§¤ì¶œ 20% ìƒìŠ¹ ì˜ˆìƒë©ë‹ˆë‹¤!</p>
            </div>
          `;
        } else if (topic === 'tax') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“‹ ì„¸ë¬´ ì‹ ê³  ì•ˆë‚´</span>
            </div>
            <ul class="space-y-2 text-sm">
              <li>ğŸ“… <span class="text-cyan-400 font-bold">ë¶€ê°€ì„¸ ì‹ ê³  ê¸°í•œ:</span> 2026ë…„ 1ì›” 25ì¼</li>
              <li>ğŸ’° <span class="text-white">ì˜ˆìƒ ë¶€ê°€ì„¸:</span> â‚©1,200,000</li>
              <li>ğŸ“ <span class="text-white">í•„ìš” ì„œë¥˜:</span> ë§¤ì¶œ/ë§¤ì… ì„¸ê¸ˆê³„ì‚°ì„œ, ì‹ ìš©ì¹´ë“œ ë§¤ì¶œì „í‘œ</li>
            </ul>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm text-yellow-300">ğŸ’¡ íŒ: ê°„ì´ê³¼ì„¸ì ì „í™˜ ì‹œ ì„¸ê¸ˆ ì•½ 30% ì ˆê° ê°€ëŠ¥í•´ìš”!</p>
              <p class="text-sm text-green-400">âœ… ì„¸ë¬´ì‚¬ ì—°ê²° ì„œë¹„ìŠ¤ë„ ì œê³µí•©ë‹ˆë‹¤!</p>
            </div>
          `;
        } else if (topic === 'marketing') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“¢ ë§ˆì¼€íŒ… ì „ëµ ì œì•ˆ</span>
            </div>
            <div class="space-y-3 text-sm">
              <div class="bg-purple-500/20 p-3 rounded-lg">
                <p class="font-bold text-purple-400">ğŸ¯ íƒ€ê²Ÿ ê³ ê° ë¶„ì„</p>
                <p>20-30ëŒ€ ì§ì¥ì¸ì´ ì£¼ ê³ ê°ì¸µ (68%)</p>
              </div>
              <div class="bg-cyan-500/20 p-3 rounded-lg">
                <p class="font-bold text-cyan-400">ğŸ’¡ ì¶”ì²œ í”„ë¡œëª¨ì…˜</p>
                <ul class="mt-1 space-y-1">
                  <li>â€¢ ì ì‹¬ íŠ¹ì„  ì„¸íŠ¸ 10% í• ì¸</li>
                  <li>â€¢ ì¬ë°©ë¬¸ ì¿ í° ë°œê¸‰ (20% í• ì¸)</li>
                  <li>â€¢ ì¸ìŠ¤íƒ€ê·¸ë¨ ë¦¬ë·° ì´ë²¤íŠ¸</li>
                </ul>
              </div>
            </div>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm text-yellow-300">ğŸ’¡ ì˜ˆìƒ íš¨ê³¼: ì›” ë§¤ì¶œ 15~25% ì¦ê°€!</p>
            </div>
          `;
        }
        
        analysisDiv.innerHTML = response;
      }, 1500);
    }
    
    function sendToRabbitMain() {
      const input = document.getElementById('rabbit-main-input');
      const query = input.value.trim();
      
      if (!query) {
        alert('ğŸ° ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
      }
      
      const analysisDiv = document.getElementById('rabbit-main-analysis');
      
      analysisDiv.innerHTML = `
        <div class="flex items-center gap-3 mb-4">
          <span class="text-2xl animate-bounce">ğŸ°</span>
          <span class="text-yellow-400">"${query}"ì— ëŒ€í•´ ë¶„ì„í•´ë“œë¦´ê²Œìš”!</span>
        </div>
        <div class="flex items-center gap-2 text-gray-400">
          <div class="animate-spin w-4 h-4 border-2 border-yellow-500 border-t-transparent rounded-full"></div>
          <span>AI ë¶„ì„ ì¤‘...</span>
        </div>
      `;
      
      setTimeout(() => {
        analysisDiv.innerHTML = `
          <div class="flex items-center gap-2 mb-3">
            <span class="text-lg">ğŸ°</span>
            <span class="font-bold text-yellow-400">ğŸ’¬ Golden Rabbit ë‹µë³€</span>
          </div>
          <div class="bg-black/30 p-3 rounded-lg">
            <p class="text-sm mb-2">ë„¤, "${query}"ì— ëŒ€í•´ ë¶„ì„í•´ë“œë¦´ê²Œìš”! ğŸ°</p>
            <p class="text-sm text-gray-300">í˜„ì¬ ë§¤ì¥ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í•œ ê²°ê³¼, í•´ë‹¹ ì§ˆë¬¸ì— ëŒ€í•œ ìµœì ì˜ ì†”ë£¨ì…˜ì„ ì°¾ì•˜ì–´ìš”.</p>
            <div class="mt-3 p-2 bg-green-500/10 rounded border border-green-500/30">
              <p class="text-sm text-green-300">âœ¨ AI ë¶„ì„ ì™„ë£Œ! ë” ìì„¸í•œ ë‚´ìš©ì´ í•„ìš”í•˜ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”!</p>
            </div>
          </div>
        `;
      }, 2000);
      
      input.value = '';
    }
    
    function askRabbit(topic) {
      const analysisDiv = document.getElementById('rabbit-analysis');
      
      // ë¡œë”© í‘œì‹œ
      analysisDiv.innerHTML = `
        <div class="flex items-center gap-3">
          <span class="text-2xl animate-bounce">ğŸ°</span>
          <span class="text-yellow-400">ë¶„ì„ ì¤‘...</span>
        </div>
      `;
      
      // ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µ (ì‹¤ì œë¡œëŠ” Gemini API ì—°ë™)
      setTimeout(() => {
        let response = '';
        
        if (topic === 'sales') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“Š ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„ ê²°ê³¼</span>
            </div>
            <ul class="space-y-1 text-sm">
              <li>â€¢ ì´ ë§¤ì¶œ: <span class="text-cyan-400 font-bold">â‚©340,000</span> (ì „ì¼ ëŒ€ë¹„ <span class="text-green-400">+12%</span>)</li>
              <li>â€¢ ì£¼ë¬¸ ê±´ìˆ˜: <span class="text-white font-bold">12ê±´</span></li>
              <li>â€¢ ê°ë‹¨ê°€: <span class="text-white font-bold">â‚©28,333</span></li>
            </ul>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm">ğŸ¯ í”¼í¬ ì‹œê°„ëŒ€: <span class="text-cyan-400">ì˜¤í›„ 12ì‹œ~1ì‹œ (ì ì‹¬)</span></p>
              <p class="text-sm text-yellow-300">ğŸ’¡ ì¶”ì²œ: ì €ë… ì‹œê°„ëŒ€ í”„ë¡œëª¨ì…˜ ê°•í™”í•˜ë©´ ë§¤ì¶œ 20% ìƒìŠ¹ ì˜ˆìƒë©ë‹ˆë‹¤!</p>
            </div>
          `;
        } else if (topic === 'tax') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“‹ ì„¸ë¬´ ì‹ ê³  ì•ˆë‚´</span>
            </div>
            <ul class="space-y-2 text-sm">
              <li>ğŸ“… <span class="text-cyan-400 font-bold">ë¶€ê°€ì„¸ ì‹ ê³  ê¸°í•œ:</span> 2026ë…„ 1ì›” 25ì¼</li>
              <li>ğŸ’° <span class="text-white">ì˜ˆìƒ ë¶€ê°€ì„¸:</span> â‚©1,200,000</li>
              <li>ğŸ“ <span class="text-white">í•„ìš” ì„œë¥˜:</span> ë§¤ì¶œ/ë§¤ì… ì„¸ê¸ˆê³„ì‚°ì„œ, ì‹ ìš©ì¹´ë“œ ë§¤ì¶œì „í‘œ</li>
            </ul>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm text-yellow-300">ğŸ’¡ íŒ: ê°„ì´ê³¼ì„¸ì ì „í™˜ ì‹œ ì„¸ê¸ˆ ì•½ 30% ì ˆê° ê°€ëŠ¥í•´ìš”!</p>
              <p class="text-sm text-green-400">âœ… ì„¸ë¬´ì‚¬ ì—°ê²° ì„œë¹„ìŠ¤ë„ ì œê³µí•©ë‹ˆë‹¤!</p>
            </div>
          `;
        } else if (topic === 'marketing') {
          response = `
            <div class="flex items-center gap-2 mb-3">
              <span class="text-lg">ğŸ°</span>
              <span class="font-bold text-yellow-400">ğŸ“¢ ë§ˆì¼€íŒ… ì „ëµ ì œì•ˆ</span>
            </div>
            <div class="space-y-3 text-sm">
              <div class="bg-purple-500/20 p-3 rounded-lg">
                <p class="font-bold text-purple-400">ğŸ¯ íƒ€ê²Ÿ ê³ ê° ë¶„ì„</p>
                <p>20-30ëŒ€ ì§ì¥ì¸ì´ ì£¼ ê³ ê°ì¸µ (68%)</p>
              </div>
              <div class="bg-cyan-500/20 p-3 rounded-lg">
                <p class="font-bold text-cyan-400">ğŸ’¡ ì¶”ì²œ í”„ë¡œëª¨ì…˜</p>
                <ul class="mt-1 space-y-1">
                  <li>â€¢ ì ì‹¬ íŠ¹ì„  ì„¸íŠ¸ 10% í• ì¸</li>
                  <li>â€¢ ì¬ë°©ë¬¸ ì¿ í° ë°œê¸‰ (20% í• ì¸)</li>
                  <li>â€¢ ì¸ìŠ¤íƒ€ê·¸ë¨ ë¦¬ë·° ì´ë²¤íŠ¸</li>
                </ul>
              </div>
            </div>
            <div class="mt-3 pt-3 border-t border-gray-700">
              <p class="text-sm text-yellow-300">ğŸ’¡ ì˜ˆìƒ íš¨ê³¼: ì›” ë§¤ì¶œ 15~25% ì¦ê°€!</p>
            </div>
          `;
        }
        
        analysisDiv.innerHTML = response;
      }, 1500);
    }
    
    function sendToRabbit() {
      const input = document.getElementById('rabbit-input');
      const query = input.value.trim();
      
      if (!query) {
        alert('ğŸ° ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
      }
      
      const analysisDiv = document.getElementById('rabbit-analysis');
      
      // ì‚¬ìš©ì ì…ë ¥ í‘œì‹œ
      analysisDiv.innerHTML = `
        <div class="flex items-center gap-3 mb-4">
          <span class="text-2xl animate-bounce">ğŸ°</span>
          <span class="text-yellow-400">"${query}"ì— ëŒ€í•´ ë¶„ì„í•´ë“œë¦´ê²Œìš”!</span>
        </div>
        <div class="flex items-center gap-2 text-gray-400">
          <div class="animate-spin w-4 h-4 border-2 border-yellow-500 border-t-transparent rounded-full"></div>
          <span>AI ë¶„ì„ ì¤‘...</span>
        </div>
      `;
      
      // ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µ
      setTimeout(() => {
        analysisDiv.innerHTML = `
          <div class="flex items-center gap-2 mb-3">
            <span class="text-lg">ğŸ°</span>
            <span class="font-bold text-yellow-400">ğŸ’¬ Golden Rabbit ë‹µë³€</span>
          </div>
          <div class="bg-black/30 p-3 rounded-lg">
            <p class="text-sm mb-2">ë„¤, "${query}"ì— ëŒ€í•´ ë¶„ì„í•´ë“œë¦´ê²Œìš”! ğŸ°</p>
            <p class="text-sm text-gray-300">í˜„ì¬ ë§¤ì¥ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í•œ ê²°ê³¼, í•´ë‹¹ ì§ˆë¬¸ì— ëŒ€í•œ ìµœì ì˜ ì†”ë£¨ì…˜ì„ ì°¾ì•˜ì–´ìš”.</p>
            <div class="mt-3 p-2 bg-yellow-500/10 rounded border border-yellow-500/30">
              <p class="text-sm text-yellow-300">ğŸ’¡ ìì„¸í•œ ë¶„ì„ì„ ì›í•˜ì‹œë©´ Premium í”Œëœì„ ì´ìš©í•´ë³´ì„¸ìš”!</p>
            </div>
          </div>
        `;
      }, 2000);
      
      input.value = '';
    }
    
    function filterOrders(status) {
      // í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
      document.querySelectorAll('.order-filter-btn').forEach(btn => {
        btn.classList.remove('active', 'bg-red-500', 'bg-yellow-500', 'bg-green-500');
        btn.classList.add('bg-gray-700');
      });
      
      event.target.classList.remove('bg-gray-700');
      if (status === 'new') event.target.classList.add('bg-red-500');
      else if (status === 'preparing') event.target.classList.add('bg-yellow-500');
      else if (status === 'ready') event.target.classList.add('bg-green-500');
      
      console.log('Filter orders:', status);
    }
    
    function acceptOrder(orderId) {
      if (confirm('ì£¼ë¬¸ì„ ì ‘ìˆ˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        alert('âœ… ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì£¼ë¬¸ë²ˆí˜¸: ' + orderId + '\nì¡°ë¦¬ë¥¼ ì‹œì‘í•´ì£¼ì„¸ìš”.');
        playNotificationSound();
      }
    }
    
    function completeOrder(orderId) {
      alert('âœ… ì£¼ë¬¸ ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê³ ê°ì—ê²Œ ì•Œë¦¼ì´ ì „ì†¡ë©ë‹ˆë‹¤.');
    }
    
    function rejectOrder(orderId) {
      const reason = prompt('ì£¼ë¬¸ ê±°ì ˆ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
      if (reason) {
        alert('âŒ ì£¼ë¬¸ì´ ê±°ì ˆë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì‚¬ìœ : ' + reason + '\nê³ ê°ì—ê²Œ ì•Œë¦¼ì´ ì „ì†¡ë©ë‹ˆë‹¤.');
      }
    }
    
    function saveStoreDecoration() {
      alert('ğŸ’¾ ë§¤ì¥ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }
    
    function previewStoreImage(input) {
      if (input.files && input.files[0]) {
        const preview = document.getElementById('store-image-preview');
        if (preview) {
          preview.innerHTML = `<img src="${URL.createObjectURL(input.files[0])}" class="w-32 h-32 object-cover rounded-lg mx-auto">`;
        }
      }
    }
    
    function previewPromoVideo(input) {
      if (input.files && input.files[0]) {
        const preview = document.getElementById('promo-video-preview');
        if (preview) {
          preview.innerHTML = `<video src="${URL.createObjectURL(input.files[0])}" class="w-full max-w-md mx-auto rounded-lg" controls></video>`;
        }
      }
    }
    
    function downloadMenuTemplate() {
      alert('ğŸ“¥ ë©”ë‰´ ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ\n\níŒŒì¼ëª…: menu_template.xlsx');
    }
    
    function showAddMenuForm() {
      const name = prompt('ë©”ë‰´ ì´ë¦„:');
      if (!name) return;
      
      const price = prompt('ê°€ê²© (ìˆ«ìë§Œ):');
      if (!price) return;
      
      const category = prompt('ì¹´í…Œê³ ë¦¬ (ì •ì‹/íƒ•ë¥˜/ì°Œê°œ/ì „ ë“±):');
      
      alert('âœ… ìƒˆ ë©”ë‰´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' + name + ' - â‚©' + parseInt(price).toLocaleString());
    }
    
    function editMenu(menuId) {
      alert('ë©”ë‰´ ìˆ˜ì • í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.\n\në©”ë‰´ ID: ' + menuId);
    }
    
    function deleteMenu(menuId) {
      if (confirm('ì´ ë©”ë‰´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        alert('âœ… ë©”ë‰´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    // ===== ì‚¬ìš©ì ê´€ë¦¬ ê¸°ëŠ¥ =====
    function modifyUserActive(userId) {
      if (confirm('ì‚¬ìš©ì ìƒíƒœë¥¼ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ON â†” OFF)\n\nì‚¬ìš©ì ID: ' + userId)) {
        alert('âœ… ì‚¬ìš©ì ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    // ğŸ”— í™ˆí˜ì´ì§€/SNS ë§í¬ ë°”ë¡œ ì´ë™
    function openWebsiteLink() {
      let url = document.getElementById('business-website').value.trim();
      
      if (!url) {
        alert('âš ï¸ URLì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
      }
      
      // http:// ë˜ëŠ” https:// ì—†ìœ¼ë©´ ì¶”ê°€
      if (!url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
      }
      
      // ìƒˆ íƒ­ì—ì„œ ì—´ê¸°
      window.open(url, '_blank');
    }
    
    function loadAdminPage() {
      // ê¸°ë³¸ íƒ­ í‘œì‹œ
      showAdminTab('super');
      
      // í†µê³„ ì—…ë°ì´íŠ¸
      document.getElementById('admin-pending').textContent = pendingCoupons.length;
      document.getElementById('admin-approved').textContent = approvedCoupons.length;
      
      const totalRevenue = approvedCoupons.reduce((sum, c) => sum + (c.issue_cost || 0), 0);
      document.getElementById('admin-revenue').textContent = 'â‚©' + totalRevenue.toLocaleString();
      
      // ëŒ€ê¸° ëª©ë¡ ë Œë”ë§
      renderPendingCoupons();
    }
    
    // ===== ë§¤ì¥ ìŠ¹ì¸ ê´€ë ¨ =====
    function reviewStore(storeId) {
      const store = STORES[storeId];
      if (confirm(`"${store?.name || storeId}" ë§¤ì¥ì„ ê²€í† ì¤‘ ìƒíƒœë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        alert('ğŸ” ë§¤ì¥ ìƒíƒœê°€ "ê²€í† ì¤‘"ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\n\në‹´ë‹¹ìê°€ ì„œë¥˜ë¥¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤.');
      }
    }
    
    // ===== ì¿ í° ì‚­ì œ =====
    function deleteCoupon(couponId) {
      if (confirm('ì •ë§ ì´ ì¿ í°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì‚­ì œëœ ì¿ í°ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
        alert('ğŸ—‘ï¸ ì¿ í°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        // TODO: API í˜¸ì¶œë¡œ ì‹¤ì œ ì‚­ì œ
      }
    }
    
    // ===== ë§¤ì¥ ì¿ í° ë°œê¸‰ =====
    function issueStoreCoupon(e) {
      e.preventDefault();
      
      const name = document.getElementById('store-coupon-name').value;
      const discount = document.getElementById('store-coupon-discount').value;
      const type = document.getElementById('store-coupon-type').value;
      const qty = document.getElementById('store-coupon-qty').value;
      const expiry = document.getElementById('store-coupon-expiry').value;
      const condition = document.getElementById('store-coupon-condition').value;
      
      const totalCost = parseInt(qty) * 50; // ì¥ë‹¹ 50ì›
      
      // ğŸ’³ ê²°ì œ í™•ì¸
      if (!confirm(`ğŸ’³ ê²°ì œ í™•ì¸\n\nì¿ í°ëª…: ${name}\në°œê¸‰ ìˆ˜ëŸ‰: ${qty}ì¥\në‹¨ê°€: 50ì›/ì¥\n\nğŸ’° ì´ ê²°ì œê¸ˆì•¡: â‚©${totalCost.toLocaleString()}\n\nê²°ì œë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        return;
      }
      
      // í˜„ì¬ ì‚¬ìš©ìì˜ ë§¤ì¥ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const myStore = Object.values(STORES).find(s => s.status === 'approved') || {
        name: currentUser?.name || 'ë‚´ ë§¤ì¥',
        emoji: 'ğŸª'
      };
      
      const newCoupon = {
        id: 'store-coupon-' + Date.now(),
        store_id: 'store-001', // ì‚¬ìš©ìì˜ ë§¤ì¥ ID (ì‹¤ì œë¡œëŠ” ë™ì ìœ¼ë¡œ)
        store_name: myStore.name,
        store_emoji: myStore.emoji || 'ğŸª',
        business_name: myStore.name,
        title: name,
        discount_type: type,
        discount_value: parseInt(discount),
        total_quantity: parseInt(qty),
        remaining: parseInt(qty),
        expiry: expiry,
        condition: condition,
        status: 'pending',
        rarity: discount >= 50 ? 'legendary' : discount >= 30 ? 'epic' : discount >= 20 ? 'rare' : 'common',
        issue_cost: totalCost,
        paid_at: new Date().toISOString(),
        image_url: `coupon-${discount}.png`
      };
      
      pendingCoupons.push(newCoupon);
      
      // ê´€ë¦¬ì ì•Œë¦¼ (ì‹œë®¬ë ˆì´ì…˜)
      setTimeout(() => {
        showNewRequestAlert('coupon', name);
      }, 500);
      
      alert(`âœ… ê²°ì œ ì™„ë£Œ!\n\nğŸ’° ê²°ì œê¸ˆì•¡: â‚©${totalCost.toLocaleString()}\nğŸ« ì¿ í° ë°œê¸‰ ì‹ ì²­ ì™„ë£Œ\n\nìµœì¢… ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê²Œì„ì— ìë™ ë°°í¬ë©ë‹ˆë‹¤.`);
      
      // í¼ ì´ˆê¸°í™”
      e.target.reset();
      document.getElementById('calc-qty').textContent = '0 ì¥';
      document.getElementById('calc-total').textContent = 'â‚©0';
    }
    
    // ğŸ’° ì¿ í° ë¹„ìš© ìë™ ê³„ì‚°
    function calculateCouponCost() {
      const qty = parseInt(document.getElementById('store-coupon-qty').value) || 0;
      const total = qty * 50;
      
      document.getElementById('calc-qty').textContent = qty.toLocaleString() + ' ì¥';
      document.getElementById('calc-total').textContent = 'â‚©' + total.toLocaleString();
    }
    
    // â­ ìµœì¢… ìŠ¹ì¸ ìš”ì²­
    function requestFinalApproval() {
      if (!currentUser) {
        alert('âŒ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        showPage('login');
        return;
      }
      
      if (!confirm('ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆê¹Œ?\n\nâœ“ ë§¤ì¥ ì •ë³´\nâœ“ ì¿ í° ì´ë¯¸ì§€\nâœ“ í™ë³´ ìë£Œ\n\nìµœì¢… ê´€ë¦¬ìì—ê²Œ ìŠ¹ì¸ ìš”ì²­ì„ ë³´ë‚´ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        return;
      }
      
      alert('âœ… ìŠ¹ì¸ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìµœì¢… ê´€ë¦¬ì ê²€í†  í›„ ìŠ¹ì¸ë˜ë©´:\nâ€¢ ë§¤ì¥ í˜ì´ì§€ê°€ í™œì„±í™”ë©ë‹ˆë‹¤\nâ€¢ ì¿ í°ì´ ê²Œì„ì— ë°°í¬ë©ë‹ˆë‹¤\n\nê²€í† ëŠ” ë³´í†µ 1-2ì¼ ì†Œìš”ë©ë‹ˆë‹¤.');
    }
    
    // ğŸ“‹ ë§¤ì¥ ë“±ë¡ ì‹œ ë¡œê·¸ì¸ ì²´í¬
    function registerBusiness(e) {
      e.preventDefault();
      
      if (!currentUser) {
        alert('âŒ ë§¤ì¥ ë“±ë¡ì„ ìœ„í•´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        showPage('login');
        return;
      }
      
      const name = document.getElementById('business-name').value;
      const category = document.getElementById('business-category').value;
      const address = document.getElementById('business-address').value;
      
      // ìƒˆ ë§¤ì¥ ë“±ë¡
      const newStore = {
        id: 'store-' + Date.now(),
        name: name,
        category: category,
        address: address,
        status: 'pending',
        owner: currentUser.name,
        created_at: new Date().toISOString()
      };
      
      alert(`âœ… ë§¤ì¥ ë“±ë¡ ì‹ ì²­ ì™„ë£Œ!\n\në§¤ì¥ëª…: ${name}\nì—…ì¢…: ${category}\n\nìµœì¢… ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.\nìŠ¹ì¸ í›„ ì¿ í° ë°œê¸‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
      
      // ì¿ í° ë°œê¸‰ íƒ­ìœ¼ë¡œ ì´ë™
      showBusinessTab('coupon-issue');
    }
    
    // ===== í™ë³´ í˜ì´ì§€ ê´€ë¦¬ =====
    let promoPageCount = 3;
    const MAX_PROMO_PAGES = 20;
    
    function addPromoPage() {
      if (promoPageCount >= MAX_PROMO_PAGES) {
        alert('âŒ ìµœëŒ€ ' + MAX_PROMO_PAGES + 'í˜ì´ì§€ê¹Œì§€ë§Œ ë“±ë¡ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
      }
      
      const title = prompt('í˜ì´ì§€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”:');
      if (!title) return;
      
      promoPageCount++;
      alert('âœ… ìƒˆ í™ë³´ í˜ì´ì§€ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì œëª©: ' + title + '\ní˜„ì¬: ' + promoPageCount + '/' + MAX_PROMO_PAGES + ' í˜ì´ì§€');
    }
    
    function editPromoPage(pageNum) {
      alert('ğŸ“ í™ë³´ í˜ì´ì§€ ' + pageNum + ' í¸ì§‘ ëª¨ë“œ\n\nì´ë¯¸ì§€, ë™ì˜ìƒ, ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }
    
    function deletePromoPage(pageNum) {
      if (confirm('í˜ì´ì§€ ' + pageNum + 'ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        promoPageCount--;
        alert('ğŸ—‘ï¸ í˜ì´ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    function uploadPromoFile(input, type) {
      const file = input.files[0];
      if (!file) return;
      
      const typeLabels = {
        'image': 'ì´ë¯¸ì§€',
        'video': 'ë™ì˜ìƒ',
        'document': 'ë¬¸ì„œ',
        'audio': 'ì˜¤ë””ì˜¤'
      };
      
      alert('âœ… ' + typeLabels[type] + ' ì—…ë¡œë“œ ì™„ë£Œ!\n\níŒŒì¼ëª…: ' + file.name + '\ní¬ê¸°: ' + (file.size / 1024 / 1024).toFixed(2) + 'MB');
    }
    
    // ===== ë§¤ì¥ ì´ë™ =====
    function goToStore(storeId) {
      const store = STORES[storeId];
      if (store) {
        alert('ğŸª ' + store.name + ' ë§¤ì¥ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        showPage('store');
      }
    }
    
    // ===== ë¹„ì¦ˆë‹ˆìŠ¤ íƒ­ (ì¿ í° ë°œê¸‰, í™ë³´ í¬í•¨) =====
    function showBusinessTab(tab) {
      // ëª¨ë“  íƒ­ ìˆ¨ê¸°ê¸°
      document.getElementById('business-list-tab').style.display = 'none';
      document.getElementById('business-register-tab').style.display = 'none';
      document.getElementById('business-mystore-tab').style.display = 'none';
      
      const couponTab = document.getElementById('business-coupon-issue-tab');
      if (couponTab) couponTab.style.display = 'none';
      
      const promoTab = document.getElementById('business-promo-tab');
      if (promoTab) promoTab.style.display = 'none';
      
      // ì„ íƒëœ íƒ­ ë³´ì´ê¸°
      const targetTab = document.getElementById('business-' + tab + '-tab');
      if (targetTab) targetTab.style.display = 'block';
      
      // ğŸ” ë§¤ì¥ ë“±ë¡ íƒ­ - ì²˜ìŒ í™˜ì˜ í™”ë©´ í‘œì‹œ
      if (tab === 'register') {
        showRegisterStep('welcome');
      }
      
      // ğŸ½ï¸ ë‚´ ë§¤ì¥ íƒ­ - ë§¤ì¥ ëª©ë¡ ë¡œë“œ
      if (tab === 'mystore') {
        loadMyStores();
      }
      
      // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
      document.querySelectorAll('[id^="btn-business-"]').forEach(btn => {
        btn.style.opacity = '0.6';
      });
      const activeBtn = document.getElementById('btn-business-' + tab);
      if (activeBtn) activeBtn.style.opacity = '1';
    }
    
    // ë‚´ ë§¤ì¥ ëª©ë¡ ë¡œë“œ
    function loadMyStores() {
      const container = document.getElementById('my-stores-container');
      if (!container) return;
      
      // í˜„ì¬ ì‚¬ìš©ìì˜ ë§¤ì¥ (Mock ë°ì´í„° + localStorage ëŒ€ê¸° ë§¤ì¥)
      const pendingStores = JSON.parse(localStorage.getItem('pendingStores') || '[]');
      
      const myStores = [
        {
          id: 'store-001',
          name: 'ì•„ë¯¸ í•œì •ì‹',
          emoji: 'ğŸ±',
          category: 'í•œì‹',
          status: 'approved',
          todayOrders: 12,
          todaySales: 285000
        },
        // ëŒ€ê¸° ì¤‘ì¸ ë§¤ì¥ ì¶”ê°€
        ...pendingStores.map(s => ({
          id: s.id,
          name: s.storeName,
          emoji: 'ğŸª',
          category: s.category,
          status: 'pending',
          todayOrders: 0,
          todaySales: 0
        }))
      ];
      
      if (myStores.length === 0) {
        container.innerHTML = `
          <div class="col-span-2 text-center py-12">
            <div class="text-6xl mb-4">ğŸª</div>
            <p class="text-gray-400 mb-4">ë“±ë¡ëœ ë§¤ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            <button onclick="showBusinessTab('register')" class="btn-primary">ë§¤ì¥ ì…ì í•˜ê¸° â†’</button>
          </div>
        `;
        return;
      }
      
      container.innerHTML = myStores.map(store => `
        <div class="card glow-border ${store.status === 'pending' ? 'opacity-70' : ''} cursor-pointer hover:scale-105 transition" onclick="selectMyStore('${store.id}', '${store.status}')">
          <div class="flex items-center gap-4 mb-4">
            <span class="text-5xl">${store.emoji}</span>
            <div>
              <h4 class="text-xl font-bold">${store.name}</h4>
              <p class="text-gray-400">${store.category}</p>
            </div>
          </div>
          ${store.status === 'approved' ? `
            <div class="grid grid-cols-2 gap-4">
              <div class="bg-cyan-500/10 p-3 rounded-lg text-center">
                <p class="text-2xl font-bold text-cyan-400">${store.todayOrders}</p>
                <p class="text-xs text-gray-400">ì˜¤ëŠ˜ ì£¼ë¬¸</p>
              </div>
              <div class="bg-green-500/10 p-3 rounded-lg text-center">
                <p class="text-lg font-bold text-green-400">â‚©${store.todaySales.toLocaleString()}</p>
                <p class="text-xs text-gray-400">ì˜¤ëŠ˜ ë§¤ì¶œ</p>
              </div>
            </div>
          ` : `
            <!-- ğŸ”’ ìŠ¹ì¸ ì „ Lock ìƒíƒœ -->
            <div class="bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-lg text-center">
              <p class="text-yellow-400 font-bold">ğŸ”’ ìŠ¹ì¸ ëŒ€ê¸°ì¤‘</p>
              <p class="text-xs text-gray-400 mt-1">ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
            </div>
          `}
          <div class="mt-4 flex gap-2 flex-wrap">
            <span class="px-2 py-1 ${store.status === 'approved' ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'} rounded text-sm">
              ${store.status === 'approved' ? 'âœ… ìŠ¹ì¸ë¨' : 'â³ ëŒ€ê¸°ì¤‘'}
            </span>
            ${store.status === 'pending' ? '<span class="px-2 py-1 bg-gray-700 text-gray-400 rounded text-sm">ğŸ”’ ë³´ê¸°ì „ìš©</span>' : ''}
          </div>
        </div>
      `).join('');
    }
    
    function selectMyStore(storeId, status) {
      // ìŠ¹ì¸ ì „ Lock ì²´í¬
      if (status === 'pending') {
        alert('â³ ìŠ¹ì¸ ëŒ€ê¸°ì¤‘ì¸ ë§¤ì¥ì…ë‹ˆë‹¤.\n\nê´€ë¦¬ì ìŠ¹ì¸ ì™„ë£Œ í›„:\nâ€¢ ë§¤ì¥ ê¾¸ë¯¸ê¸°\nâ€¢ ì¿ í° ë°œê¸‰\nâ€¢ ì£¼ë¬¸ ê´€ë¦¬\nâ€¢ í™ë³´ í˜ì´ì§€\n\nê¸°ëŠ¥ì´ í™œì„±í™”ë©ë‹ˆë‹¤.');
        return;
      }
      
      // ìŠ¹ì¸ëœ ë§¤ì¥ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
      document.getElementById('my-store-dashboard').style.display = 'block';
      document.getElementById('selected-store-name').textContent = 'ì•„ë¯¸ í•œì •ì‹';
      showMyStoreDashTab('orders');
    }
    
    function renderPendingCoupons() {
      const container = document.getElementById('admin-pending-list');
      
      if (pendingCoupons.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-center py-8">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }
      
      container.innerHTML = pendingCoupons.map(coupon => `
        <div class="border-b border-gray-700 pb-4 mb-4">
          <div class="flex justify-between items-start flex-wrap gap-4">
            <div class="flex-1">
              <span class="rarity-badge ${coupon.rarity}">${coupon.rarity.toUpperCase()}</span>
              <h4 class="text-lg font-bold mt-2">${coupon.title}</h4>
              <p class="text-sm text-gray-400 mt-1">
                í• ì¸: ${coupon.discount_type === 'percentage' ? coupon.discount_value + '%' : 'â‚©' + coupon.discount_value.toLocaleString()} | 
                ìˆ˜ëŸ‰: ${coupon.total_quantity}ê°œ | 
                ë¹„ìš©: â‚©${(coupon.issue_cost || 0).toLocaleString()}
              </p>
              <p class="text-sm text-gray-400 mt-1">ë§¤ì¥: ${coupon.store_name || coupon.business_name}</p>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button onclick="approveCoupon('${coupon.id}')" class="px-4 py-2 bg-green-500 rounded text-white font-bold">âœ… ìŠ¹ì¸</button>
              <button onclick="reviewCoupon('${coupon.id}')" class="px-4 py-2 bg-yellow-500 rounded text-white font-bold">ğŸ” ê²€í† ì¤‘</button>
              <button onclick="rejectCoupon('${coupon.id}')" class="px-4 py-2 bg-red-500 rounded text-white font-bold">âŒ ìŠ¹ì¸ì·¨ì†Œ</button>
            </div>
          </div>
        </div>
      `).join('');
    }
    
    function reviewCoupon(couponId) {
      alert('ğŸ” ì¿ í°ì„ ê²€í† ì¤‘ ìƒíƒœë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.');
    }
    
    function approveCoupon(couponId) {
      const coupon = pendingCoupons.find(c => c.id === couponId);
      if (!coupon) return;
      
      if (!confirm(`ì¿ í°ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${coupon.title}\nìˆ˜ëŸ‰: ${coupon.total_quantity}ê°œ\në¹„ìš©: â‚©${(coupon.issue_cost || 0).toLocaleString()}`)) {
        return;
      }
      
      // ìŠ¹ì¸ ì²˜ë¦¬
      coupon.status = 'approved';
      coupon.approved_at = new Date().toISOString();
      
      approvedCoupons.push(coupon);
      pendingCoupons = pendingCoupons.filter(c => c.id !== couponId);
      
      // ê²Œì„ì— ë°°í¬
      gameIssuedCoupons.push(coupon);
      
      // âœ… ìŠ¹ì¸ ê¸°ë¡ ì €ì¥
      addApprovalRecord('coupon', coupon.title, 'approved', `ë°œê¸‰ìˆ˜ëŸ‰: ${coupon.total_quantity}ì¥`);
      
      alert('âœ… ì¿ í°ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!\nê²Œì„ì— ìë™ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      // ì•Œë¦¼ìŒ ì¬ìƒ
      playNotificationSound();
      
      loadAdminPage();
      renderApprovalHistory();
    }
    
    function rejectCoupon(couponId) {
      const coupon = pendingCoupons.find(c => c.id === couponId);
      if (!coupon) return;
      
      const reason = prompt('ê±°ë¶€ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
      if (!reason) return;
      
      // ê±°ë¶€ ì²˜ë¦¬
      coupon.status = 'rejected';
      coupon.rejected_at = new Date().toISOString();
      coupon.reject_reason = reason;
      
      pendingCoupons = pendingCoupons.filter(c => c.id !== couponId);
      
      // âŒ ê±°ë¶€ ê¸°ë¡ ì €ì¥
      addApprovalRecord('coupon', coupon.title, 'rejected', reason);
      
      alert(`âŒ ì¿ í°ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì‚¬ìœ : ${reason}`);
      
      loadAdminPage();
      renderApprovalHistory();
    }
    
    // ============================================
    // ê¸°ì¡´ í•¨ìˆ˜ë“¤
    // ============================================
    function showPage(pageName) {
      try {
        // ì‚¬ì—…ì í˜ì´ì§€ëŠ” ë¡œê·¸ì¸ í•„ìˆ˜
        if (pageName === 'business' && !currentUser) {
          alert('âš ï¸ ì‚¬ì—…ì í˜ì´ì§€ëŠ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\në¡œê·¸ì¸ í›„:\n1. ë§¤ì¥ ë“±ë¡\n2. ì¿ í° ë°œê¸‰ (ì¥ë‹¹ â‚©50)\n3. ê²Œì„ì— ìë™ ë°°í¬\n4. ê³ ê° íšë“ ë° ë§¤ì¶œ ì¦ëŒ€!');
          pageName = 'login';
        }
        
        // ê´€ë¦¬ì í˜ì´ì§€ëŠ” ê´€ë¦¬ìë§Œ
        if (pageName === 'admin' && !currentUser) {
          alert('ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
          pageName = 'login';
        }
        
        // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        
        // ì„ íƒëœ í˜ì´ì§€ í‘œì‹œ
        const targetPage = document.getElementById(`${pageName}-page`);
        if (targetPage) {
          targetPage.classList.add('active');
        } else {
          console.error('í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', pageName);
          document.getElementById('home-page').classList.add('active');
          return;
        }
        
        // í˜ì´ì§€ë³„ ë¡œë“œ í•¨ìˆ˜ ì‹¤í–‰
        if (pageName === 'wallet') {
          loadWalletCoupons();
        } else if (pageName === 'business') {
          loadBusinessStats();
        } else if (pageName === 'store') {
          loadStoreMenu();
        } else if (pageName === 'store-builder') {
          renderMenuEditor();
          updateStorePreview();
        } else if (pageName === 'admin') {
          loadAdminPage();
        }
        
        // ìŠ¤í¬ë¡¤ ë§¨ ìœ„ë¡œ
        window.scrollTo(0, 0);
      } catch (error) {
        console.error('showPage ì˜¤ë¥˜:', error);
        alert('í˜ì´ì§€ ì „í™˜ ì˜¤ë¥˜: ' + error.message);
      }
    }
    
    // ë¡œê·¸ì¸
    async function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      currentUser = { email: email, name: 'í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì' };
      authToken = 'mock-token';
      localStorage.setItem('token', authToken);
      
      updateUserUI();
      alert('ë¡œê·¸ì¸ ì„±ê³µ!');
      showPage('home');
    }
    
    function updateUserUI() {
      const navUser = document.getElementById('nav-user');
      
      if (currentUser) {
        navUser.innerHTML = `
          <div class="user-info">
            <div class="user-avatar">${currentUser.picture ? `<img src="${currentUser.picture}" style="width:32px;height:32px;border-radius:50%;">` : 'ğŸ‘¤'}</div>
            <span>${currentUser.name}</span>
            <button onclick="event.preventDefault(); logout()" class="text-red-400 hover:text-red-300">ë¡œê·¸ì•„ì›ƒ</button>
          </div>
        `;
      } else {
        navUser.innerHTML = '<a href="#" onclick="event.preventDefault(); showPage(\'login\')">ğŸ‘¤ ë¡œê·¸ì¸</a>';
      }
    }
    
    function logout() {
      currentUser = null;
      authToken = null;
      localStorage.removeItem('token');
      updateUserUI();
      alert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
      showPage('home');
    }
    
    // ì¿ í° ì§€ê°‘
    async function loadWalletCoupons() {
      if (!authToken) {
        document.getElementById('coupon-list').innerHTML = '<p class="text-center text-gray-400">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>';
        return;
      }
      
      renderMockCoupons();
    }
    
    function renderMockCoupons() {
      // CTT ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ Mock ì¿ í° ë°ì´í„°
      const mockCoupons = [
        {
          id: 'coupon-001',
          store_id: 'store-001',
          coupon_name: 'ì•„ë¯¸ í•œì •ì‹ 20% í• ì¸',
          title: 'ì•„ë¯¸ í•œì •ì‹ 20% í• ì¸',
          coupon_code: 'AMI_20_PERCENT',
          discount_type: 'percentage',
          discount_value: 20,
          min_purchase_amount: 10000,
          rarity: 'rare',
          business_name: 'ì•„ë¯¸ í•œì •ì‹',
          store_emoji: 'ğŸš',
          is_used: false,
          is_active: true,
          valid_till: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
        },
        {
          id: 'coupon-002',
          store_id: 'store-001',
          coupon_name: 'ì•„ë¯¸ í•œì •ì‹ 5000ì› í• ì¸',
          title: 'ì•„ë¯¸ í•œì •ì‹ 5000ì› í• ì¸',
          coupon_code: 'AMI_5000_WON',
          discount_type: 'fixed',
          discount_value: 5000,
          min_purchase_amount: 20000,
          rarity: 'epic',
          business_name: 'ì•„ë¯¸ í•œì •ì‹',
          store_emoji: 'ğŸš',
          is_used: false,
          is_active: true,
          valid_till: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
        },
        {
          id: 'coupon-003',
          store_id: null,
          coupon_name: 'ê²Œì„ ë³´ìƒ ì¿ í°',
          title: 'ê²Œì„ ë³´ìƒ ì¿ í°',
          coupon_code: 'GAME_REWARD_001',
          discount_type: 'fixed',
          discount_value: 10000,
          min_purchase_amount: 0,
          rarity: 'legendary',
          business_name: 'ê²Œì„ ë³´ìƒ',
          store_emoji: 'ğŸ®',
          is_used: false,
          is_active: true,
          valid_till: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString()
        }
      ];
      
      // â­ ê²Œì„ì—ì„œ íšë“í•œ ì¿ í° ë¶ˆëŸ¬ì˜¤ê¸° (í†µì¼ëœ í‚¤: allCoupons)
      const savedCoupons = JSON.parse(localStorage.getItem('allCoupons') || '[]');
      
      // ê¸°ì¡´ airctt_couponsë„ í˜¸í™˜ì„± ìœ„í•´ í™•ì¸
      const legacyCoupons = JSON.parse(localStorage.getItem('airctt_coupons') || '[]');
      const convertedLegacy = legacyCoupons.map((gc, idx) => ({
        id: gc.id || ('legacy-coupon-' + idx),
        store_id: gc.store_id || 'store-001',
        coupon_name: gc.name || 'ê²Œì„ ë³´ìƒ ì¿ í°',
        title: gc.name || 'ê²Œì„ ë³´ìƒ ì¿ í°',
        coupon_code: 'GAME_' + (gc.id || idx),
        discount_type: gc.discount_type || 'percentage',
        discount_value: gc.discount_value || parseInt(gc.discount) || 10,
        min_purchase_amount: 0,
        rarity: gc.rarity || 'rare',
        business_name: gc.store || gc.store_name || 'ê²Œì„ ë³´ìƒ',
        store_name: gc.store || gc.store_name || 'ê²Œì„ ë³´ìƒ',
        store_emoji: gc.store_emoji || 'ğŸ«',
        is_used: gc.used || false,
        is_active: true,
        valid_till: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
        originalId: gc.id
      }));
      
      // ğŸ”„ ì¤‘ë³µ ì œê±°: ID ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©
      const mergedCoupons = [...mockCoupons];
      const seenIds = new Set(mockCoupons.map(c => c.id));
      
      // savedCoupons (ê²Œì„ì—ì„œ ì €ì¥ëœ ì¿ í°) ì¶”ê°€
      savedCoupons.forEach(c => {
        if (!seenIds.has(c.id)) {
          mergedCoupons.push(c);
          seenIds.add(c.id);
        }
      });
      
      // legacy ì¿ í° ì¶”ê°€
      convertedLegacy.forEach(c => {
        if (!seenIds.has(c.id) && !seenIds.has(c.originalId)) {
          mergedCoupons.push(c);
          seenIds.add(c.id);
        }
      });
      
      allCoupons = mergedCoupons;
      renderCoupons(allCoupons);
    }
    
    function renderCoupons(coupons) {
      const container = document.getElementById('coupon-list');
      
      if (coupons.length === 0) {
        container.innerHTML = '<p class="text-center text-gray-400">íšë“í•œ ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤. ê²Œì„ì„ í”Œë ˆì´í•˜ì„¸ìš”!</p>';
        return;
      }
      
      // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
      const formatDate = (dateStr) => {
        if (!dateStr) return '';
        const d = new Date(dateStr);
        const month = (d.getMonth() + 1).toString().padStart(2, '0');
        const day = d.getDate().toString().padStart(2, '0');
        const hour = d.getHours().toString().padStart(2, '0');
        const min = d.getMinutes().toString().padStart(2, '0');
        return `${month}/${day} ${hour}:${min}`;
      };
      
      container.innerHTML = coupons.map(coupon => `
        <div class="coupon-card ${coupon.rarity}" style="cursor:pointer; position:relative;">
          <div class="flex items-center justify-between flex-wrap gap-4">
            <!-- ğŸ–¼ï¸ ì¿ í° 3D ì´ë¯¸ì§€ -->
            <div class="flex items-center gap-4">
              <div class="w-28 h-20 rounded-lg overflow-hidden bg-gray-800 flex-shrink-0" style="box-shadow: 0 4px 20px rgba(168,85,247,0.3);">
                ${coupon.image_url ? 
                  `<img src="${coupon.image_url}" alt="${coupon.title}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full flex items-center justify-center text-4xl\\'>${coupon.store_emoji || 'ğŸ«'}</div>';">` :
                  `<div class="w-full h-full flex items-center justify-center text-4xl">${coupon.store_emoji || 'ğŸ«'}</div>`
                }
              </div>
              <div class="flex-1">
                <span class="rarity-badge ${coupon.rarity}">${coupon.rarity.toUpperCase()}</span>
                <h3 class="text-xl font-bold">${coupon.title}</h3>
                <p class="text-gray-400 cursor-pointer hover:text-cyan-400 underline" onclick="event.stopPropagation(); goToStoreDetail('${coupon.store_id || 'store-001'}')">${coupon.store_emoji || 'ğŸª'} ${coupon.business_name || coupon.store_name} â†’</p>
                <!-- ğŸ“… íšë“/ê°±ì‹  ì‹œê°„ í‘œì‹œ -->
                <p class="text-xs text-gray-500 mt-1">
                  ${coupon.acquired_at ? `ğŸ• íšë“: ${formatDate(coupon.acquired_at)}` : ''}
                  ${coupon.updated_at && coupon.updated_at !== coupon.acquired_at ? ` | ğŸ”„ ê°±ì‹ : ${formatDate(coupon.updated_at)}` : ''}
                </p>
              </div>
            </div>
            <div class="text-right flex flex-col gap-2">
              <p class="text-2xl font-bold text-cyan-400">
                ${coupon.discount_type === 'percentage' ? coupon.discount_value + '%' : 'â‚©' + coupon.discount_value.toLocaleString()}
              </p>
              <p class="text-sm ${coupon.is_used ? 'text-red-400' : 'text-green-400'}">
                ${coupon.is_used ? 'ì‚¬ìš©ì™„ë£Œ' : 'ì‚¬ìš©ê°€ëŠ¥'}
              </p>
              <div class="flex gap-2">
                ${!coupon.is_used ? `<button onclick="event.stopPropagation(); useCouponAtStore('${coupon.id}')" class="px-3 py-1 bg-gradient-to-r from-cyan-500 to-purple-500 rounded font-bold text-xs hover:opacity-80 transition">ğŸª ë§¤ì¥</button>` : ''}
                <button onclick="event.stopPropagation(); deleteSingleCoupon('${coupon.id}')" class="px-3 py-1 bg-red-600/50 hover:bg-red-600 rounded font-bold text-xs transition" title="ì¿ í° ì‚­ì œ">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>
        </div>
      `).join('');
    }
    
    function filterCoupons(status) {
      if (status === 'all') {
        renderCoupons(allCoupons);
      } else {
        const filtered = allCoupons.filter(c => {
          if (status === 'available') return !c.is_used;
          if (status === 'used') return c.is_used;
          return true;
        });
        renderCoupons(filtered);
      }
    }
    
    // â­ ëª¨ë“  ì¿ í° ì‚­ì œ í•¨ìˆ˜
    function deleteAllCoupons() {
      const gameCoupons = JSON.parse(localStorage.getItem('airctt_coupons') || '[]');
      const totalCount = allCoupons.length;
      const gameCount = gameCoupons.length;
      
      if (totalCount === 0 && gameCount === 0) {
        alert('ì‚­ì œí•  ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      const confirmMsg = `ì •ë§ ëª¨ë“  ì¿ í°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâ€¢ ê²Œì„ íšë“ ì¿ í°: ${gameCount}ê°œ\nâ€¢ ì „ì²´ ì¿ í°: ${totalCount}ê°œ\n\nâš ï¸ ì‚­ì œëœ ì¿ í°ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`;
      
      if (confirm(confirmMsg)) {
        // localStorage ì¿ í° ì‚­ì œ
        localStorage.removeItem('airctt_coupons');
        localStorage.removeItem('airctt_points');
        
        // ë©”ëª¨ë¦¬ ì¿ í° ì´ˆê¸°í™”
        allCoupons = [];
        
        // UI ìƒˆë¡œê³ ì¹¨
        renderCoupons([]);
        
        alert('âœ… ëª¨ë“  ì¿ í°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    // ğŸ—‘ï¸ ê°œë³„ ì¿ í° ì‚­ì œ í•¨ìˆ˜
    function deleteSingleCoupon(couponId) {
      const coupon = allCoupons.find(c => c.id === couponId);
      if (!coupon) return;
      
      if (!confirm(`ì •ë§ ì´ ì¿ í°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì¿ í°: ${coupon.title}\në§¤ì¥: ${coupon.store_name || coupon.business_name}\n\nâš ï¸ ì‚­ì œëœ ì¿ í°ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`)) {
        return;
      }
      
      // ë©”ëª¨ë¦¬ì—ì„œ ì œê±°
      allCoupons = allCoupons.filter(c => c.id !== couponId);
      
      // localStorageì—ì„œë„ ì œê±°
      const gameCoupons = JSON.parse(localStorage.getItem('airctt_coupons') || '[]');
      const updatedCoupons = gameCoupons.filter(c => c.id !== couponId);
      localStorage.setItem('airctt_coupons', JSON.stringify(updatedCoupons));
      
      // UI ìƒˆë¡œê³ ì¹¨
      renderCoupons(allCoupons);
      
      alert('ğŸ—‘ï¸ ì¿ í°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    
    // ğŸª ë§¤ì¥ ìƒì„¸ í˜ì´ì§€ ì´ë™
    function goToStoreDetail(storeId) {
      const store = STORES[storeId];
      if (!store) {
        // ê¸°ë³¸ ë§¤ì¥ (ì•„ë¯¸ í•œì •ì‹)ìœ¼ë¡œ ì´ë™
        showStoreDetailPage('store-001');
        return;
      }
      showStoreDetailPage(storeId);
    }
    
    // ë§¤ì¥ ìƒì„¸ í˜ì´ì§€ í‘œì‹œ
    function showStoreDetailPage(storeId) {
      const store = STORES[storeId];
      currentStoreId = storeId;
      
      // ë§¤ì¥ ì •ë³´ ì—…ë°ì´íŠ¸
      const storeInfo = document.getElementById('store-detail-info');
      if (storeInfo && store) {
        document.getElementById('detail-store-name').textContent = store.name;
        document.getElementById('detail-store-emoji').textContent = store.emoji;
        document.getElementById('detail-store-address').textContent = store.address;
        document.getElementById('detail-store-category').textContent = store.category;
      }
      
      showPage('store');
      loadMenuItems(storeId);
    }
    
    let currentStoreId = 'store-001';
    
    function useCouponAtStore(couponId) {
      const coupon = allCoupons.find(c => c.id === couponId);
      if (!coupon || coupon.is_used) {
        alert('ì´ë¯¸ ì‚¬ìš©ëœ ì¿ í°ì…ë‹ˆë‹¤.');
        return;
      }
      
      // â­ ë§¤ì¥ë³„ ë°”ë¡œ ì´ë™ + ì¿ í° ì ìš©
      const storeName = coupon.business_name || coupon.store_name || 'ì•Œ ìˆ˜ ì—†ëŠ” ë§¤ì¥';
      const storeEmoji = coupon.store_emoji || 'ğŸª';
      
      alert(`${storeEmoji} ${storeName} ë§¤ì¥ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤!\n\nì ìš© ì¿ í°: ${coupon.title}\ní• ì¸: ${coupon.discount_type === 'percentage' ? coupon.discount_value + '%' : 'â‚©' + coupon.discount_value.toLocaleString()}`);
      
      // ë§¤ì¥ í˜ì´ì§€ë¡œ ì´ë™
      showPage('store');
      
      // ì¿ í° ìë™ ì„ íƒ
      setTimeout(() => {
        selectCouponForStore(couponId);
        document.getElementById('checkout-section')?.scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }
    
    // ì¿ í°ì—ì„œ ë°”ë¡œ ë§¤ì¥ ì´ë™ (ìƒˆ í•¨ìˆ˜)
    function goToStoreFromCoupon(storeId, couponId) {
      const store = STORES[storeId];
      if (!store) {
        alert('ë§¤ì¥ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      alert(`${store.emoji} ${store.name} ë§¤ì¥ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤!`);
      showPage('store');
      
      if (couponId) {
        setTimeout(() => selectCouponForStore(couponId), 100);
      }
    }
    
    function openCouponModal(couponId) {
      selectedCoupon = allCoupons.find(c => c.id === couponId);
      if (!selectedCoupon) return;
      
      document.getElementById('modal-title').textContent = selectedCoupon.title;
      document.getElementById('modal-body').innerHTML = `
        <p class="mb-2"><strong>ìƒì :</strong> ${selectedCoupon.business_name}</p>
        <p class="mb-2"><strong>í• ì¸:</strong> ${selectedCoupon.discount_type === 'percentage' ? selectedCoupon.discount_value + '%' : 'â‚©' + selectedCoupon.discount_value.toLocaleString()}</p>
        <p class="mb-2"><strong>í¬ê·€ë„:</strong> <span class="rarity-badge ${selectedCoupon.rarity}">${selectedCoupon.rarity.toUpperCase()}</span></p>
        <p class="mb-2"><strong>ìƒíƒœ:</strong> ${selectedCoupon.is_used ? 'ì‚¬ìš©ì™„ë£Œ' : 'ì‚¬ìš©ê°€ëŠ¥'}</p>
      `;
      
      document.getElementById('coupon-modal').classList.add('active');
    }
    
    function closeModal() {
      document.getElementById('coupon-modal').classList.remove('active');
    }
    
    function useCoupon() {
      if (!selectedCoupon || selectedCoupon.is_used) {
        alert('ì´ë¯¸ ì‚¬ìš©ëœ ì¿ í°ì…ë‹ˆë‹¤.');
        return;
      }
      
      selectedCoupon.is_used = true;
      alert('ì¿ í°ì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!');
      closeModal();
      renderCoupons(allCoupons);
    }
    
    // ì‚¬ì—…ì í˜ì´ì§€
    function registerBusiness(e) {
      e.preventDefault();
      
      if (!currentUser) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!');
        showPage('login');
        return;
      }
      
      const name = document.getElementById('business-name').value;
      const category = document.getElementById('business-category').value;
      const address = document.getElementById('business-address').value;
      const phone = document.getElementById('business-phone').value;
      const description = document.getElementById('business-description').value;
      const hours = document.getElementById('business-hours').value;
      const minOrder = document.getElementById('business-min-order').value;
      const imageFile = document.getElementById('business-image').files[0];
      
      // ì´ë¯¸ì§€ ì²˜ë¦¬
      let logoUrl = 'https://via.placeholder.com/200';
      if (imageFile) {
        // ì‹¤ì œë¡œëŠ” ì„œë²„ì— ì—…ë¡œë“œ
        logoUrl = URL.createObjectURL(imageFile);
      }
      
      // CTT stores í…Œì´ë¸” êµ¬ì¡°ë¡œ ìƒˆ ë§¤ì¥ ìƒì„±
      const newStore = {
        id: 'store-' + Date.now(),
        owner_id: currentUser.id || 'user-002',
        business_name: name,
        business_number: 'AUTO-' + Date.now(),
        category: category,
        address: address,
        phone: phone,
        email: currentUser.email,
        description: description || `${name} - ${category} ì „ë¬¸ì `,
        logo_url: logoUrl,
        opening_hours: hours ? { default: hours } : { default: '10:00-22:00' },
        nearby_coupon_range: 500,
        total_coupons_issued: 0,
        total_revenue: 0,
        rating: 5.0,
        review_count: 0,
        is_verified: false,
        is_active: true,
        status: true,
        created_at: new Date().toISOString()
      };
      
      // ìƒˆ ë§¤ì¥ ì €ì¥ (ì‹¤ì œë¡œëŠ” ì„œë²„ì—)
      console.log('ğŸª ìƒˆ ë§¤ì¥ ë“±ë¡:', newStore);
      
      alert(`âœ… ì‚¬ì—…ì ë“±ë¡ ì™„ë£Œ!\n\nìƒí˜¸: ${name}\nì—…ì¢…: ${category}\nì£¼ì†Œ: ${address}\nì „í™”: ${phone}\n\në§¤ì¥ í˜ì´ì§€ê°€ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ì œ ì¿ í°ì„ ë°œê¸‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!`);
      
      // ë°œê¸‰ë¹„ìš© 50ì› ì°¨ê° ì•ˆë‚´
      alert(`ğŸ’° ì‚¬ì—…ì ë“±ë¡ë¹„: â‚©0 (ë¬´ë£Œ)\n\në‹¤ìŒ ë‹¨ê³„:\n1. ì¿ í° ë°œê¸‰ (ì¥ë‹¹ â‚©50)\n2. ê²Œì„ì— ìë™ ë°°í¬\n3. ê³ ê° íšë“ ë° ë§¤ì¶œ ì¦ëŒ€!`);
      
      showBusinessTab('mystore');
    }
    
    function showCouponIssueForm() {
      document.getElementById('coupon-issue-form').style.display = 'block';
      document.getElementById('coupon-issue-form').scrollIntoView({ behavior: 'smooth' });
    }
    
    function hideCouponIssueForm() {
      document.getElementById('coupon-issue-form').style.display = 'none';
    }
    
    function toggleDiscountInput() {
      const type = document.getElementById('coupon-discount-type').value;
      const input = document.getElementById('coupon-discount-value');
      if (type === 'percentage') {
        input.placeholder = '20';
      } else {
        input.placeholder = '5000';
      }
    }
    
    function issueCoupon(e) {
      e.preventDefault();
      
      if (!currentUser) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!');
        showPage('login');
        return;
      }
      
      const title = document.getElementById('coupon-title').value;
      const discountType = document.getElementById('coupon-discount-type').value;
      const discountValue = document.getElementById('coupon-discount-value').value;
      const rarity = document.getElementById('coupon-rarity').value;
      const quantity = document.getElementById('coupon-quantity').value;
      const expiry = document.getElementById('coupon-expiry').value;
      const radius = document.getElementById('coupon-radius').value;
      const description = document.getElementById('coupon-description').value;
      
      // ë°œê¸‰ ë¹„ìš© ê³„ì‚° (ì¥ë‹¹ 50ì›)
      const issueCost = parseInt(quantity) * 50;
      
      // ê²°ì œ í™•ì¸
      const confirmPayment = confirm(`ğŸ’³ ì¿ í° ë°œê¸‰ ë¹„ìš©\n\nìˆ˜ëŸ‰: ${quantity}ì¥\në‹¨ê°€: â‚©50/ì¥\nì´ ë¹„ìš©: â‚©${issueCost.toLocaleString()}\n\nâš ï¸ ì£¼ì˜ì‚¬í•­:\nâ€¢ ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê²Œì„ì— ë°°í¬ë©ë‹ˆë‹¤\nâ€¢ ìŠ¹ì¸ê¹Œì§€ 1~2ì‹œê°„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n\nê²°ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
      
      if (!confirmPayment) {
        return;
      }
      
      // CTT coupons í…Œì´ë¸” êµ¬ì¡°ë¡œ ìƒì„±
      const newCoupon = {
        id: 'coupon-' + Date.now(),
        store_id: 'store-001',
        coupon_name: title,
        title: title,
        description: description,
        coupon_code: 'COUPON_' + Date.now(),
        coupon_type: discountType,
        discount_type: discountType,
        discount_value: parseInt(discountValue),
        min_purchase_amount: 0,
        max_discount: discountType === 'percentage' ? 50000 : parseInt(discountValue),
        latitude: 37.5665,
        longitude: 126.9780,
        activation_radius: parseInt(radius),
        rarity: rarity,
        drop_rate: rarity === 'common' ? 0.7 : rarity === 'rare' ? 0.2 : rarity === 'epic' ? 0.1 : rarity === 'legendary' ? 0.05 : 0.01,
        total_coupons: parseInt(quantity),
        total_quantity: parseInt(quantity),
        remaining_coupons: parseInt(quantity),
        issued_count: 0,
        used_count: 0,
        per_user: 1,
        usage_limit_per_user: 1,
        valid_from: new Date().toISOString(),
        valid_till: new Date(expiry).toISOString(),
        is_stackable: false,
        coupon_image: rarity === 'legendary' ? 'ğŸ’' : rarity === 'epic' ? 'ğŸ' : rarity === 'rare' ? 'ğŸ«' : 'ğŸ·ï¸',
        status: 'pending', // ìŠ¹ì¸ ëŒ€ê¸°
        is_active: false, // ìŠ¹ì¸ ì „ê¹Œì§€ ë¹„í™œì„±
        is_deleted: false,
        business_name: 'ì•„ë¯¸ í•œì •ì‹',
        issue_cost: issueCost, // ë°œê¸‰ ë¹„ìš©
        issued_by: currentUser.id,
        created_at: new Date().toISOString()
      };
      
      // ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ì— ì¶”ê°€
      pendingCoupons.push(newCoupon);
      
      // ì •ì‚° ê¸°ë¡
      console.log('ğŸ’° ì¿ í° ë°œê¸‰ ì •ì‚°:', {
        coupon_id: newCoupon.id,
        quantity: quantity,
        cost_per_coupon: 50,
        total_cost: issueCost,
        business_id: 'store-001',
        status: 'pending_approval',
        timestamp: new Date().toISOString()
      });
      
      alert(`ğŸ“ ì¿ í° ë°œê¸‰ ì‹ ì²­ ì™„ë£Œ!\n\n${title}\ní• ì¸: ${discountType === 'percentage' ? discountValue + '%' : 'â‚©' + discountValue}\nìˆ˜ëŸ‰: ${quantity}ê°œ\në¹„ìš©: â‚©${issueCost.toLocaleString()}\n\nâ³ ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ì¤‘...\nìŠ¹ì¸ í›„ ê²Œì„ì— ìë™ ë°°í¬ë©ë‹ˆë‹¤!`);
      
      hideCouponIssueForm();
      loadBusinessStats();
      
      // í¼ ì´ˆê¸°í™”
      document.getElementById('coupon-title').value = '';
      document.getElementById('coupon-discount-value').value = '';
      document.getElementById('coupon-quantity').value = '';
      document.getElementById('coupon-description').value = '';
    }
    
    async function loadBusinessStats() {
      document.getElementById('total-issued').textContent = '127';
      document.getElementById('total-used').textContent = '89';
      document.getElementById('total-revenue').textContent = 'â‚©2,340,000';
      
      const mockBusinessCoupons = [
        { id: '1', title: '20% í• ì¸ ì¿ í°', issued: 50, used: 38 },
        { id: '2', title: '5000ì› í• ì¸', issued: 77, used: 51 }
      ];
      
      document.getElementById('business-coupon-list').innerHTML = mockBusinessCoupons.map(c => `
        <div class="border-b border-gray-700 py-3">
          <h4 class="font-bold">${c.title}</h4>
          <p class="text-sm text-gray-400">ë°œê¸‰: ${c.issued}ê°œ | ì‚¬ìš©: ${c.used}ê°œ</p>
        </div>
      `).join('');
    }
    
    // ìŠ¤í† ì–´ ë©”ë‰´
    function loadStoreMenu() {
      loadAvailableCoupons();
      
      const menuContainer = document.getElementById('menu-list');
      menuContainer.innerHTML = MENU_ITEMS.map(item => `
        <div class="card glow-border">
          <div class="flex items-center gap-4">
            <div class="text-5xl">${item.image}</div>
            <div class="flex-1">
              <h4 class="text-xl font-bold mb-1">${item.name}</h4>
              <p class="text-gray-400 text-sm mb-2">${item.category}</p>
              <p class="text-2xl font-bold text-cyan-400">â‚©${item.price.toLocaleString()}</p>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="changeQuantity('${item.id}', -1)" class="w-10 h-10 bg-gray-700 rounded">-</button>
              <span id="qty-${item.id}" class="w-8 text-center">0</span>
              <button onclick="changeQuantity('${item.id}', 1)" class="w-10 h-10 bg-purple-600 rounded">+</button>
            </div>
          </div>
        </div>
      `).join('');
      
      updateCart();
    }
    
    function loadAvailableCoupons() {
      const container = document.getElementById('available-coupons-list');
      
      // â­ ì•„ë¯¸ í•œì •ì‹ í¬í•¨ ëª¨ë“  ë§¤ì¥ ì¿ í° ì‚¬ìš© ê°€ëŠ¥
      const availableCoupons = allCoupons.filter(c => 
        !c.is_used && (c.business_name === 'ì•„ë¯¸ í•œì •ì‹' || c.business_name === 'ê²Œì„ ë³´ìƒ' || c.business_name === 'ì•„ë¯¸ ë‹¤ë°©' || c.id.startsWith('game-coupon'))
      );
      
      if (availableCoupons.length === 0) {
        container.innerHTML = '<p class="text-gray-400">ì‚¬ìš© ê°€ëŠ¥í•œ ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤. ğŸ® ê²Œì„ì—ì„œ ì¿ í°ì„ ëª¨ì•„ë³´ì„¸ìš”!</p>';
        return;
      }
      
      container.innerHTML = availableCoupons.map(coupon => `
        <div onclick="selectCouponForStore('${coupon.id}')" 
             id="store-coupon-${coupon.id}"
             class="coupon-card ${coupon.rarity} mb-2 cursor-pointer">
          <div class="flex items-center justify-between">
            <div>
              <span class="rarity-badge ${coupon.rarity}">${coupon.rarity.toUpperCase()}</span>
              <span class="font-bold">${coupon.title}</span>
            </div>
            <div class="text-cyan-400 font-bold">
              ${coupon.discount_type === 'percentage' ? coupon.discount_value + '%' : 'â‚©' + coupon.discount_value.toLocaleString()}
            </div>
          </div>
        </div>
      `).join('');
    }
    
    function selectCouponForStore(couponId) {
      document.querySelectorAll('[id^="store-coupon-"]').forEach(el => {
        el.style.border = '';
      });
      
      const coupon = allCoupons.find(c => c.id === couponId);
      if (selectedCouponForStore && selectedCouponForStore.id === couponId) {
        selectedCouponForStore = null;
      } else {
        selectedCouponForStore = coupon;
        document.getElementById(`store-coupon-${couponId}`).style.border = '2px solid #22d3ee';
      }
      
      updateCart();
    }
    
    function changeQuantity(itemId, delta) {
      const item = MENU_ITEMS.find(m => m.id === itemId);
      if (!item) return;
      
      const cartItem = cart.find(c => c.id === itemId);
      
      if (cartItem) {
        cartItem.quantity += delta;
        if (cartItem.quantity <= 0) {
          cart = cart.filter(c => c.id !== itemId);
        }
      } else if (delta > 0) {
        cart.push({ ...item, quantity: 1 });
      }
      
      document.getElementById(`qty-${itemId}`).textContent = 
        cart.find(c => c.id === itemId)?.quantity || 0;
      
      updateCart();
    }
    
    function setOrderType(type) {
      currentOrderType = type;
      
      ['delivery', 'pickup', 'reservation'].forEach(t => {
        const btn = document.getElementById(`btn-${t}`);
        if (t === type) {
          btn.style.opacity = '1';
          btn.style.transform = 'scale(1.05)';
        } else {
          btn.style.opacity = '0.6';
          btn.style.transform = 'scale(1)';
        }
      });
      
      ['delivery-form', 'pickup-form', 'reservation-form'].forEach(formId => {
        document.getElementById(formId).style.display = 'none';
      });
      document.getElementById(`${type}-form`).style.display = 'block';
      
      updateCart();
    }
    
    function updateCart() {
      const summaryContainer = document.getElementById('cart-summary');
      
      if (cart.length === 0) {
        summaryContainer.innerHTML = '<p class="text-gray-400">ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>';
        document.getElementById('subtotal').textContent = 'â‚©0';
        document.getElementById('discount').textContent = '-â‚©0';
        document.getElementById('total').textContent = 'â‚©0';
        return;
      }
      
      summaryContainer.innerHTML = cart.map(item => `
        <div class="flex justify-between mb-2">
          <span>${item.name} x ${item.quantity}</span>
          <span>â‚©${(item.price * item.quantity).toLocaleString()}</span>
        </div>
      `).join('');
      
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      let discount = 0;
      
      if (selectedCouponForStore) {
        if (selectedCouponForStore.discount_type === 'percentage') {
          discount = subtotal * (selectedCouponForStore.discount_value / 100);
        } else if (selectedCouponForStore.discount_type === 'fixed') {
          discount = selectedCouponForStore.discount_value;
        }
      }
      
      const deliveryFee = currentOrderType === 'delivery' ? 3000 : 0;
      const total = subtotal - discount + deliveryFee;
      
      document.getElementById('subtotal').textContent = `â‚©${subtotal.toLocaleString()}`;
      document.getElementById('discount').textContent = `-â‚©${discount.toLocaleString()}`;
      document.getElementById('delivery-fee').textContent = `â‚©${deliveryFee.toLocaleString()}`;
      document.getElementById('total').textContent = `â‚©${total.toLocaleString()}`;
    }
    
    async function checkout() {
      if (!currentUser) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!');
        showPage('login');
        return;
      }
      
      if (cart.length === 0) {
        alert('ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
        return;
      }
      
      if (!currentOrderType) {
        alert('ì£¼ë¬¸ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
        return;
      }
      
      // ğŸ’³ ê²°ì œ ìˆ˜ë‹¨ ê°€ì ¸ì˜¤ê¸°
      const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value || 'card';
      const paymentLabels = {
        'card': 'ğŸ’³ ì¹´ë“œ',
        'cash': 'ğŸ’µ í˜„ê¸ˆ',
        'transfer': 'ğŸ¦ ê³„ì¢Œì´ì²´',
        'kakao': 'ğŸŸ¡ ì¹´ì¹´ì˜¤í˜ì´'
      };
      
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const discount = selectedCouponForStore ? calculateDiscount() : 0;
      const deliveryFee = currentOrderType === 'delivery' ? 3000 : 0;
      const total = subtotal - discount + deliveryFee;
      
      const confirmMessage = `
ì£¼ë¬¸ í™•ì¸
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${cart.map(item => `${item.name} x ${item.quantity}`).join('\n')}

ì£¼ë¬¸ê¸ˆì•¡: â‚©${subtotal.toLocaleString()}
í• ì¸: -â‚©${discount.toLocaleString()}
ë°°ë‹¬ë£Œ: â‚©${deliveryFee.toLocaleString()}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì´ ê²°ì œê¸ˆì•¡: â‚©${total.toLocaleString()}

ê²°ì œ ìˆ˜ë‹¨: ${paymentLabels[paymentMethod]}

ê²°ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
      `;
      
      if (!confirm(confirmMessage)) {
        return;
      }
      
      // CTT orders í…Œì´ë¸” êµ¬ì¡°
      const orderData = {
        id: 'order-' + Date.now(),
        user_id: currentUser.id || 'user-001',
        store_id: currentStoreId || 'store-001',
        order_number: 'ORD' + Date.now(),
        order_type: currentOrderType,
        payment_method: paymentMethod, // ğŸ’³ ê²°ì œ ìˆ˜ë‹¨ ì¶”ê°€
        
        items: cart.map(item => ({
          product_id: item.id,
          product_name: item.name,
          quantity: item.quantity,
          unit_price: item.price
        })),
        
        sub_total: subtotal,
        subtotal: subtotal,
        delivery_fee: deliveryFee,
        coupon_discount: discount,
        discount_amount: discount,
        total: total,
        total_amount: total,
        
        payment_status: 'paid',
        status: 'confirmed',
        created_at: new Date().toISOString()
      };
      
      console.log('ğŸ“¦ ì£¼ë¬¸ ë°ì´í„°:', orderData);
      
      // ğŸ”Š ì ì£¼ì—ê²Œ ì£¼ë¬¸ ì•Œë¦¼ (ì‹œë®¬ë ˆì´ì…˜)
      playOrderNotificationSound();
      
      // ì£¼ë¬¸ ëª©ë¡ì— ì¶”ê°€ (localStorage)
      const orders = JSON.parse(localStorage.getItem('storeOrders') || '[]');
      orders.unshift(orderData);
      localStorage.setItem('storeOrders', JSON.stringify(orders));
      
      // ì¿ í° ì‚¬ìš© ì²˜ë¦¬
      if (selectedCouponForStore) {
        selectedCouponForStore.is_used = true;
        selectedCouponForStore.used_at = new Date().toISOString();
        
        // â­ allCouponsì—ì„œë„ ì‚¬ìš© ì²˜ë¦¬
        const couponIdx = allCoupons.findIndex(c => c.id === selectedCouponForStore.id);
        if (couponIdx >= 0) {
          allCoupons[couponIdx].is_used = true;
          allCoupons[couponIdx].used_at = new Date().toISOString();
        }
        
        // ğŸ“¦ localStorage ì—…ë°ì´íŠ¸ (í†µì¼ëœ í‚¤: allCoupons)
        localStorage.setItem('allCoupons', JSON.stringify(allCoupons));
        
        // â­ ë ˆê±°ì‹œ airctt_couponsë„ í˜¸í™˜ì„± ìœ„í•´ ì—…ë°ì´íŠ¸
        if (selectedCouponForStore.originalId) {
          const gameCoupons = JSON.parse(localStorage.getItem('airctt_coupons') || '[]');
          const idx = gameCoupons.findIndex(c => c.id === selectedCouponForStore.originalId);
          if (idx >= 0) {
            gameCoupons[idx].used = true;
            gameCoupons[idx].usedDate = new Date().toLocaleDateString('ko-KR');
            localStorage.setItem('airctt_coupons', JSON.stringify(gameCoupons));
          }
        }
        
        console.log('ğŸ« ì¿ í° ì‚¬ìš© ì™„ë£Œ:', selectedCouponForStore.title);
      }
      
      alert('âœ… ì£¼ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nê°ì‚¬í•©ë‹ˆë‹¤! ğŸ‰\n\n(ì ì£¼ì—ê²Œ ì£¼ë¬¸ ì•Œë¦¼ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤)');
      
      cart = [];
      selectedCouponForStore = null;
      currentOrderType = null;
      
      showPage('home');
    }
    
    // ğŸ”Š ì£¼ë¬¸ ì•Œë¦¼ ì‚¬ìš´ë“œ
    let orderNotificationAudio = null;
    
    function playOrderNotificationSound() {
      if (!orderNotificationAudio) {
        // ëµë™~ ì°¨ì„ë²¨ ì‚¬ìš´ë“œ (Base64 ì¸ì½”ë”©)
        orderNotificationAudio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdH2Onp6WjH13b3R+iJafoJqPgXRqZWx4hpKcoJuQgHJmYWdweoeVn6GZjH5wZGFmbHmIl6Ccl4t8b2NfZGx5iJijop6Qf29gW19qeIqZpKOfjn1tYF1hanuMm6WjoJB/bmBeYGl7jp2mpKCOf2xfXGBpfJCgp6ahkIBtYF5hanySoamooZJ/bGBdYWl8k6OrqaORgGxgXWBpfJOjq6qikYBsYF1ganySoqqqoZGAbWBdYGl8kqKqqqGRgG1gXmFpfJKiqqmgkX9sX11gaXuSoqqpoJF/bF9dYGl7kaGpqKCRf2xfXWBoe5GhqKefkH9sX11faHuRoainn49/bF9dX2h7kaCnp5+Pf2xfXV9oe5CgpqaejX5rXlxeZ3qQn6WlnYx9al1bXWZ5j56kpJyLfGlcWlxld4+dpKObin1oW1lbZHaPnKOimol8Z1pYWmNziZqhn5eGemZYV1hhcoiYn56Vg3hkVlRYX2+GlZ2ckYF1YlRSVV1shZOam5B/c19RUFRaaoKRmJmNfHBdTk5SWGeBj5aXi3ltWk1LT1Vle42TlYh2aVZKSU1SYXmLkJOEdmZUSkdLUF94iI6RgXJiUEdESk5bd4WLjn5wX0tEQkdMV3OBiIp7bVtIQj9ES1Rve4WHd2lXRT49QUdQaniBhHVlUkE7OT5DSmRyfXxyXUo8NjU6P0ddbHV6bl5KPTMwNTpCU2VsdGteSTswLC0yOUJTYmpuX0s7MCgqLTQ+TVljZ1xIPi4oJiktNkFPW2JZRDssJiMmKjM+SlZdVUE4Kh8fIicuN0RNVFI/NScbGh4iKzI7RE1MQDQoGxkaHiUuN0FJSD4yJhkXGR0lLTZARkQ7LyMYFRgcIis0PENBOCwiGBQWGSAqMjpAPjUqHxcTFRkfKDE5PTowJRwVERMXHigwNzo1LCIaExETFx4nLzY4MikeGBIQExccJi41NzAlHBcQDxIXHCUtNDUvIxsVDw8SGRwlLDQzLCEZExAPEhgcJCszMislHBUPDhEWGiMqMTAoIhoTDg4RFRoiKi8wJiAYEg4OEBQZICgsMCYfFxEODRATFx8mKy0kHhYRDQwPExccIygqJB0WEA0MDxIWGiElJiEaFA8MDBATFRYWHR8fGhUQDA0KDA8SFRYXGR0fHBkTDgoJCgsNEBQYHB0cGxkYFBIRDw0LCQoLDREUFhkZGBcXFRUUEhAQDg4NDAsKCwwODxASExUXFxcXFhYVFRQTExIREA8PDg0NCwsLCgoKCwsLDA0ODw==');
      }
      
      try {
        orderNotificationAudio.currentTime = 0;
        orderNotificationAudio.play().catch(e => console.log('ì£¼ë¬¸ ì•Œë¦¼ìŒ ì¬ìƒ ì‹¤íŒ¨:', e));
        console.log('ğŸ”” ì ì£¼ì—ê²Œ ì£¼ë¬¸ ì•Œë¦¼ ì „ì†¡!');
      } catch (e) {
        console.log('ì•Œë¦¼ìŒ ì˜¤ë¥˜:', e);
      }
    }
    
    function calculateDiscount() {
      if (!selectedCouponForStore) return 0;
      
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      if (selectedCouponForStore.discount_type === 'percentage') {
        return subtotal * (selectedCouponForStore.discount_value / 100);
      } else if (selectedCouponForStore.discount_type === 'fixed') {
        return selectedCouponForStore.discount_value;
      }
      
      return 0;
    }
    
    // 3D ë°°ê²½ (DOM ë¡œë“œ í›„ ì‹¤í–‰)
    let scene, camera, renderer, particles;
    
    function init3DBackground() {
      try {
        const canvas = document.getElementById('canvas-3d');
        if (!canvas) {
          console.log('canvas-3d ì—†ìŒ, 3D ë°°ê²½ ìŠ¤í‚µ');
          return;
        }
        
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        camera.position.z = 50;
        
        const particleCount = 5000;
        const positions = new Float32Array(particleCount * 3);
        const colors = new Float32Array(particleCount * 3);
        
        for (let i = 0; i < particleCount; i++) {
          positions[i * 3] = (Math.random() - 0.5) * 200;
          positions[i * 3 + 1] = (Math.random() - 0.5) * 200;
          positions[i * 3 + 2] = (Math.random() - 0.5) * 200;
          
          const color = Math.random() < 0.5 ? new THREE.Color(0xa855f7) : new THREE.Color(0x22d3ee);
          colors[i * 3] = color.r;
          colors[i * 3 + 1] = color.g;
          colors[i * 3 + 2] = color.b;
        }
        
        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
        
        const material = new THREE.PointsMaterial({
          size: 0.5,
          vertexColors: true,
          transparent: true,
          opacity: 0.8,
          blending: THREE.AdditiveBlending
        });
        
        particles = new THREE.Points(geometry, material);
        scene.add(particles);
        
        animate3D();
        console.log('3D ë°°ê²½ ì´ˆê¸°í™” ì™„ë£Œ');
      } catch (error) {
        console.error('3D ë°°ê²½ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
      }
    }
    
    function animate3D() {
      requestAnimationFrame(animate3D);
      if (particles && renderer && scene && camera) {
        particles.rotation.x += 0.0002;
        particles.rotation.y += 0.0003;
        renderer.render(scene, camera);
      }
    }
    
    // DOM ë¡œë“œ ì™„ë£Œ í›„ 3D ë°°ê²½ ì‹œì‘
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init3DBackground);
    } else {
      init3DBackground();
    }
    
    // 3D ê²Œì„
    let gameScene, gameCamera, gameRenderer, coupons = [];
    let score = 0, timeLeft = 60, caughtCount = 0;
    let gameRunning = false;
    let animationId = null;
    let timerInterval = null;
    let caughtCoupons = [];
    
    const rarities = {
      common: { color: 0xcccccc, score: 10, name: 'ì¼ë°˜ ì¿ í°' },
      rare: { color: 0x4a9eff, score: 50, name: 'ë ˆì–´ ì¿ í°' },
      epic: { color: 0xa855f7, score: 200, name: 'ì—í”½ ì¿ í°' },
      legendary: { color: 0xfbbf24, score: 1000, name: 'ì „ì„¤ ì¿ í°' },
      mythic: { color: 0xff0000, score: 5000, name: 'ì‹ í™” ì¿ í°' }
    };
    
    function startGame() {
      if (!currentUser) {
        // ë¡œê·¸ì¸ ëª¨ë‹¬ í‘œì‹œ
        if (confirm('ê²Œì„ì„ í”Œë ˆì´í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          showPage('login');
        }
        return;
      }
      
      document.getElementById('game-container').classList.add('active');
      
      score = 0;
      timeLeft = 999999; // â­ ë¬´í•œ ì‹œê°„
      caughtCount = 0;
      caughtCoupons = [];
      gameRunning = true;
      
      updateHUD();
      initGame();
      
      // â­ ì‹œê°„ ì œí•œ ì—†ì´ ê³„ì† í”Œë ˆì´ (íƒ€ì´ë¨¸ í‘œì‹œë§Œ)
      timerInterval = setInterval(() => {
        // ì‹œê°„ì€ íë¥´ì§€ë§Œ ê²Œì„ ì¢…ë£Œ ì•ˆí•¨
        updateHUD();
      }, 1000);
    }
    
    function initGame() {
      const canvas = document.getElementById('game-canvas');
      
      gameScene = new THREE.Scene();
      gameScene.background = new THREE.Color(0x0a0a0a);
      
      gameCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      gameCamera.position.z = 30;
      
      gameRenderer = new THREE.WebGLRenderer({ canvas, antialias: true });
      gameRenderer.setSize(window.innerWidth, window.innerHeight);
      gameRenderer.setPixelRatio(window.devicePixelRatio);
      
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      gameScene.add(ambientLight);
      
      const pointLight = new THREE.PointLight(0x22d3ee, 1, 100);
      pointLight.position.set(10, 10, 10);
      gameScene.add(pointLight);
      
      createCoupons();
      
      canvas.addEventListener('click', onCanvasClick);
      canvas.addEventListener('touchstart', onCanvasClick);
      
      animateGame();
    }
    
    function createCoupons() {
      coupons = [];
      
      // â­ ìŠ¹ì¸ëœ ë§¤ì¥ ì¿ í°ë§Œ ê²Œì„ì— ë°°í¬
      const approvedCoupons = gameIssuedCoupons.filter(c => c.status === 'approved' && c.remaining > 0);
      
      approvedCoupons.forEach((issuedCoupon, index) => {
        // ì¿ í° í‹°ì¼“ ëª¨ì–‘ (ì§ì‚¬ê°í˜• + ë‘¥ê·¼ ëª¨ì„œë¦¬)
        const ticketShape = new THREE.Shape();
        const width = 6;
        const height = 3;
        const radius = 0.3;
        
        ticketShape.moveTo(-width/2 + radius, -height/2);
        ticketShape.lineTo(width/2 - radius, -height/2);
        ticketShape.quadraticCurveTo(width/2, -height/2, width/2, -height/2 + radius);
        ticketShape.lineTo(width/2, height/2 - radius);
        ticketShape.quadraticCurveTo(width/2, height/2, width/2 - radius, height/2);
        ticketShape.lineTo(-width/2 + radius, height/2);
        ticketShape.quadraticCurveTo(-width/2, height/2, -width/2, height/2 - radius);
        ticketShape.lineTo(-width/2, -height/2 + radius);
        ticketShape.quadraticCurveTo(-width/2, -height/2, -width/2 + radius, -height/2);
        
        const geometry = new THREE.ExtrudeGeometry(ticketShape, {
          depth: 0.3,
          bevelEnabled: true,
          bevelThickness: 0.1,
          bevelSize: 0.1,
          bevelSegments: 2
        });
        
        const rarityColor = rarities[issuedCoupon.rarity].color;
        const material = new THREE.MeshStandardMaterial({
          color: rarityColor,
          emissive: rarityColor,
          emissiveIntensity: 0.4,
          metalness: 0.6,
          roughness: 0.3
        });
        
        const coupon = new THREE.Mesh(geometry, material);
        
        coupon.position.x = (Math.random() - 0.5) * 40;
        coupon.position.y = Math.random() * 40 - 10;
        coupon.position.z = (Math.random() - 0.5) * 20;
        
        coupon.userData = {
          rarity: issuedCoupon.rarity,
          fallSpeed: 0.03 + Math.random() * 0.03,
          active: true,
          issuedCoupon: issuedCoupon,
          isRealCoupon: true // ì‹¤ì œ ë§¤ì¥ ì¿ í° í‘œì‹œ
        };
        
        gameScene.add(coupon);
        coupons.push(coupon);
      });
      
      // ë‚˜ë¨¸ì§€ëŠ” ê¸°ë³¸ ì¿ í°ìœ¼ë¡œ ì±„ìš°ê¸° (ìµœì†Œ 10ê°œ ìœ ì§€)
      const minCoupons = 10;
      for (let i = coupons.length; i < minCoupons; i++) {
        const rand = Math.random();
        let rarity, randomCoupon;
        
        if (rand < 0.70) {
          rarity = 'common';
          randomCoupon = { ...gameIssuedCoupons[3] }; // 10% í• ì¸
        } else if (rand < 0.90) {
          rarity = 'rare';
          randomCoupon = { ...gameIssuedCoupons[2] }; // í˜„ì‹¤ ë ˆìŠ¤í† ë‘
        } else if (rand < 0.97) {
          rarity = 'epic';
          randomCoupon = { ...gameIssuedCoupons[0] }; // ì•„ë¯¸ í•œì •ì‹ 30%
        } else if (rand < 0.995) {
          rarity = 'legendary';
          randomCoupon = { ...gameIssuedCoupons[1] }; // ì•„ë¯¸ ë‹¤ë°© 50%
        } else {
          rarity = 'mythic';
          randomCoupon = { ...gameIssuedCoupons[4] }; // 100% ë¬´ë£Œ!
        }
        
        // í‹°ì¼“ ëª¨ì–‘ ìƒì„±
        const ticketShape = new THREE.Shape();
        const width = 6;
        const height = 3;
        const radius = 0.3;
        
        ticketShape.moveTo(-width/2 + radius, -height/2);
        ticketShape.lineTo(width/2 - radius, -height/2);
        ticketShape.quadraticCurveTo(width/2, -height/2, width/2, -height/2 + radius);
        ticketShape.lineTo(width/2, height/2 - radius);
        ticketShape.quadraticCurveTo(width/2, height/2, width/2 - radius, height/2);
        ticketShape.lineTo(-width/2 + radius, height/2);
        ticketShape.quadraticCurveTo(-width/2, height/2, -width/2, height/2 - radius);
        ticketShape.lineTo(-width/2, -height/2 + radius);
        ticketShape.quadraticCurveTo(-width/2, -height/2, -width/2 + radius, -height/2);
        
        const geometry = new THREE.ExtrudeGeometry(ticketShape, {
          depth: 0.3,
          bevelEnabled: true,
          bevelThickness: 0.1,
          bevelSize: 0.1,
          bevelSegments: 2
        });
        
        const material = new THREE.MeshStandardMaterial({
          color: rarities[rarity].color,
          emissive: rarities[rarity].color,
          emissiveIntensity: 0.4,
          metalness: 0.6,
          roughness: 0.3
        });
        
        const coupon = new THREE.Mesh(geometry, material);
        
        coupon.position.x = (Math.random() - 0.5) * 40;
        coupon.position.y = Math.random() * 40 - 10;
        coupon.position.z = (Math.random() - 0.5) * 20;
        
        coupon.userData = {
          rarity: rarity,
          fallSpeed: 0.03 + Math.random() * 0.03,
          active: true,
          issuedCoupon: randomCoupon,
          isRealCoupon: true
        };
        
        gameScene.add(coupon);
        coupons.push(coupon);
      }
    }
    
    function animateGame() {
      if (!gameRunning) return;
      
      animationId = requestAnimationFrame(animateGame);
      
      coupons.forEach((coupon) => {
        if (coupon.userData.active) {
          coupon.position.y -= coupon.userData.fallSpeed;
          coupon.rotation.x += 0.01;
          coupon.rotation.y += 0.02;
          
          if (coupon.position.y < -20) {
            coupon.position.y = 20;
            coupon.position.x = (Math.random() - 0.5) * 40;
            coupon.position.z = (Math.random() - 0.5) * 20;
          }
        }
      });
      
      gameRenderer.render(gameScene, gameCamera);
    }
    
    function onCanvasClick(event) {
      event.preventDefault();
      
      const canvas = document.getElementById('game-canvas');
      const rect = canvas.getBoundingClientRect();
      
      const x = event.clientX || event.touches[0].clientX;
      const y = event.clientY || event.touches[0].clientY;
      
      const mouse = new THREE.Vector2(
        ((x - rect.left) / rect.width) * 2 - 1,
        -((y - rect.top) / rect.height) * 2 + 1
      );
      
      const raycaster = new THREE.Raycaster();
      raycaster.setFromCamera(mouse, gameCamera);
      
      const intersects = raycaster.intersectObjects(coupons);
      
      if (intersects.length > 0) {
        const hitCoupon = intersects[0].object;
        if (hitCoupon.userData.active) {
          catchCoupon(hitCoupon);
        }
      }
    }
    
    function catchCoupon(coupon) {
      coupon.userData.active = false;
      coupon.visible = false;
      
      const rarity = coupon.userData.rarity;
      const points = rarities[rarity].score;
      
      score += points;
      caughtCount++;
      
      // ì‚¬ì—…ì ë°œê¸‰ ì¿ í°ì¸ ê²½ìš°
      if (coupon.userData.issuedCoupon) {
        // â­ ì”ì—¬ìˆ˜ëŸ‰ ê°ì†Œ
        const issuedCoupon = coupon.userData.issuedCoupon;
        if (issuedCoupon.remaining > 0) {
          issuedCoupon.remaining--;
          
          // gameIssuedCouponsì—ì„œë„ ì—…ë°ì´íŠ¸
          const original = gameIssuedCoupons.find(c => c.id === issuedCoupon.id);
          if (original) {
            original.remaining--;
          }
        }
        
        caughtCoupons.push({
          ...issuedCoupon,
          score: points
        });
      } else {
        caughtCoupons.push({
          rarity: rarity,
          name: rarities[rarity].name,
          score: points
        });
      }
      
      updateHUD();
      
      if (navigator.vibrate) {
        navigator.vibrate(100);
      }
    }
    
    function updateHUD() {
      document.getElementById('score').textContent = score.toLocaleString();
      document.getElementById('caught').textContent = caughtCount;
    }
    
    function endGame() {
      gameRunning = false;
      clearInterval(timerInterval);
      
      if (animationId) {
        cancelAnimationFrame(animationId);
      }
      
      document.getElementById('game-container').classList.remove('active');
      
      // ğŸ¯ ì¤‘ë³µ ë°©ì§€: ë§¤ì¥ID + í• ì¸íƒ€ì… + í• ì¸ê°’ ê¸°ì¤€
      let newCouponsAdded = 0;
      let duplicatesUpdated = 0;
      
      caughtCoupons.forEach((c, i) => {
        const storeId = c.store_id || 'game';
        const discountType = c.discount_type || 'percentage';
        const discountValue = c.discount_value || (c.score / 100);
        
        // ì¤‘ë³µ í‚¤ ìƒì„±: store_id|discount_type|discount_value
        const uniqueKey = `${storeId}|${discountType}|${discountValue}`;
        
        // ê¸°ì¡´ ì¿ í° ì¤‘ ê°™ì€ í‚¤ê°€ ìˆëŠ”ì§€ í™•ì¸
        const existingIndex = allCoupons.findIndex(coupon => {
          const existingKey = `${coupon.store_id || 'game'}|${coupon.discount_type || 'percentage'}|${coupon.discount_value}`;
          return existingKey === uniqueKey && !coupon.is_used;
        });
        
        if (existingIndex !== -1) {
          // ğŸ”„ ì¤‘ë³µ: ë‚ ì§œ/ì‹œê°„ë§Œ ì—…ë°ì´íŠ¸
          allCoupons[existingIndex].acquired_at = new Date().toISOString();
          allCoupons[existingIndex].updated_at = new Date().toISOString();
          duplicatesUpdated++;
        } else {
          // âœ… ìƒˆ ì¿ í° ì¶”ê°€
          const now = new Date().toISOString();
          if (c.title && (c.business_name || c.store_name)) {
            allCoupons.push({
              id: 'caught-' + Date.now() + '-' + i,
              title: c.title,
              rarity: c.rarity,
              discount_value: discountValue,
              discount_type: discountType,
              business_name: c.business_name || c.store_name,
              store_name: c.store_name,
              store_id: c.store_id,
              store_emoji: c.store_emoji || 'ğŸª',
              image_url: c.image_url,
              is_used: false,
              acquired_at: now,
              updated_at: now
            });
          } else {
            allCoupons.push({
              id: 'game-' + Date.now() + '-' + i,
              title: c.name,
              rarity: c.rarity,
              discount_value: discountValue,
              discount_type: 'percentage',
              business_name: 'ê²Œì„ ë³´ìƒ',
              store_id: 'game',
              store_emoji: 'ğŸ®',
              is_used: false,
              acquired_at: now,
              updated_at: now
            });
          }
          newCouponsAdded++;
        }
      });
      
      // ê²°ê³¼ ì•Œë¦¼
      let resultMsg = `ğŸ‰ ê²Œì„ ì¢…ë£Œ!\n\nìµœì¢… ì ìˆ˜: ${score.toLocaleString()}ì \níšë“ ì¿ í°: ${caughtCount}ê°œ`;
      if (newCouponsAdded > 0) resultMsg += `\n\nâœ… ìƒˆ ì¿ í° ${newCouponsAdded}ì¥ ì¶”ê°€!`;
      if (duplicatesUpdated > 0) resultMsg += `\nğŸ”„ ê¸°ì¡´ ì¿ í° ${duplicatesUpdated}ì¥ ê°±ì‹  (ì¤‘ë³µ ë°©ì§€)`;
      resultMsg += `\n\nì¿ í° ì§€ê°‘ì—ì„œ í™•ì¸í•˜ì„¸ìš”!`;
      
      alert(resultMsg);
      
      // localStorage ì €ì¥
      localStorage.setItem('allCoupons', JSON.stringify(allCoupons));
    }
    
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      
      if (gameCamera && gameRenderer) {
        gameCamera.aspect = window.innerWidth / window.innerHeight;
        gameCamera.updateProjectionMatrix();
        gameRenderer.setSize(window.innerWidth, window.innerHeight);
      }
    });
    
    // ì´ˆê¸°í™”
    updateUserUI();
    if (authToken && !currentUser) {
      currentUser = { name: 'ì‚¬ìš©ì' };
      updateUserUI();
    }
    
    // í† ë¼ ì• ë‹ˆë©”ì´ì…˜
    setInterval(() => {
      const rabbit = document.getElementById('rabbit-emoji');
      rabbit.classList.add('rabbit-animation');
      setTimeout(() => rabbit.classList.remove('rabbit-animation'), 600);
    }, 10000);
    
    // ===== ì†Œì…œ ë¡œê·¸ì¸ =====
    
    // ì¹´ì¹´ì˜¤ ì´ˆê¸°í™”
    if (window.Kakao && !window.Kakao.isInitialized()) {
      Kakao.init('YOUR_KAKAO_JAVASCRIPT_KEY'); // ì‹¤ì œ í‚¤ë¡œ êµì²´
    }
    
    // ë„¤ì´ë²„ ì´ˆê¸°í™”
    const naverLogin = new naver.LoginWithNaverId({
      clientId: "YOUR_NAVER_CLIENT_ID", // ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ IDë¡œ êµì²´
      callbackUrl: window.location.origin + "/callback",
      isPopup: false,
      loginButton: { color: "green", type: 3, height: 50 }
    });
    
    // êµ¬ê¸€ ë¡œê·¸ì¸
    async function loginWithGoogle() {
      try {
        google.accounts.id.initialize({
          client_id: 'YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com',
          callback: handleGoogleCallback
        });
        
        google.accounts.id.prompt();
        
      } catch (error) {
        console.error('Google login error:', error);
        // ëª©ì—…
        handleSocialLoginSuccess({
          provider: 'google',
          email: 'user@gmail.com',
          name: 'êµ¬ê¸€ì‚¬ìš©ì',
          picture: 'https://via.placeholder.com/32'
        });
      }
    }
    
    async function handleGoogleCallback(response) {
      try {
        const result = await fetch(`${API_URL}/auth/google`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ token: response.credential })
        });
        
        const data = await result.json();
        handleSocialLoginSuccess(data);
      } catch (error) {
        console.error('Google callback error:', error);
        handleSocialLoginSuccess({
          provider: 'google',
          email: 'user@gmail.com',
          name: 'êµ¬ê¸€ì‚¬ìš©ì'
        });
      }
    }
    
    // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
    async function loginWithKakao() {
      try {
        Kakao.Auth.login({
          success: async function(authObj) {
            Kakao.API.request({
              url: '/v2/user/me',
              success: async function(response) {
                handleSocialLoginSuccess({
                  provider: 'kakao',
                  email: response.kakao_account?.email || 'user@kakao.com',
                  name: response.properties?.nickname || 'ì¹´ì¹´ì˜¤ì‚¬ìš©ì',
                  picture: response.properties?.profile_image
                });
              },
              fail: function(error) {
                console.error('Kakao user info error:', error);
              }
            });
          },
          fail: function(error) {
            console.error('Kakao login error:', error);
            handleSocialLoginSuccess({
              provider: 'kakao',
              email: 'user@kakao.com',
              name: 'ì¹´ì¹´ì˜¤ì‚¬ìš©ì'
            });
          }
        });
      } catch (error) {
        console.error('Kakao init error:', error);
        handleSocialLoginSuccess({
          provider: 'kakao',
          email: 'user@kakao.com',
          name: 'ì¹´ì¹´ì˜¤ì‚¬ìš©ì'
        });
      }
    }
    
    // ë„¤ì´ë²„ ë¡œê·¸ì¸
    async function loginWithNaver() {
      try {
        const naverLoginBtn = document.getElementById('naverIdLogin')?.firstChild;
        if (naverLoginBtn) {
          naverLoginBtn.click();
        } else {
          handleSocialLoginSuccess({
            provider: 'naver',
            email: 'user@naver.com',
            name: 'ë„¤ì´ë²„ì‚¬ìš©ì'
          });
        }
      } catch (error) {
        console.error('Naver login error:', error);
        handleSocialLoginSuccess({
          provider: 'naver',
          email: 'user@naver.com',
          name: 'ë„¤ì´ë²„ì‚¬ìš©ì'
        });
      }
    }
    
    // ì†Œì…œ ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
    function handleSocialLoginSuccess(data) {
      currentUser = {
        email: data.email,
        name: data.name,
        picture: data.picture,
        provider: data.provider
      };
      
      if (data.token) {
        authToken = data.token;
        localStorage.setItem('token', authToken);
      }
      
      updateUserUI();
      alert(`${data.provider.toUpperCase()} ë¡œê·¸ì¸ ì„±ê³µ!\ní™˜ì˜í•©ë‹ˆë‹¤, ${data.name}ë‹˜!`);
      showPage('home');
    }
    
    // ===== ğŸª ë§¤ì¥ ëŒ€ì‹œë³´ë“œ =====
    function showStoreDashboard(tab) {
      // ëª¨ë“  ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸°
      ['overview', 'reservation', 'sales', 'purchase', 'revenue'].forEach(t => {
        const content = document.getElementById('dash-content-' + t);
        const btn = document.getElementById('dash-tab-' + t);
        if (content) content.style.display = 'none';
        if (btn) btn.className = 'px-4 py-2 bg-gray-700 rounded font-bold';
      });
      
      // ì„ íƒëœ íƒ­ ë³´ì´ê¸°
      const selectedContent = document.getElementById('dash-content-' + tab);
      const selectedBtn = document.getElementById('dash-tab-' + tab);
      if (selectedContent) selectedContent.style.display = 'block';
      if (selectedBtn) selectedBtn.className = 'px-4 py-2 bg-cyan-500 rounded font-bold';
    }
    
    // ===== ğŸ“¥ ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ =====
    function downloadReport(type) {
      const reportNames = {
        'coupons': 'ì¿ í°_ë°œê¸‰_í˜„í™©',
        'used': 'ì¿ í°_ì‚¬ìš©_ë‚´ì—­',
        'today': 'ì˜¤ëŠ˜_ë§¤ì¶œ_ë¦¬í¬íŠ¸',
        'total': 'ì „ì²´_ë§¤ì¶œ_ë¦¬í¬íŠ¸',
        'reservation': 'ì˜ˆì•½_í˜„í™©',
        'sales': 'íŒë§¤_ë‚´ì—­',
        'purchase': 'ë§¤ì…_ë‚´ì—­',
        'revenue': 'ë§¤ì¶œ_ë¶„ì„'
      };
      
      const filename = `${reportNames[type] || 'ë¦¬í¬íŠ¸'}_${new Date().toLocaleDateString('ko-KR')}.csv`;
      
      // CSV ë°ì´í„° ìƒì„± (ì˜ˆì‹œ)
      let csvContent = 'data:text/csv;charset=utf-8,';
      csvContent += 'ë‚ ì§œ,í•­ëª©,ê¸ˆì•¡,ë¹„ê³ \n';
      csvContent += `${new Date().toLocaleDateString('ko-KR')},ìƒ˜í”Œë°ì´í„°,100000,í…ŒìŠ¤íŠ¸\n`;
      
      const encodedUri = encodeURI(csvContent);
      const link = document.createElement('a');
      link.setAttribute('href', encodedUri);
      link.setAttribute('download', filename);
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert(`ğŸ“¥ ${reportNames[type] || 'ë¦¬í¬íŠ¸'} ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤!`);
    }
    
    // ===== ğŸ° Golden Rabbit CFO =====
    function openGoldenRabbitCFO() {
      document.getElementById('golden-rabbit-cfo').style.display = 'block';
    }
    
    function closeGoldenRabbitCFO() {
      document.getElementById('golden-rabbit-cfo').style.display = 'none';
    }
    
    function askCFO(topic) {
      const questions = {
        'sales': 'ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„í•´ì¤˜',
        'tax': 'ì„¸ë¬´ ì‹ ê³  ë„ì™€ì¤˜',
        'marketing': 'ë§ˆì¼€íŒ… ì¡°ì–¸í•´ì¤˜'
      };
      
      document.getElementById('cfo-input').value = questions[topic] || '';
      sendToCFO();
    }
    
    function sendToCFO() {
      const input = document.getElementById('cfo-input');
      const question = input.value.trim();
      if (!question) return;
      
      const messagesDiv = document.getElementById('cfo-chat-messages');
      
      // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
      messagesDiv.innerHTML += `
        <div class="flex gap-3 mb-4 justify-end">
          <div class="bg-purple-600/50 p-3 rounded-lg max-w-[80%]">
            <p class="text-sm">${question}</p>
          </div>
        </div>
      `;
      
      input.value = '';
      
      // AI ì‘ë‹µ (ì‹œë®¬ë ˆì´ì…˜)
      setTimeout(() => {
        let response = '';
        
        if (question.includes('ë§¤ì¶œ')) {
          response = `ğŸ“Š <b>ì˜¤ëŠ˜ ë§¤ì¶œ ë¶„ì„ ê²°ê³¼</b><br><br>
            â€¢ ì´ ë§¤ì¶œ: â‚©340,000 (ì „ì¼ ëŒ€ë¹„ +12%)<br>
            â€¢ ì£¼ë¬¸ ê±´ìˆ˜: 12ê±´<br>
            â€¢ ê°ë‹¨ê°€: â‚©28,333<br><br>
            ğŸ¯ í”¼í¬ ì‹œê°„ëŒ€: ì˜¤í›„ 12ì‹œ~1ì‹œ (ì ì‹¬)<br>
            ğŸ’¡ ì¶”ì²œ: ì €ë… ì‹œê°„ëŒ€ í”„ë¡œëª¨ì…˜ ê°•í™”í•˜ë©´ ë§¤ì¶œ 20% ìƒìŠ¹ ì˜ˆìƒë©ë‹ˆë‹¤!`;
        } else if (question.includes('ì„¸ë¬´')) {
          response = `ğŸ“‹ <b>ì„¸ë¬´ ì‹ ê³  ì•ˆë‚´</b><br><br>
            â€¢ ë‹¤ìŒ ë¶€ê°€ì„¸ ì‹ ê³ ì¼: 2026ë…„ 1ì›” 25ì¼<br>
            â€¢ ì˜ˆìƒ ë¶€ê°€ì„¸: â‚©234,000<br><br>
            âœ… í•„ìš” ì„œë¥˜:<br>
            1. ë§¤ì…ì„¸ê¸ˆê³„ì‚°ì„œ<br>
            2. ë§¤ì¶œì„¸ê¸ˆê³„ì‚°ì„œ<br>
            3. ì‹ ìš©ì¹´ë“œë§¤ì¶œì „í‘œ<br><br>
            ğŸ’¡ í™ˆíƒìŠ¤ ì „ìì‹ ê³  ì¶”ì²œë“œë ¤ìš”!`;
        } else if (question.includes('ë§ˆì¼€íŒ…')) {
          response = `ğŸ“¢ <b>ë§ˆì¼€íŒ… ì „ëµ ì œì•ˆ</b><br><br>
            ğŸ¯ íƒ€ê²Ÿ: 20-30ëŒ€ ì§ì¥ì¸<br><br>
            âœ¨ ì¶”ì²œ ì „ëµ:<br>
            1. ì ì‹¬ íŠ¹ê°€ ì¿ í° (12-14ì‹œ í•œì •)<br>
            2. ë‹¨ê³¨ ì ë¦½ í”„ë¡œê·¸ë¨ ë„ì…<br>
            3. SNS ë¦¬ë·° ì´ë²¤íŠ¸<br><br>
            ğŸ“ˆ ì˜ˆìƒ íš¨ê³¼: ì‹ ê·œ ê³ ê° 30% ì¦ê°€`;
        } else {
          response = `ë„¤, "${question}"ì— ëŒ€í•´ ë¶„ì„í•´ë“œë¦´ê²Œìš”! ğŸ°<br><br>
            ì‚¬ì¥ë‹˜ ë§¤ì¥ ë°ì´í„°ë¥¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤...<br>
            ìì„¸í•œ ë¶„ì„ì„ ì›í•˜ì‹œë©´ êµ¬ì²´ì ì¸ ì§ˆë¬¸ì„ í•´ì£¼ì„¸ìš”!`;
        }
        
        messagesDiv.innerHTML += `
          <div class="flex gap-3 mb-4">
            <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-sm flex-shrink-0">ğŸ°</div>
            <div class="flex-1 bg-gray-800 p-3 rounded-lg">
              <p class="text-sm">${response}</p>
            </div>
          </div>
        `;
        
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
      }, 1000);
    }
    
    // ===== ğŸ“ íŒŒì¼ ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ =====
    function handleBusinessFileUpload(input) {
      const files = input.files;
      if (!files.length) return;
      
      const preview = document.getElementById('uploaded-files-preview');
      preview.style.display = 'grid';
      preview.innerHTML = '';
      
      Array.from(files).forEach((file, idx) => {
        const isImage = file.type.startsWith('image/');
        const isVideo = file.type.startsWith('video/');
        
        let previewContent = '';
        if (isImage) {
          const url = URL.createObjectURL(file);
          previewContent = `<img src="${url}" alt="${file.name}" class="w-full h-24 object-cover rounded">`;
        } else if (isVideo) {
          previewContent = `<div class="w-full h-24 bg-gray-700 rounded flex items-center justify-center"><span class="text-3xl">ğŸ¬</span></div>`;
        } else {
          previewContent = `<div class="w-full h-24 bg-gray-700 rounded flex items-center justify-center"><span class="text-3xl">ğŸ“„</span></div>`;
        }
        
        preview.innerHTML += `
          <div class="bg-gray-800 p-2 rounded-lg">
            ${previewContent}
            <p class="text-xs text-gray-400 mt-1 truncate">${file.name}</p>
            <button type="button" onclick="removeFile(${idx})" class="text-red-400 text-xs hover:underline">ì‚­ì œ</button>
          </div>
        `;
      });
    }
    
    function removeFile(idx) {
      alert('íŒŒì¼ ì‚­ì œ ê¸°ëŠ¥ì€ ì„œë²„ ì—°ë™ ì‹œ êµ¬í˜„ë©ë‹ˆë‹¤.');
    }
    
    // ===== ğŸ“ í…ìŠ¤íŠ¸ í¸ì§‘ =====
    function formatText(command) {
      const textarea = document.getElementById('business-description');
      const start = textarea.selectionStart;
      const end = textarea.selectionEnd;
      const text = textarea.value;
      const selected = text.substring(start, end);
      
      let formatted = selected;
      if (command === 'bold') formatted = `**${selected}**`;
      else if (command === 'italic') formatted = `_${selected}_`;
      else if (command === 'underline') formatted = `<u>${selected}</u>`;
      
      textarea.value = text.substring(0, start) + formatted + text.substring(end);
      textarea.focus();
    }
    
    function insertEmoji(emoji) {
      const textarea = document.getElementById('business-description');
      const pos = textarea.selectionStart;
      const text = textarea.value;
      textarea.value = text.substring(0, pos) + emoji + text.substring(pos);
      textarea.focus();
    }
    
    // ===== ğŸª ë§¤ì¥ ìƒì„¸ ì´ë™ =====
    function goToStoreDetail(storeId) {
      if (!storeId) {
        alert('ê²Œì„ ë³´ìƒ ì¿ í°ì€ ëª¨ë“  ë§¤ì¥ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
      }
      
      const store = STORES[storeId];
      if (store) {
        alert(`ğŸª ${store.emoji} ${store.name}\n\nğŸ“ ${store.address}\nì—…ì¢…: ${store.category}\n\në§¤ì¥ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!`);
        showPage('store');
      }
    }
    
    // ===== ğŸ—‘ï¸ ê°œë³„ ì¿ í° ì‚­ì œ =====
    function deleteSingleCoupon(couponId) {
      if (!confirm('ì´ ì¿ í°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      
      // allCouponsì—ì„œ ì œê±°
      allCoupons = allCoupons.filter(c => c.id !== couponId);
      
      // localStorageì—ì„œë„ ì œê±°
      let savedCoupons = JSON.parse(localStorage.getItem('airctt_coupons') || '[]');
      savedCoupons = savedCoupons.filter(c => c.id !== couponId && ('game-' + c.id) !== couponId);
      localStorage.setItem('airctt_coupons', JSON.stringify(savedCoupons));
      
      // UI ìƒˆë¡œê³ ì¹¨
      renderCoupons(allCoupons);
      
      alert('ğŸ—‘ï¸ ì¿ í°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    
    // ===== ğŸ“ íŒŒì¼ ê´€ë¦¬ ê¸°ëŠ¥ =====
    let currentEditingFile = null;
    
    const sampleFiles = {
      'ë§¤ì¥ì†Œê°œ.txt': `ğŸš ì•„ë¯¸ í•œì •ì‹

ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123ì— ìœ„ì¹˜í•œ ì •í†µ í•œì •ì‹ ì „ë¬¸ì ì…ë‹ˆë‹¤.

â–  ì˜ì—…ì‹œê°„
- ì ì‹¬: 11:30 - 14:30
- ì €ë…: 17:30 - 21:30

â–  ëŒ€í‘œ ë©”ë‰´
- íŠ¹ì„  í•œì •ì‹ â‚©35,000
- ì™•ê°ˆë¹„íƒ• â‚©18,000
- ë¹„ë¹”ë°¥ ì •ì‹ â‚©15,000

â–  ì˜ˆì•½ ë¬¸ì˜
ğŸ“ 02-1234-5678`,
      'ë©”ë‰´íŒ.xlsx': '[ì—‘ì…€ íŒŒì¼ì…ë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œí•˜ì—¬ í™•ì¸í•˜ì„¸ìš”.]',
      'ë§¤ì¶œë³´ê³ ì„œ.pdf': '[PDF íŒŒì¼ì…ë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œí•˜ì—¬ í™•ì¸í•˜ì„¸ìš”.]'
    };
    
    function openFileEditor(filename) {
      currentEditingFile = filename;
      const content = sampleFiles[filename] || '';
      
      document.getElementById('editor-filename').textContent = 'ğŸ“ ' + filename;
      document.getElementById('file-content').value = content;
      document.getElementById('file-editor').style.display = 'block';
    }
    
    function closeFileEditor() {
      document.getElementById('file-editor').style.display = 'none';
      currentEditingFile = null;
    }
    
    function saveFileContent() {
      if (!currentEditingFile) return;
      
      const content = document.getElementById('file-content').value;
      sampleFiles[currentEditingFile] = content;
      
      alert('ğŸ’¾ íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' + currentEditingFile);
    }
    
    function uploadFile() {
      const input = document.createElement('input');
      input.type = 'file';
      input.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          alert('ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ!\n\níŒŒì¼ëª…: ' + file.name + '\ní¬ê¸°: ' + (file.size / 1024).toFixed(1) + ' KB');
        }
      };
      input.click();
    }
    
    function createDocument() {
      const filename = prompt('ìƒˆ ë¬¸ì„œ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', 'ìƒˆë¬¸ì„œ.txt');
      if (filename) {
        sampleFiles[filename] = '';
        openFileEditor(filename);
        alert('ğŸ“ ìƒˆ ë¬¸ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: ' + filename);
      }
    }
    
    function downloadFile(filename) {
      const content = sampleFiles[filename] || '';
      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
      
      alert('ğŸ“¥ ë‹¤ìš´ë¡œë“œ ì‹œì‘: ' + filename);
    }
    
    function downloadReport(type) {
      const reportNames = {
        'coupons': 'ë°œê¸‰ì¿ í°_ëª©ë¡',
        'used': 'ì‚¬ìš©ì¿ í°_ë‚´ì—­',
        'today': 'ì˜¤ëŠ˜ë§¤ì¶œ_ë³´ê³ ì„œ',
        'total': 'ì „ì²´ë§¤ì¶œ_ë³´ê³ ì„œ',
        'reservation': 'ì˜ˆì•½í˜„í™©_ëª©ë¡',
        'sales': 'íŒë§¤ë‚´ì—­_ë³´ê³ ì„œ',
        'purchase': 'ë§¤ì…ë‚´ì—­_ë³´ê³ ì„œ',
        'revenue': 'ë§¤ì¶œë¶„ì„_ë³´ê³ ì„œ'
      };
      
      const filename = (reportNames[type] || 'ë³´ê³ ì„œ') + '_' + new Date().toISOString().slice(0,10) + '.xlsx';

      alert('ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹œì‘\n\níŒŒì¼ëª…: ' + filename + '\n\nì €ì¥ ìœ„ì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.');
    }

    // ========================================
    // ğŸ¨ ë§¤ì¥ í™ˆí˜ì´ì§€ ë¹Œë” ê¸°ëŠ¥
    // ========================================

    // Supabase ì„¤ì •
    const SUPABASE_URL = 'https://qpuabgekedgkdwriskxs.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwdWFiZ2VrZWRna2R3cmlza3hzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ4NTgzNTcsImV4cCI6MjA1MDQzNDM1N30.Ln6TqJPrZH-gdIU7sgPfroDALFAIGv9wIjFMlGMqsWY';

    // ë¹Œë” ìƒíƒœ ê´€ë¦¬
    let builderSettings = {
      name: 'ì•„ë¯¸ í•œì •ì‹',
      category: 'í•œì‹',
      description: 'ì •ì„±ì„ ë‹´ì•„ ë§Œë“œëŠ” ê±´ê°•í•œ í•œì •ì‹',
      logo: 'ğŸ±',
      mainColor: '#a855f7',
      videoUrl: '',
      bannerUrl: '',
      website: '',
      instagram: '',
      kakao: '',
      phone: '02-1234-5678',
      address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123',
      hoursWeekday: '11:00 - 22:00',
      hoursSat: '11:00 - 22:00',
      hoursSun: '12:00 - 21:00',
      breaktime: '15:00 - 17:00',
      menus: [
        { id: 1, name: 'í•œì •ì‹ ì½”ìŠ¤ A', price: 35000, description: 'ì „í†µ í•œì •ì‹ 8ì²©' },
        { id: 2, name: 'í•œì •ì‹ ì½”ìŠ¤ B', price: 45000, description: 'í”„ë¦¬ë¯¸ì—„ í•œì •ì‹ 12ì²©' },
        { id: 3, name: 'ë¶ˆê³ ê¸° ì •ì‹', price: 18000, description: 'íŠ¹ì œ ì–‘ë… ë¶ˆê³ ê¸°' }
      ]
    };

    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    function updateStorePreview() {
      const nameEl = document.getElementById('builder-name');
      const categoryEl = document.getElementById('builder-category');
      const descEl = document.getElementById('builder-description');
      const logoEl = document.getElementById('builder-logo');
      const phoneEl = document.getElementById('builder-phone');
      const addressEl = document.getElementById('builder-address');

      if (nameEl) builderSettings.name = nameEl.value;
      if (categoryEl) builderSettings.category = categoryEl.value;
      if (descEl) builderSettings.description = descEl.value;
      if (logoEl) builderSettings.logo = logoEl.value;
      if (phoneEl) builderSettings.phone = phoneEl.value;
      if (addressEl) builderSettings.address = addressEl.value;

      // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
      const previewLogo = document.getElementById('preview-logo');
      const previewName = document.getElementById('preview-name');
      const previewCategory = document.getElementById('preview-category');
      const previewDesc = document.getElementById('preview-description');

      if (previewLogo) previewLogo.textContent = builderSettings.logo;
      if (previewName) previewName.textContent = builderSettings.name;
      if (previewCategory) previewCategory.textContent = `${builderSettings.category} Â· ê°•ë‚¨êµ¬`;
      if (previewDesc) previewDesc.textContent = builderSettings.description;

      console.log('ğŸ“ ë¹Œë” ì„¤ì • ì—…ë°ì´íŠ¸:', builderSettings);
    }

    // ë©”ì¸ ì»¬ëŸ¬ ì„¤ì •
    function setBuilderColor(color) {
      builderSettings.mainColor = color;

      // ë¯¸ë¦¬ë³´ê¸° ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
      const previewCard = document.getElementById('store-preview');
      if (previewCard) {
        previewCard.style.borderColor = color;
        previewCard.style.boxShadow = `0 0 30px ${color}40`;
      }

      // ìƒ‰ìƒ ë²„íŠ¼ ì„ íƒ í‘œì‹œ
      document.querySelectorAll('#store-builder-page button[onclick^="setBuilderColor"]').forEach(btn => {
        btn.style.transform = 'scale(1)';
        btn.style.borderColor = 'transparent';
      });
      if (event && event.target) {
        event.target.style.transform = 'scale(1.2)';
        event.target.style.borderColor = 'white';
      }

      console.log('ğŸ¨ ë©”ì¸ ì»¬ëŸ¬ ë³€ê²½:', color);
    }

    // ë©”ë‰´ ì•„ì´í…œ ì¶”ê°€
    function addNewMenuItem() {
      const newId = Date.now();
      builderSettings.menus.push({
        id: newId,
        name: 'ìƒˆ ë©”ë‰´',
        price: 10000,
        description: 'ë©”ë‰´ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”'
      });

      renderMenuEditor();
    }

    // ë©”ë‰´ ì‚­ì œ
    function removeMenuItem(id) {
      builderSettings.menus = builderSettings.menus.filter(m => m.id !== id);
      renderMenuEditor();
    }

    // ë©”ë‰´ í¸ì§‘ê¸° ë Œë”ë§
    function renderMenuEditor() {
      const container = document.getElementById('menu-editor-list');
      if (!container) return;

      container.innerHTML = builderSettings.menus.map(menu => `
        <div class="flex gap-4 items-center p-4 bg-gray-900 rounded-lg border border-purple-500/30">
          <div class="flex-1">
            <input type="text" value="${menu.name}"
              class="w-full p-2 mb-2 rounded bg-gray-800 border border-purple-500/50 text-white"
              onchange="updateMenuName(${menu.id}, this.value)">
            <input type="text" value="${menu.description}"
              class="w-full p-2 rounded bg-gray-800 border border-gray-600 text-gray-300 text-sm"
              onchange="updateMenuDescription(${menu.id}, this.value)">
          </div>
          <div class="w-32">
            <input type="number" value="${menu.price}"
              class="w-full p-2 rounded bg-gray-800 border border-cyan-500/50 text-cyan-400 text-right"
              onchange="updateMenuPrice(${menu.id}, this.value)">
            <p class="text-xs text-gray-500 text-right mt-1">ì›</p>
          </div>
          <button onclick="removeMenuItem(${menu.id})"
            class="w-10 h-10 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/40 transition">
            ğŸ—‘ï¸
          </button>
        </div>
      `).join('');
    }

    // ë©”ë‰´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
    function updateMenuName(id, value) {
      const menu = builderSettings.menus.find(m => m.id === id);
      if (menu) menu.name = value;
    }

    function updateMenuDescription(id, value) {
      const menu = builderSettings.menus.find(m => m.id === id);
      if (menu) menu.description = value;
    }

    function updateMenuPrice(id, value) {
      const menu = builderSettings.menus.find(m => m.id === id);
      if (menu) menu.price = parseInt(value) || 0;
    }

    // ì„¤ì • ì €ì¥ (Supabase ì—°ë™)
    async function saveStoreSettings() {
      // ëª¨ë“  ì…ë ¥ê°’ ìˆ˜ì§‘
      const fields = {
        'builder-name': 'name',
        'builder-category': 'category',
        'builder-description': 'description',
        'builder-logo': 'logo',
        'builder-video': 'videoUrl',
        'builder-banner': 'bannerUrl',
        'builder-website': 'website',
        'builder-instagram': 'instagram',
        'builder-kakao': 'kakao',
        'builder-phone': 'phone',
        'builder-address': 'address',
        'builder-hours-weekday': 'hoursWeekday',
        'builder-hours-sat': 'hoursSat',
        'builder-hours-sun': 'hoursSun',
        'builder-breaktime': 'breaktime'
      };

      for (const [elId, key] of Object.entries(fields)) {
        const el = document.getElementById(elId);
        if (el) builderSettings[key] = el.value;
      }

      console.log('ğŸ’¾ ì €ì¥í•  ì„¤ì •:', builderSettings);

      // Supabaseì— ì €ì¥ ì‹œë„
      try {
        const storeData = {
          name: builderSettings.name,
          category: builderSettings.category,
          description: builderSettings.description,
          logo_emoji: builderSettings.logo,
          main_color: builderSettings.mainColor,
          video_url: builderSettings.videoUrl,
          banner_url: builderSettings.bannerUrl,
          website: builderSettings.website,
          instagram: builderSettings.instagram,
          kakao_channel: builderSettings.kakao,
          phone: builderSettings.phone,
          address: builderSettings.address,
          business_hours: {
            weekday: builderSettings.hoursWeekday,
            saturday: builderSettings.hoursSat,
            sunday: builderSettings.hoursSun,
            breaktime: builderSettings.breaktime
          },
          menus: builderSettings.menus,
          updated_at: new Date().toISOString()
        };

        // LocalStorageì— ì €ì¥ (ì˜¤í”„ë¼ì¸ ì§€ì›)
        localStorage.setItem('storeSettings', JSON.stringify(storeData));

        // Supabase API í˜¸ì¶œ
        const response = await fetch(`${SUPABASE_URL}/rest/v1/stores`, {
          method: 'POST',
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'Content-Type': 'application/json',
            'Prefer': 'return=representation'
          },
          body: JSON.stringify(storeData)
        });

        if (response.ok) {
          const result = await response.json();
          console.log('âœ… Supabase ì €ì¥ ì„±ê³µ:', result);
          alert('âœ… ë§¤ì¥ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nSupabaseì— ë™ê¸°í™” ì™„ë£Œ!');
        } else {
          console.log('âš ï¸ Supabase ì €ì¥ ì‹¤íŒ¨, ë¡œì»¬ì—ë§Œ ì €ì¥ë¨');
          alert('âœ… ë§¤ì¥ ì •ë³´ê°€ ë¡œì»¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n(ì„œë²„ ë™ê¸°í™”ëŠ” ë‚˜ì¤‘ì— ì‹œë„ë©ë‹ˆë‹¤)');
        }
      } catch (error) {
        console.error('ì €ì¥ ì˜¤ë¥˜:', error);
        alert('âœ… ë§¤ì¥ ì •ë³´ê°€ ë¡œì»¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }
    }

    // ì „ì²´í™”ë©´ ë¯¸ë¦¬ë³´ê¸° ì—´ê¸°
    function openFullPreview() {
      const params = new URLSearchParams({
        name: builderSettings.name,
        category: builderSettings.category,
        description: builderSettings.description,
        logo: builderSettings.logo,
        color: builderSettings.mainColor,
        video: builderSettings.videoUrl || '',
        phone: builderSettings.phone,
        address: builderSettings.address
      });

      const previewUrl = `store_homepage_full.html?${params.toString()}`;
      window.open(previewUrl, '_blank', 'width=430,height=800');
    }

    // ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
    function loadStoreSettings() {
      const saved = localStorage.getItem('storeSettings');
      if (saved) {
        try {
          const data = JSON.parse(saved);
          builderSettings = {
            ...builderSettings,
            name: data.name || builderSettings.name,
            category: data.category || builderSettings.category,
            description: data.description || builderSettings.description,
            logo: data.logo_emoji || builderSettings.logo,
            mainColor: data.main_color || builderSettings.mainColor,
            videoUrl: data.video_url || '',
            bannerUrl: data.banner_url || '',
            website: data.website || '',
            instagram: data.instagram || '',
            kakao: data.kakao_channel || '',
            phone: data.phone || builderSettings.phone,
            address: data.address || builderSettings.address,
            hoursWeekday: data.business_hours?.weekday || builderSettings.hoursWeekday,
            hoursSat: data.business_hours?.saturday || builderSettings.hoursSat,
            hoursSun: data.business_hours?.sunday || builderSettings.hoursSun,
            breaktime: data.business_hours?.breaktime || builderSettings.breaktime,
            menus: data.menus || builderSettings.menus
          };

          // ì…ë ¥ í•„ë“œì— ê°’ ì„¤ì •
          const fieldMap = {
            'builder-name': builderSettings.name,
            'builder-category': builderSettings.category,
            'builder-description': builderSettings.description,
            'builder-logo': builderSettings.logo,
            'builder-video': builderSettings.videoUrl,
            'builder-banner': builderSettings.bannerUrl,
            'builder-website': builderSettings.website,
            'builder-instagram': builderSettings.instagram,
            'builder-kakao': builderSettings.kakao,
            'builder-phone': builderSettings.phone,
            'builder-address': builderSettings.address,
            'builder-hours-weekday': builderSettings.hoursWeekday,
            'builder-hours-sat': builderSettings.hoursSat,
            'builder-hours-sun': builderSettings.hoursSun,
            'builder-breaktime': builderSettings.breaktime
          };

          for (const [id, value] of Object.entries(fieldMap)) {
            const el = document.getElementById(id);
            if (el) el.value = value;
          }

          updateStorePreview();
          console.log('ğŸ“‚ ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜´:', builderSettings);
        } catch (e) {
          console.error('ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', e);
        }
      }

      renderMenuEditor();
    }

    // YouTube ì„ë² ë“œ URL ë³€í™˜
    function getYouTubeEmbedUrl(url) {
      if (!url) return null;

      const patterns = [
        /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,
        /youtube\.com\/shorts\/([^&\n?#]+)/
      ];

      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match) {
          return `https://www.youtube.com/embed/${match[1]}`;
        }
      }

      return url;
    }

    // í™ë³´ ë™ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°
    function previewVideo() {
      const videoUrl = document.getElementById('builder-video')?.value;
      const embedUrl = getYouTubeEmbedUrl(videoUrl);

      if (embedUrl && videoUrl) {
        const previewHtml = `
          <div class="fixed inset-0 bg-black/80 flex items-center justify-center z-50" onclick="this.remove()" style="z-index:9999;">
            <div class="bg-gray-900 p-4 rounded-xl max-w-2xl w-full mx-4" onclick="event.stopPropagation()">
              <div style="aspect-ratio: 16/9;">
                <iframe src="${embedUrl}"
                  style="width:100%; height:100%; border-radius: 8px;"
                  frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen>
                </iframe>
              </div>
              <button onclick="this.parentElement.parentElement.remove()"
                style="margin-top: 16px; width: 100%; padding: 12px; background: #a855f7; border-radius: 8px; font-weight: bold; border: none; color: white; cursor: pointer;">
                ë‹«ê¸°
              </button>
            </div>
          </div>
        `;
        document.body.insertAdjacentHTML('beforeend', previewHtml);
      } else {
        alert('YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
      }
    }

    // ê°€ë§¹ì  ë“±ë¡ API
    async function registerMerchant(formData) {
      try {
        const merchantData = {
          business_name: formData.businessName,
          business_number: formData.businessNumber,
          owner_name: formData.ownerName,
          phone: formData.phone,
          email: formData.email,
          address: formData.address,
          category: formData.category,
          status: 'pending',
          created_at: new Date().toISOString()
        };

        const response = await fetch(`${SUPABASE_URL}/rest/v1/merchants`, {
          method: 'POST',
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'Content-Type': 'application/json',
            'Prefer': 'return=representation'
          },
          body: JSON.stringify(merchantData)
        });

        if (response.ok) {
          const result = await response.json();
          console.log('âœ… ê°€ë§¹ì  ë“±ë¡ ì„±ê³µ:', result);
          return { success: true, data: result };
        } else {
          const error = await response.json();
          console.error('âŒ ê°€ë§¹ì  ë“±ë¡ ì‹¤íŒ¨:', error);
          return { success: false, error: error.message };
        }
      } catch (error) {
        console.error('ê°€ë§¹ì  ë“±ë¡ ì˜¤ë¥˜:', error);
        return { success: false, error: error.message };
      }
    }

    // í˜ì´ì§€ ë¡œë“œì‹œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(loadStoreSettings, 500);
      setTimeout(loadRegisteredVideos, 600);
    });

    // ========================================
    // ğŸ¬ í™ë³´ ì˜ìƒ ë“±ë¡ ê¸°ëŠ¥
    // ========================================

    // ë“±ë¡ëœ ì˜ìƒ ì €ì¥ì†Œ
    let registeredVideos = JSON.parse(localStorage.getItem('registeredVideos') || '{}');

    // ì˜ìƒ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸° (ë§¤ì¥ ëª©ë¡ì—ì„œ)
    function openVideoRegister(storeId) {
      const url = prompt('í™ë³´ ì˜ìƒ YouTube URLì„ ì…ë ¥í•˜ì„¸ìš”:\n\nì˜ˆ: https://youtube.com/watch?v=xxxxx\në˜ëŠ”: https://youtu.be/xxxxx');

      if (url && url.trim()) {
        const embedUrl = getYouTubeEmbedUrl(url.trim());
        if (embedUrl) {
          registeredVideos[storeId] = {
            url: url.trim(),
            embedUrl: embedUrl,
            registeredAt: new Date().toISOString()
          };
          localStorage.setItem('registeredVideos', JSON.stringify(registeredVideos));
          applyVideoToStore(storeId, embedUrl);
          alert('âœ… í™ë³´ ì˜ìƒì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
        } else {
          alert('âŒ ì˜¬ë°”ë¥¸ YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }
      }
    }

    // ë§¤ì¥ì— ì˜ìƒ ì ìš©
    function applyVideoToStore(storeId, embedUrl) {
      const iframe = document.getElementById(`${storeId}-iframe`);
      const placeholder = document.getElementById(`${storeId}-placeholder`);

      if (iframe && placeholder) {
        iframe.src = embedUrl;
        iframe.style.display = 'block';
        placeholder.style.display = 'none';
      }
    }

    // ì €ì¥ëœ ì˜ìƒë“¤ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadRegisteredVideos() {
      registeredVideos = JSON.parse(localStorage.getItem('registeredVideos') || '{}');

      for (const [storeId, data] of Object.entries(registeredVideos)) {
        if (data.embedUrl) {
          applyVideoToStore(storeId, data.embedUrl);
        }
      }

      renderRegisteredVideosList();
    }

    // ë“±ë¡ëœ ì˜ìƒ ëª©ë¡ ë Œë”ë§
    function renderRegisteredVideosList() {
      const container = document.getElementById('registered-videos-list');
      if (!container) return;

      const storeNames = {
        'store-001': 'ì•„ë¯¸ í•œì •ì‹',
        'store-002': 'ì•„ë¯¸ ë‹¤ë°©',
        'store-003': 'í™©ê¸ˆì˜¬ë¦¬ë¸Œ ì¹˜í‚¨',
        'store-004': 'í˜„ì‹¤ ë ˆìŠ¤í† ë‘'
      };

      const videoEntries = Object.entries(registeredVideos);

      if (videoEntries.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-sm">ë“±ë¡ëœ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }

      container.innerHTML = videoEntries.map(([storeId, data]) => `
        <div class="flex items-center justify-between p-3 bg-gray-800 rounded border border-gray-700">
          <div class="flex items-center gap-3">
            <span class="text-red-400">â–¶ï¸</span>
            <div>
              <p class="font-bold text-sm">${storeNames[storeId] || storeId}</p>
              <p class="text-xs text-gray-400 truncate" style="max-width: 200px;">${data.url}</p>
            </div>
          </div>
          <button onclick="removeRegisteredVideo('${storeId}')" class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs hover:bg-red-500/40">ì‚­ì œ</button>
        </div>
      `).join('');
    }

    // ë“±ë¡ëœ ì˜ìƒ ì‚­ì œ
    function removeRegisteredVideo(storeId) {
      if (confirm('ì´ ì˜ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        delete registeredVideos[storeId];
        localStorage.setItem('registeredVideos', JSON.stringify(registeredVideos));

        // UI ë³µì›
        const iframe = document.getElementById(`${storeId}-iframe`);
        const placeholder = document.getElementById(`${storeId}-placeholder`);

        if (iframe && placeholder) {
          iframe.src = '';
          iframe.style.display = 'none';
          placeholder.style.display = 'flex';
        }

        renderRegisteredVideosList();
        alert('ğŸ—‘ï¸ ì˜ìƒì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }

    // í™ë³´ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° (í™ë³´ í˜ì´ì§€ íƒ­ì—ì„œ)
    function previewPromoVideo() {
      const urlInput = document.getElementById('promo-video-url');
      const previewContainer = document.getElementById('promo-video-preview');

      if (!urlInput || !previewContainer) return;

      const url = urlInput.value.trim();
      if (!url) {
        alert('YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const embedUrl = getYouTubeEmbedUrl(url);
      if (embedUrl) {
        previewContainer.innerHTML = `
          <iframe src="${embedUrl}" class="w-full h-full rounded-lg" frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>
        `;
      } else {
        alert('âŒ ì˜¬ë°”ë¥¸ YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      }
    }

    // í™ë³´ ì˜ìƒ ë“±ë¡ (í™ë³´ í˜ì´ì§€ íƒ­ì—ì„œ)
    function registerPromoVideo() {
      const urlInput = document.getElementById('promo-video-url');
      if (!urlInput) return;

      const url = urlInput.value.trim();
      if (!url) {
        alert('YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const embedUrl = getYouTubeEmbedUrl(url);
      if (!embedUrl) {
        alert('âŒ ì˜¬ë°”ë¥¸ YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      // í˜„ì¬ ì‚¬ìš©ìì˜ ë§¤ì¥ (ê¸°ë³¸: store-001)
      const currentStoreId = 'store-001';

      registeredVideos[currentStoreId] = {
        url: url,
        embedUrl: embedUrl,
        registeredAt: new Date().toISOString()
      };

      localStorage.setItem('registeredVideos', JSON.stringify(registeredVideos));
      applyVideoToStore(currentStoreId, embedUrl);
      renderRegisteredVideosList();

      // ë¯¸ë¦¬ë³´ê¸°ë„ ì—…ë°ì´íŠ¸
      previewPromoVideo();

      alert('âœ… í™ë³´ ì˜ìƒì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në§¤ì¥ ëª©ë¡ì—ì„œ í™•ì¸í•˜ì„¸ìš”.');
      urlInput.value = '';
    }

    // ========================================
    // ğŸª ì™¸ë¶€ ì…ì  ë§¤ì¥ (URL ì—°ë™ ë°©ì‹)
    // ========================================

    const partnerStores = {
      'rounz': {
        name: 'ROUNZ ì•ˆê²½ì ',
        category: 'íŒ¨ì…˜/ì˜ë¥˜',
        url: 'https://rounz.com/product.php?productIndex=168902',
        image: 'https://image.rounz.com/_data/product/TARTOPTICAL/ARNEL-HERITAGE-BLACK(45)/ARNEL-HERITAGE-BLACK(45)_03.JPG',
        rating: 4.95,
        reviews: 42,
        badges: ['ì—°ë§íŠ¹ê°€', 'ARì§€ì›', 'ë¬´ë£Œë°°ì†¡']
      }
    };

    // ========================================
    // ğŸ”— ì™¸ë¶€ ì—°ë™ ê¸°ëŠ¥ (URL, ì˜ìƒ, ì•± ë‹¤ìš´ë¡œë“œ)
    // ========================================

    // ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° (ì…ì  í¼ìš©)
    function previewVideoURL() {
      const urlInput = document.getElementById('reg-video-url');
      const container = document.getElementById('video-preview-container');
      const iframe = document.getElementById('video-preview-iframe');

      if (!urlInput || !container || !iframe) return;

      const url = urlInput.value.trim();
      if (!url) {
        alert('ì˜ìƒ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const embedUrl = getYouTubeEmbedUrl(url);
      if (embedUrl) {
        iframe.src = embedUrl;
        container.classList.remove('hidden');
      } else {
        alert('âŒ ì˜¬ë°”ë¥¸ YouTube/Vimeo URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      }
    }

    // ë§¤ì¥ ë°ì´í„°ì— ì™¸ë¶€ ì—°ë™ ì •ë³´ ì €ì¥
    function getExternalLinks() {
      return {
        homepage: document.getElementById('reg-homepage-url')?.value.trim() || '',
        video: document.getElementById('reg-video-url')?.value.trim() || '',
        arUrl: document.getElementById('reg-ar-url')?.value.trim() || '',
        appAndroid: document.getElementById('reg-app-android')?.value.trim() || '',
        appIos: document.getElementById('reg-app-ios')?.value.trim() || '',
        instagram: document.getElementById('reg-sns-instagram')?.value.trim() || '',
        youtube: document.getElementById('reg-sns-youtube')?.value.trim() || '',
        naverBlog: document.getElementById('reg-sns-naver')?.value.trim() || '',
        kakaoChannel: document.getElementById('reg-sns-kakao')?.value.trim() || ''
      };
    }

    // ì™¸ë¶€ ë§í¬ ì—´ê¸°
    function openExternalLink(url) {
      if (url && url.startsWith('http')) {
        window.open(url, '_blank');
      }
    }

    // ë§¤ì¥ ì¹´ë“œì— ì—°ë™ ë²„íŠ¼ ìƒì„±
    function createLinkButtons(links) {
      let buttons = [];

      if (links.homepage) {
        buttons.push(`<button onclick="openExternalLink('${links.homepage}')" class="px-3 py-1 bg-cyan-500 text-white text-xs rounded hover:bg-cyan-600">ğŸŒ í™ˆí˜ì´ì§€</button>`);
      }
      if (links.video) {
        const embedUrl = getYouTubeEmbedUrl(links.video);
        buttons.push(`<button onclick="showVideoModal('${embedUrl}')" class="px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600">ğŸ¬ ì˜ìƒë³´ê¸°</button>`);
      }
      if (links.arUrl) {
        buttons.push(`<button onclick="openExternalLink('${links.arUrl}')" class="px-3 py-1 bg-purple-500 text-white text-xs rounded hover:bg-purple-600">ğŸ”® ARì²´í—˜</button>`);
      }
      if (links.appAndroid || links.appIos) {
        const appUrl = links.appAndroid || links.appIos;
        buttons.push(`<button onclick="openExternalLink('${appUrl}')" class="px-3 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600">ğŸ“¥ ì•±ë‹¤ìš´</button>`);
      }

      return buttons.join(' ');
    }

    // ì˜ìƒ ëª¨ë‹¬ í‘œì‹œ
    function showVideoModal(embedUrl) {
      if (!embedUrl) return;

      const modalHtml = `
        <div id="video-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center z-50" onclick="closeVideoModal(event)">
          <div class="max-w-4xl w-full mx-4" onclick="event.stopPropagation()">
            <div class="flex justify-end mb-2">
              <button onclick="closeVideoModal()" class="text-white text-3xl hover:text-gray-300">&times;</button>
            </div>
            <div class="aspect-video bg-black rounded-lg overflow-hidden">
              <iframe src="${embedUrl}" class="w-full h-full" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
          </div>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', modalHtml);
    }

    function closeVideoModal(event) {
      if (event && event.target.id !== 'video-modal') return;
      const modal = document.getElementById('video-modal');
      if (modal) modal.remove();
    }

    // SNS ì•„ì´ì½˜ ë²„íŠ¼ ìƒì„±
    function createSnsButtons(links) {
      let buttons = [];
      if (links.instagram) buttons.push(`<a href="${links.instagram}" target="_blank" class="text-pink-400 hover:text-pink-300">ğŸ“¸</a>`);
      if (links.youtube) buttons.push(`<a href="${links.youtube}" target="_blank" class="text-red-500 hover:text-red-400">â–¶ï¸</a>`);
      if (links.naverBlog) buttons.push(`<a href="${links.naverBlog}" target="_blank" class="text-green-400 hover:text-green-300">ğŸ“</a>`);
      if (links.kakaoChannel) buttons.push(`<a href="${links.kakaoChannel}" target="_blank" class="text-yellow-400 hover:text-yellow-300">ğŸ’¬</a>`);
      return buttons.length > 0 ? `<div class="flex gap-2 mt-2">${buttons.join('')}</div>` : '';
    }

    // ROUNZ ë° ì™¸ë¶€ ì…ì  ë§¤ì¥ì€ ìì²´ AR ê¸°ëŠ¥ì„ ì‚¬ìš©í•©ë‹ˆë‹¤
    // AIRCTTëŠ” ë§¤ì¥ ì¹´ë“œ(ë°•ìŠ¤)ë§Œ ì œê³µí•˜ê³ , AR/êµ¬ë§¤ëŠ” íŒŒíŠ¸ë„ˆ ì‚¬ì´íŠ¸ì—ì„œ ì²˜ë¦¬

    // ========================================
    // ğŸ¬ íŒŒì¼ ê´€ë¦¬ - ì˜ìƒ ë“±ë¡ & íŒŒì¼ ì—…ë¡œë“œ
    // ========================================

    // ì˜ìƒ ë“±ë¡
    function registerFileVideo() {
      const urlInput = document.getElementById('file-video-url');
      const preview = document.getElementById('file-video-preview');
      const list = document.getElementById('file-video-list');

      if (!urlInput || !urlInput.value.trim()) {
        alert('YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const embedUrl = getYouTubeEmbedUrl(urlInput.value.trim());
      if (!embedUrl) {
        alert('ì˜¬ë°”ë¥¸ YouTube URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      // ë¯¸ë¦¬ë³´ê¸°
      preview.innerHTML = `
        <div class="aspect-video rounded-lg overflow-hidden">
          <iframe src="${embedUrl}" class="w-full h-full" frameborder="0" allowfullscreen></iframe>
        </div>
      `;

      // ëª©ë¡ì— ì¶”ê°€
      const videoItem = document.createElement('div');
      videoItem.className = 'flex items-center gap-2 p-2 bg-gray-800 rounded';
      videoItem.innerHTML = `
        <span class="text-red-400">ğŸ¬</span>
        <span class="flex-1 text-sm truncate">${urlInput.value.trim()}</span>
        <button onclick="this.parentElement.remove()" class="text-red-400 hover:text-red-300">âœ•</button>
      `;
      list.appendChild(videoItem);

      // ì €ì¥
      let videos = JSON.parse(localStorage.getItem('store_videos') || '[]');
      videos.push(urlInput.value.trim());
      localStorage.setItem('store_videos', JSON.stringify(videos));

      urlInput.value = '';
      alert('âœ… ì˜ìƒì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
    function handleFileUpload(input) {
      const list = document.getElementById('upload-file-list');
      const files = input.files;

      for (let file of files) {
        const fileItem = document.createElement('div');
        fileItem.className = 'flex items-center gap-2 p-2 bg-gray-800 rounded';

        let icon = 'ğŸ“„';
        if (file.type.includes('video')) icon = 'ğŸ¬';
        else if (file.type.includes('image')) icon = 'ğŸ–¼ï¸';
        else if (file.type.includes('pdf')) icon = 'ğŸ“•';
        else if (file.type.includes('sheet') || file.name.endsWith('.xlsx')) icon = 'ğŸ“Š';

        const size = (file.size / 1024).toFixed(1) + ' KB';

        fileItem.innerHTML = `
          <span>${icon}</span>
          <span class="flex-1 text-sm truncate">${file.name}</span>
          <span class="text-xs text-gray-400">${size}</span>
          <button onclick="this.parentElement.remove()" class="text-red-400 hover:text-red-300">âœ•</button>
        `;
        list.appendChild(fileItem);
      }

      alert(`âœ… ${files.length}ê°œ íŒŒì¼ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`);
      input.value = '';
    }
  </script>
</body>
</html>
